define(["backbone","js/components/api_feedback"],function(e,t){var a=new(e.Model.extend({defaults:{recent:!0,show:!0}}));return{_getUpdateFromUserData:function(){try{var e=this.getBeeHive().getObject("User").getUserData();return!!e&&/show/i.test(e.defaultHideSidebars)}catch(e){return!1}},init:function(){this.setSidebarState(this._getUpdateFromUserData()),_.bindAll(this,["_onFeedback","_onUserAnnouncement","_updateSidebarState"]);var e=this.getPubSub();e&&(e.subscribe(e.FEEDBACK,this._onFeedback),e.subscribe(e.USER_ANNOUNCEMENT,this._onUserAnnouncement),a.on("change:show",this._updateSidebarState))},_updateSidebarState:_.throttle(function(){var e=this.getSidebarState(),t=this.view;t&&t.showCols&&t.showCols({left:e,right:e}),this.broadcast("page-manager-message","side-bars-update",e),this.trigger("page-manager-message","side-bars-update",e)},100),_onUserAnnouncement:function(e,t){_.contains("defaultHideSidebars",_.keys(t))&&this.setSidebarState(this._getUpdateFromUserData())},_onFeedback:function(e){switch(e.code){case t.CODES.MAKE_SPACE:return this.onMakeSpace();case t.CODES.UNMAKE_SPACE:return this.onUnMakeSpace()}},onMakeSpace:function(){a.set("recent",this.getSidebarState()),this.setSidebarState(!1)},onUnMakeSpace:function(){a.has("recent")&&(this.setSidebarState(a.get("recent")),a.unset("recent"))},toggleSidebarState:function(){this.setSidebarState(!this.getSidebarState())},setSidebarState:function(e){a.set("show",e),a.trigger("change:show")},getSidebarState:function(){return a.get("show")}}});