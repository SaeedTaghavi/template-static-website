function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}define(["underscore","react","redux","react-redux","../actions/index","../constants/actionNames","../components/ExportFormatControl.jsx","../components/SelectionButtons.jsx","../components/Row.jsx","../components/Message.jsx","../components/Loading.jsx","../components/Closer.jsx"],function(e,t,n,o,r,a,l,s,c,i,u,m){var f=function(n,o){return e.map(n,function(e){return"All"===e?t.createElement("option",{key:o,value:o},"All"):t.createElement("option",{key:e,value:e},e)})},p=r.toggleSelection,h=r.toggleAll,d=r.reset,y=r.doExport,E=r.closeWidget,g=r.updateYear,v=r.updateAuthor,b=(r.reload,function(n){function o(e){var t;return _classCallCheck(this,o),(t=_possibleConstructorReturn(this,_getPrototypeOf(o).call(this,e))).state={reloadSpin:!1},t}return _inherits(o,t.Component),_createClass(o,[{key:"doExport",value:function(){(0,this.props.dispatch)(y())}},{key:"onFormatSelection",value:function(e){(0,this.props.dispatch)({type:a.setFormat,value:e})}},{key:"onSelectionClick",value:function(e){var t=this.props.dispatch;switch(e){case"toggleall":return t(h());case"reset":return t(d())}}},{key:"doRefresh",value:function(){var e=this.props.dispatch;this.setState({reloadSpin:!0}),e(r.reload())}},{key:"onCloseClick",value:function(){(0,this.props.dispatch)(E())}},{key:"onCheckboxChange",value:function(e,t){(0,this.props.dispatch)(p(e,t))}},{key:"onYearChange",value:function(e){(0,this.props.dispatch)(g(e))}},{key:"onAuthorChange",value:function(e){(0,this.props.dispatch)(v(e))}},{key:"componentWillReceiveProps",value:function(e){this.setState({reloadSpin:!1})}},{key:"render",value:function(){var n=this,o=this.props,r=o.data,a=o.showReload,p=o.formats,h=o.format,d=o.message,y=o.loading,E=o.exporting,g=o.year,v=o.author,b=o.currentYear;return t.createElement("div",null,t.createElement(m,{onClick:function(){return n.onCloseClick()}}),t.createElement("div",{className:"container auth-aff-tool"},t.createElement("div",{className:"row",style:{marginTop:40}},!y&&t.createElement("div",null,t.createElement("h4",{className:"col-xs-12 col-sm-6",style:{marginTop:0}},"Viewing Affiliation Data For ",t.createElement("strong",null,r.length)," ","Authors",t.createElement("br",null),t.createElement("small",null,g!==b?"From ".concat(b-g," to ").concat(b):"",g!==b&&0!==v&&" | ",0!==v?"".concat(v," authors from each work"):"")),t.createElement("div",{className:"col-xs-12 col-sm-6"},t.createElement("div",{className:"col-xs-12 col-sm-offset-4 col-sm-8 no-padding-right"},t.createElement("div",{className:"col-xs-3 text-right",style:{marginTop:4}},t.createElement("label",{htmlFor:"max-author-select"},"Authors:")),t.createElement("div",{className:"col-xs-3 no-padding-right"},t.createElement("select",{id:"max-author-select",className:"form-control input-sm",title:"Select the number of authors from each article to be included (default is 3)",value:v,onChange:function(e){return n.onAuthorChange(e.target.value)}},f([1,2,3,4,5,10,"All"],0))),t.createElement("div",{className:"col-xs-3 text-right",style:{marginTop:4}},t.createElement("label",{htmlFor:"year-select"},"Years:")),t.createElement("div",{className:"col-xs-3 no-padding-right"},t.createElement("select",{id:"year-select",className:"form-control input-sm",title:"Select the number of years to include in the results (default is 4)",value:g,onChange:function(e){return n.onYearChange(e.target.value)}},f([1,2,3,4,5,10,"All"],0)))))),t.createElement(i,d)),y?t.createElement(u,null):t.createElement("div",null,t.createElement("div",{className:"row"},t.createElement("div",{className:"col-xs-12 col-sm-6"},t.createElement(l,{formats:p,format:h,onChange:function(e){return n.onFormatSelection(e)}})),t.createElement("div",{className:"col-xs-12 col-sm-2"},t.createElement("button",{className:"btn btn-primary",onClick:function(){return n.doExport()},disabled:!!E},E?t.createElement("i",{className:"fa fa-spinner fa-fw fa-spin"}):"Export")),t.createElement("div",{className:"col-xs-12 col-sm-4"},t.createElement(s,{onClick:function(e){return n.onSelectionClick(e)}}))),t.createElement("div",{className:"row well"},t.createElement("div",{className:"row auth-aff-heading"},t.createElement("div",{className:"col-xs-2"},"Author"),t.createElement("div",{className:"col-xs-8"},t.createElement("div",{className:"col-xs-8"},"Affiliations"),t.createElement("div",{className:"col-xs-4"},"Years")),t.createElement("div",{className:"col-xs-2"},"Last Active Date")),t.createElement("hr",{className:"hr"}),e.map(r,function(e,o){return t.createElement("div",{key:e.id},t.createElement(c,{data:e,onChange:function(t){return n.onCheckboxChange(e,t)}}),r.length-1>o&&t.createElement("hr",{className:"hr"}))}),!a&&e.isEmpty(r)&&t.createElement("div",{className:"text-center"},"No Results"),a&&t.createElement("div",{className:"text-center"},t.createElement("button",{onClick:function(){return n.doRefresh()},title:"Retry",className:"btn btn-default"},t.createElement("i",{className:"fa fa-refresh ".concat(this.state.reloadSpin?"fa-spin":"")})," ","Retry"))))))}}]),o}());return o.connect(function(e){return{data:e.data,formats:e.formats,format:e.format,message:e.message,loading:e.loading,exporting:e.exporting,currentYear:e.currentYear,year:e.year,author:e.author,showReload:e.showReload}})(b)});