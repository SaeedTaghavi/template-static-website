define(["marionette","d3","jquery","jquery-ui","hbs!js/widgets/facet/graph-facet/templates/graph"],function(t,i,e,a,h){return t.ItemView.extend({className:"graph-facet",initialize:function(t){this.yAxisTitle=t.yAxisTitle,this.xAxisTitle=t.xAxisTitle,this.graphTitle=t.graphTitle,this.pastTenseTitle=t.pastTenseTitle,this.id=this.graphTitle+"-graph",this.fullWidth=110,this.fullHeight=100,this.width=this.fullWidth-this.margin.left-this.margin.right,this.height=this.fullHeight-this.margin.top-this.margin.bottom,this.currentScale="linear",this.on("facet:active",this.pulseApplyButton)},bins:12,margin:{top:5,right:5,bottom:20,left:20},template:h,insertLegend:function(){this.$(".graph-legend").html(this.legendTemplate({yAxisTitle:this.yAxisTitle}))},events:{"click .apply":"submitFacet","blur input[type=text]":"triggerGraphChange"},modelEvents:{change:"render"},pulseApplyButton:function(){this.$(".apply").addClass("draw-attention-primary-faded"),setTimeout(function(){this.$(".apply").removeClass("draw-attention-primary-faded")},2e3)},onRender:function(){var t=this;if(this.model.get("graphData"))if(this.model.get("graphData").length<2)this.$el.html("Too little data to make a useful graph.");else{this.insertLegend(),this.buildGraph(),this.addSliderWindows(),this.buildSlider(),this.addToOnRender&&this.addToOnRender();var i=_.debounce(_.bind(this.triggerGraphChange,this),100);e('input[type="text"]',this.$el).on("keyup",function(e){i(),e&&13===e.which&&(t.triggerGraphChange.call(t,!0),t.submitFacet.call(t))})}}})});