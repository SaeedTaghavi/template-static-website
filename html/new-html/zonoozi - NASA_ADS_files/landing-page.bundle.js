function _typeof2(e){"@babel/helpers - typeof";return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw r}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}define("config/common.config",[],function(){window.skipMain&&requirejs.config({baseUrl:"../../"}),requirejs.config({shim:{mathjax:{exports:"MathJax",init:function(){return MathJax.Hub.Config({messageStyle:"none",HTML:["input/TeX","output/HTML-CSS"],TeX:{extensions:["AMSmath.js","AMSsymbols.js"],equationNumbers:{autoNumber:"AMS"}},extensions:["tex2jax.js"],jax:["input/TeX","output/HTML-CSS"],tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0},"HTML-CSS":{availableFonts:["TeX"],linebreaks:{automatic:!0}}}),MathJax.Hub.Startup.onload(),MathJax}}}}),window.GoogleAnalyticsObject="__ga__",require(["config/discovery.vars"],function(e){setTimeout(function(){require(["google-analytics","analytics"],function(){var t=window[window.GoogleAnalyticsObject];t.l=Date.now(),t("create",e.googleTrackingCode||"",e.googleTrackingOptions)})},0)}),require(["hbs/handlebars"],function(e){e.registerHelper("compare",function(e,t,n){var i,a;if(arguments.length<3)throw new Error("Handlerbars Helper 'compare' needs 2 parameters");if(!(i={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},typeof:function(e,t){return _typeof2(e)===t}})[a=void 0!==n&&n.hash&&n.hash.operator?n.hash.operator:"==="])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+a);return i[a](e,t)?n.fn(this):n.inverse(this)}),e.registerHelper("toJSON",function(e){return JSON.stringify(e)})}),require(["backbone-validation"],function(){_.extend(Backbone.Validation.callbacks,{valid:function(e,t,n){e.$("input[name="+t+"]").closest(".form-group").removeClass("has-error").find(".help-block").html("").addClass("no-show")},invalid:function(e,t,n,i){var a=e.$("[name="+t+"]");$group=a.closest(".form-group"),!0===e.submit&&($group.addClass("has-error"),$group.find(".help-block").html(n).removeClass("no-show"))}})}),require(["d3","d3-cloud"],function(e,t){var n=window;n.d3||(n.d3=e),n.d3&&n.d3.layout&&!n.d3.layout.cloud&&(n.d3.layout.cloud=t),e.legend=function(t){return t.each(function(){var t=e.select(this),n={},i=e.select(t.property("nearestViewportElement")),a=t.attr("data-style-padding")||5,r=t.selectAll(".legend-box").data([!0]),s=t.selectAll(".legend-items").data([!0]);r.enter().append("rect").classed("legend-box",!0),s.enter().append("g").classed("legend-items",!0);try{i.selectAll("[data-legend]").each(function(){var t=e.select(this);n[t.attr("data-legend")]={pos:t.attr("data-legend-pos")||this.getBBox().y,color:void 0!=t.attr("data-legend-color")?t.attr("data-legend-color"):"none"!=t.style("fill")?t.style("fill"):t.style("stroke")}})}catch(e){}n=e.entries(n).sort(function(e,t){return e.value.pos-t.value.pos});var o=0;s.selectAll("text").data(n,function(e){return e.key}).call(function(e){e.enter().append("text")}).call(function(e){e.exit().remove()}).attr("y",function(e,t){return 0===t?"0em":t+(o+=.2)+"em"}).attr("x","1em").text(function(e){return e.key}),s.selectAll("circle").data(n,function(e){return e.key}).call(function(e){e.enter().append("circle")}).call(function(e){e.exit().remove()}).attr("cy",function(e,t){return t-.25+"em"}).attr("cx",0).attr("r","0.4em").style("fill",function(e){return e.value.color});var l=s[0][0].getBBox();r.attr("x",l.x-a).attr("y",l.y-a).attr("height",l.height+2*a).attr("width",l.width+2*a)}),t}})}),require.config({deps:"undefined"!=typeof window&&window.skipMain?["common.config"]:["config/common.config","js/apps/discovery/main"],waitSeconds:30,config:{es6:{modules:void 0},"js/components/persistent_storage":{namespace:"bumblebee"},"js/apps/discovery/main":{core:{controllers:{FeedbackMediator:"js/wraps/discovery_mediator",QueryMediator:"js/components/query_mediator",Diagnostics:"js/bugutils/diagnostics",AlertsController:"js/wraps/alerts_mediator",Orcid:"js/modules/orcid/module",SecondOrderController:"js/components/second_order_controller",HotkeysController:"js/components/hotkeys_controller"},services:{Api:"js/services/api",PubSub:"js/services/pubsub",Navigator:"js/apps/discovery/navigator",PersistentStorage:"js/services/storage",HistoryManager:"js/components/history_manager"},objects:{User:"js/components/user",Session:"js/components/session",DynamicConfig:"config/discovery.vars",MasterPageManager:"js/page_managers/master",AppStorage:"js/components/app_storage",RecaptchaManager:"recaptcha!js/components/recaptcha_manager",CSRFManager:"js/components/csrf_manager",LibraryController:"js/components/library_controller",DocStashController:"js/components/doc_stash_controller"},modules:{FacetFactory:"js/widgets/facet/factory"}},widgets:{LandingPage:"js/wraps/landing_page_manager/landing_page_manager",SearchPage:"js/wraps/results_page_manager",DetailsPage:"js/wraps/abstract_page_manager/abstract_page_manager",AuthenticationPage:"js/wraps/authentication_page_manager",SettingsPage:"js/wraps/user_settings_page_manager/user_page_manager",OrcidPage:"js/wraps/orcid_page_manager/orcid_page_manager",OrcidInstructionsPage:"js/wraps/orcid-instructions-page-manager/manager",LibrariesPage:"js/wraps/libraries_page_manager/libraries_page_manager",HomePage:"js/wraps/home_page_manager/home_page_manager",PublicLibrariesPage:"js/wraps/public_libraries_page_manager/public_libraries_manager",ErrorPage:"js/wraps/error_page_manager/error_page_manager",Authentication:"js/widgets/authentication/widget",UserSettings:"js/widgets/user_settings/widget",UserPreferences:"js/widgets/preferences/widget",LibraryImport:"js/widgets/library_import/widget",BreadcrumbsWidget:"js/widgets/filter_visualizer/widget",NavbarWidget:"js/widgets/navbar/widget",UserNavbarWidget:"js/widgets/user_navbar/widget",AlertsWidget:"js/widgets/alerts/widget",ClassicSearchForm:"js/widgets/classic_form/widget",SearchWidget:"js/widgets/search_bar/search_bar_widget",PaperSearchForm:"js/widgets/paper_search_form/widget",Results:"js/widgets/results/widget",QueryInfo:"js/widgets/query_info/query_info_widget",QueryDebugInfo:"js/widgets/api_query/widget",ExportWidget:"js/widgets/export/widget.jsx",Sort:"js/widgets/sort/widget.jsx",ExportDropdown:"js/wraps/export_dropdown",VisualizationDropdown:"js/wraps/visualization_dropdown",AuthorNetwork:"js/wraps/author_network",PaperNetwork:"js/wraps/paper_network",ConceptCloud:"js/widgets/wordcloud/widget",BubbleChart:"js/widgets/bubble_chart/widget",AuthorAffiliationTool:"js/widgets/author_affiliation_tool/widget.jsx",Metrics:"js/widgets/metrics/widget",CitationHelper:"js/widgets/citation_helper/widget",OrcidBigWidget:"js/modules/orcid/widget/widget",OrcidSelector:"js/widgets/orcid-selector/widget.jsx",AffiliationFacet:"js/wraps/affiliation_facet",AuthorFacet:"js/wraps/author_facet",BibgroupFacet:"js/wraps/bibgroup_facet",BibstemFacet:"js/wraps/bibstem_facet",DataFacet:"js/wraps/data_facet",DatabaseFacet:"js/wraps/database_facet",GrantsFacet:"js/wraps/grants_facet",KeywordFacet:"js/wraps/keyword_facet",ObjectFacet:"js/wraps/simbad_object_facet",NedObjectFacet:"js/wraps/ned_object_facet",RefereedFacet:"js/wraps/refereed_facet",VizierFacet:"js/wraps/vizier_facet",GraphTabs:"js/wraps/graph_tabs",FooterWidget:"js/widgets/footer/widget",PubtypeFacet:"js/wraps/pubtype_facet",ShowAbstract:"js/widgets/abstract/widget",ShowGraphics:"js/widgets/graphics/widget",ShowGraphicsSidebar:"js/wraps/sidebar-graphics-widget",ShowReferences:"js/wraps/references",ShowCitations:"js/wraps/citations",ShowCoreads:"js/wraps/coreads",ShowSimilar:"js/wraps/similar",MetaTagsWidget:"js/widgets/meta_tags/widget",ShowToc:"js/wraps/table_of_contents",ShowResources:"js/widgets/resources/widget.jsx",ShowAssociated:"js/widgets/associated/widget.jsx",ShowRecommender:"js/widgets/recommender/widget",ShowMetrics:"js/wraps/paper_metrics",ShowExportcitation:"js/wraps/paper_export",ShowLibraryAdd:"js/wraps/abstract_page_library_add/widget",IndividualLibraryWidget:"js/widgets/library_individual/widget",LibraryActionsWidget:"js/widgets/library_actions/widget.jsx",AllLibrariesWidget:"js/widgets/libraries_all/widget",LibraryListWidget:"js/widgets/library_list/widget"},plugins:{}}},map:{"*":{pubsub_service_impl:"js/services/default_pubsub"}},paths:{router:"js/apps/discovery/router",analytics:"js/components/analytics",underscore:["//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.2/lodash.min","libs/lodash/lodash.compat"],async:"libs/requirejs-plugins/async",babel:"libs/requirejs-babel-plugin/babel-5.8.34.min",backbone:["libs/backbone/backbone"],"backbone-validation":["//cdnjs.cloudflare.com/ajax/libs/backbone.validation/0.11.3/backbone-validation-amd-min","libs/backbone-validation/backbone-validation"],"backbone.stickit":["//cdnjs.cloudflare.com/ajax/libs/backbone.stickit/0.8.0/backbone.stickit.min","libs/backbone.stickit/backbone.stickit"],"backbone.wreqr":["//cdnjs.cloudflare.com/ajax/libs/backbone.wreqr/1.0.0/backbone.wreqr.min","libs/backbone.wreqr/lib/backbone.wreqr"],bootstrap:["//ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/bootstrap.min","libs/bootstrap/bootstrap"],bowser:"//cdn.jsdelivr.net/npm/bowser@2.4.0/bundled",cache:"libs/cache/index",classnames:["//cdnjs.cloudflare.com/ajax/libs/classnames/2.2.5/index.min","../bower_components/classnames/index"],clipboard:["//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min","libs/clipboard/clipboard"],"create-react-class":["//cdn.jsdelivr.net/npm/create-react-class@15.6.2/create-react-class.min","libs/create-react-class/index"],d3:["//cdnjs.cloudflare.com/ajax/libs/d3/3.4.6/d3.min","libs/d3/d3.min"],"d3-cloud":["//cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.min","libs/d3-cloud/d3.layout.cloud"],enzyme:"libs/enzyme/index","es5-shim":["//cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.10/es5-shim.min","libs/es5-shim/es5-shim"],es6:"libs/requirejs-babel-plugin/es6",filesaver:["//cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min","libs/file-saver/index"],"google-analytics":["libs/g","data:application/javascript,"],hbs:"libs/require-handlebars-plugin/hbs",hotkeys:"libs/hotkeys/index",jquery:"libs/jquery/jquery","jquery-querybuilder":"libs/jQuery-QueryBuilder/query-builder","jquery-ui":"libs/jqueryui/jquery-ui",jsonpath:["//cdn.jsdelivr.net/npm/jsonpath@0.2.12/jsonpath.min","libs/jsonpath/jsonpath"],marionette:["//cdnjs.cloudflare.com/ajax/libs/backbone.marionette/2.4.5/backbone.marionette.min","libs/marionette/backbone.marionette"],mathjax:["//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML&amp;delayStartupUntil=configured","libs/mathjax/index"],moment:["//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min","libs/momentjs/moment"],"persist-js":["//cdn.jsdelivr.net/npm/persist-js@0.3.1/src/persist.min","libs/persist-js/src/persist"],react:["//cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react-with-addons.min","libs/react/index"],"react-bootstrap":["//cdnjs.cloudflare.com/ajax/libs/react-bootstrap/0.32.1/react-bootstrap.min","libs/react-bootstrap/index"],"react-dom":["//cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react-dom.min","libs/react-dom/index"],"react-prop-types":["//cdnjs.cloudflare.com/ajax/libs/prop-types/15.6.0/prop-types.min","libs/react-prop-types/index"],"react-redux":["//cdnjs.cloudflare.com/ajax/libs/react-redux/4.4.5/react-redux.min","libs/react-redux/index"],recaptcha:"js/plugins/recaptcha",reactify:"js/plugins/reactify",redux:["//cdnjs.cloudflare.com/ajax/libs/redux/3.5.2/redux.min","libs/redux/index"],"redux-thunk":["//cdnjs.cloudflare.com/ajax/libs/redux-thunk/2.1.0/redux-thunk.min","libs/redux-thunk/index"],select2:["//cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min","libs/select2/select2"],sprintf:["//cdnjs.cloudflare.com/ajax/libs/sprintf/1.0.2/sprintf.min","libs/sprintf/sprintf"],utils:"js/utils",reselect:["//cdnjs.cloudflare.com/ajax/libs/reselect/3.0.1/reselect.min","libs/reselect"],mocha:"libs/mocha/mocha",chai:"bower_components/chai/chai",sinon:"https://cdnjs.cloudflare.com/ajax/libs/sinon.js/1.9.0/sinon.min",es5shim:"node_modules/es5-shim/es5-shim.min"},hbs:{templateExtension:"html",helpers:!1},shim:{Backbone:{deps:["backbone"],exports:"Backbone"},"backbone.stickit":{deps:["backbone"]},"backbone-validation":{deps:["backbone"]},bootstrap:{deps:["jquery","jquery-ui"]},backbone:{deps:["jquery","underscore"]},marionette:{deps:["jquery","underscore","backbone"],exports:"Marionette"},cache:{exports:"Cache"},mocha:{exports:"mocha"},filesaver:{exports:"saveAs"},d3:{exports:"d3"},"d3-cloud":{deps:["d3"]},"google-analytics":{exports:"__ga__"},"jquery-ui":{deps:["jquery"]},"jquery-querybuilder":{deps:["jquery"]},sprintf:{exports:"sprintf"},"persist-js":{exports:"Persist"}}}),define("config/discovery.config",function(){}),define("js/apps/discovery/main",["config/discovery.config","module"],function(e,t){require(["router","js/components/application","js/mixins/discovery_bootstrap","js/mixins/api_access","analytics","es5-shim"],function(e,n,i,a,r){var s="function"==typeof window.__setAppLoadingProgress?window.__setAppLoadingProgress:function(){};Date.now();n.prototype.shim();var o=window.location.href.indexOf("debug=true")>-1,l=new(n.extend(i))({debug:o,timeout:3e5}),c=l.loadModules(t.config());s(20,"Starting Application");c.done(function(){s(50,"Modules Loaded");Date.now();l.activate();var t=l.getService("PubSub");t.publish(t.getCurrentPubSubKey(),t.APP_LOADED),l.configure(),s(95,"Finishing Up..."),l.bootstrap().done(function(n){s(100),l.onBootstrap(n),t.publish(t.getCurrentPubSubKey(),t.APP_BOOTSTRAPPED),t.publish(t.getCurrentPubSubKey(),t.APP_STARTING),l.start(e).done(function(){t.publish(t.getCurrentPubSubKey(),t.APP_STARTED);var e=_.debounce(function(){var e,t=function(){try{var e=_.isFunction(this.getBeeHive)&&this.getBeeHive(),t=_.isFunction(e.getObject)&&e.getObject("User");if(t)return t.getUserData("USER_DATA")}catch(e){}return{}}.call(l);"OPEN IN CURRENT TAB"===(t.externalLinkAction&&t.externalLinkAction.toUpperCase()||"AUTO")&&function t(n){clearTimeout(e),n<10&&($('a[target="_blank"]').attr("target",""),e=setTimeout(t,1e3,n+1))}(0)},3e3,{leading:!0,trailing:!1},!1);t.subscribe(t.getCurrentPubSubKey(),t.NAVIGATE,e),e(),$("body").on("click","button.toggle-menu",function(e){var t=$(e.target),n=t.parents().eq(1).find(".nav-container");n.toggleClass("show");var i=n.hasClass("show")?'  <i class="fa fa-close"></i> Close Menu':' <i class="fa fa-bars"></i> Show Menu';t.html(i)}),$("body").on("click","#skip-to-main-content",function(){return!1});var n=l.getObject("DynamicConfig");if(n&&n.debugExportBBB&&(window.bbb=l),window.__PAGE_LOAD_TIMESTAMP){var i=new Date-window.__PAGE_LOAD_TIMESTAMP;r("send",{hitType:"timing",timingCategory:"Application",timingVar:"Loaded",timingValue:i}),o&&console.log("Application Started: "+i+"ms")}window.clearTimeout(window.APP_LOADING_TIMER)})})}).fail(function(){r("send","event","introspection","failed-load",arguments),o||l.redirect("500.html")}).fail(function(){r("send","event","introspection","failed-reloading",arguments),o||l.reload("404.html")})})}),define("analytics",["underscore","jquery"],function(e,t){var n={resolver:{hooks:["toc-link-followed","abstract-link-followed","citations-link-followed","associated-link-followed"],types:["abstract","citations","references","metrics","coreads","similar","graphics","associated","toc"],url:e.template("link_gateway/<%= bibcode %>/<%= target %>")}},i=function(i,a){e.isString(i)&&e.isPlainObject(a)&&e.has(a,"target")&&e.forEach(n,function(n){var r,s=null;if(e.forEach(n.types,function(t){e.isArray(t)?t[0]===a.target&&e.has(t[1],"redirectTo")&&(s=t[1].redirectTo):t===a.target&&(s=t)}),e.contains(n.hooks,i)&&s){var o=e.assign({},a,{target:s});r=a.url?a.url:n.url(o),t.ajax({url:r,type:"GET"})}})},a=window[window.GoogleAnalyticsObject];window[window.GoogleAnalyticsObject]=function(){try{var e=t.Deferred();a.q=a.q||[];for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return a.q.push(i),a.apply(a,[].concat(i,[{hitCallback:function(){e.resolve()}}])),setTimeout(function(){return e.resolve()},1e3),e.promise()}catch(e){console.info("google analytics event not tracked")}};return function(){return i.apply(null,e.rest(arguments,3)),window[window.GoogleAnalyticsObject]&&window[window.GoogleAnalyticsObject].apply(this,arguments)}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("cache",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).dsjslib=e()}}(function(){return function(){return function e(t,n,i){function a(s,o){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){return a(t[s][1][e]||e)},u,u.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)a(i[s]);return a}}()({1:[function(e,t,n){var i,a,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,u=[],h=!1,d=-1;function p(){h&&c&&(h=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!h){var e=l(p);h=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,h=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function b(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new g(e,t)),1!==u.length||h||l(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=b,r.addListener=b,r.once=b,r.off=b,r.removeListener=b,r.removeAllListeners=b,r.emit=b,r.prependListener=b,r.prependOnceListener=b,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){!function(){"use strict";function n(e){var t=this;!function(e){var n=e.maximumWeight,i=e.weigherFunction,a=e.maximumSize,r="number"==typeof n&&n>-1,s="function"==typeof i;if(!r&&s||r&&!s)throw new Error("Maximum weight or weight function has illegal values");if(r&&s&&"number"==typeof a&&a>-1)throw new Error("Both max weight and size can't be configured");t._spec={loaderFn:"function"==typeof e.loaderFunction&&e.loaderFunction,expiresAfterWrite:"number"==typeof e.expiresAfterWrite?1e3*e.expiresAfterWrite:null,recordStats:e.recordStats,maxSize:a,maxWeight:n,weighFn:i,onRemove:"function"==typeof e.onRemove&&e.onRemove}}(e),i.apply(this)}n.prototype._REMOVAL_CAUSE_I="explicit",n.prototype._REMOVAL_CAUSE_C="capacity",n.prototype._REMOVAL_CAUSE_E="expired";var i=function(){this._accessQueue=new a("A"),this._writeQueue=this._spec.expiresAfterWrite?new a("W"):null;var e=n(this._REMOVAL_CAUSE_C,this._canReap,this._accessQueue,this),t=n(this._REMOVAL_CAUSE_E,this.isExpired,this._writeQueue,this);function n(e,t,n,i){return n?function(a){if(a)for(var r=n.tail.prev(n),s=null;r&&t.apply(i,[r]);)r&&(s=r.prev(n),i._rmEntry(r,e),r=s)}.bind(n):function(){}}this._cleanup=function(n){e(n),t(this._writeQueue)},this.size=0,this.weight=0,this._cache=Object.create(null),Object.defineProperty(this,"stats",{value:{hitCount:0,missCount:0,requestCount:0},configurable:!0})};function a(e){this.tail=this.head=Object.create(r.prototype),this.type=e}function r(e,t,n,i){this.key=e,this.loading=n,n||this.setValue(t),this.onLoad=i?[i]:[],this.writeTime=Date.now()}r.prototype.setValue=function(e){if(void 0===e||null===e)throw new Error("Illegal value for key "+e);this.value=e,this.writeTime=Date.now()},r.prototype.moveToHead=function(e){var t=this;e.forEach(function(e){if(e){var n=e.head;t.next(e,n),n.prev(e,t),e.head=t}})},r.prototype.next=function(e,t){var n="next"+e.type;return void 0!==t&&(this[n]=t),this[n]},r.prototype.prev=function(e,t){var n="prev"+e.type;return void 0!==t&&(this[n]=t),this[n]},r.prototype.remove=function(e){if(e){var t=this.prev(e),n=this.next(e);t?(t.next(e,n),n.prev(e,t)):(n.prev(e,null),e.head=n),n.next(e)||(e.tail=n),this.next(e,null),this.prev(e,null)}},r.prototype.promote=function(){var e=this;Array.prototype.slice.call(arguments).forEach(function(t){t&&e.prev(t)&&(e.remove(t),e.moveToHead([t]))})},r.prototype.forEach=function(e,t){for(var n=this;n;)e.call(this,n),n=n.next(t)},n.prototype.put=function(e,t){var n=this._cache[e];n?(n.setValue(t),n.writeTime=Date.now(),n.promote(this._accessQueue,this._writeQueue),this._cleanup(!1)):this._createEntry(e,t)},n.prototype._createEntry=function(e,t,n,i){var a=new r(e,t,n,i);return this._cleanup(!0),this._cache[e]=a,this._updateCacheSize(a,!0),a.moveToHead([this._accessQueue,this._writeQueue]),a},n.prototype.isExpired=function(e){var t=this._spec.expiresAfterWrite,n=Date.now();return!e.loading&&t&&t>0&&n-e.writeTime>t},n.prototype._updateCacheSize=function(e,t){var n;this._spec.maxWeight&&(n=this._spec.weighFn.apply(this,[e.key,e.value]),this.weight+=t?n:-n),this.size+=t?1:-1},n.prototype.get=function(t,n){n=n||function(){},this.stats.requestCount++;var i=this;e.nextTick(function(){(function(e,t){var n=this._cache[e];if(n){if(n.loading)return this.stats.missCount++,void n.onLoad.push(t);this.isExpired(n)?(this.stats.missCount++,this._notify(n,this._REMOVAL_CAUSE_E),n.loading=!0,n.onLoad.push(t),s(this,o.bind(n),e)):(n.promote(this._accessQueue),this.stats.hitCount++,t.apply(null,[null,n.value]))}else this.stats.missCount++,n=this._createEntry(e,null,!0,t),s(this,o.bind(n),e)}).call(i,t,n)})};var s=function(e,t,n){var i=e._spec.loaderFn;i&&i.apply(null,[n,function(n,i){t(e,n,i)}])},o=function(e,t,n){if(!t)try{this.setValue(n),this.promote(e._accessQueue,e._writeQueue),this.onLoad.forEach(function(e){e.apply(null,[t,n])}),this.onLoad=[],this.loading=!1}catch(e){t=e}t&&(this.onLoad.forEach(function(e){e.apply(null,[t,n])}),e._rmEntry(this))};function l(e,t,n){var i,a=null,r=e._spec.loaderFn;return r&&(r.apply(null,[n,function(e,t){i=e,a=t}]),t(i,a)),a}n.prototype.getSync=function(e){var t=arguments.length>2&&arguments[2];this.stats.requestCount++;var n,i=this._cache[e],a=this;return i?this.isExpired(i)?(this.stats.missCount++,t?this._rmEntry(i,this._REMOVAL_CAUSE_E):n=l(a,function(e,t){if(e)throw e;a._notify(i,a._REMOVAL_CAUSE_E),i.setValue(t),i.promote(a._accessQueue,a._writeQueue)},e)):(i.promote(this._accessQueue),n=i.value,this.stats.hitCount++):(this.stats.missCount++,t||(n=l(a,function(t,n){if(t)throw t;a._createEntry(e,n)},e))),n},n.prototype.getIfPresent=function(e){return this.getSync(e,null,!0)},n.prototype.invalidate=function(e){var t=this._cache[e];this._rmEntry(t,this._REMOVAL_CAUSE_I)},n.prototype._notify=function(e,t){this._spec.onRemove&&this._spec.onRemove.apply(null,[e.key,e.value,t])},n.prototype._rmEntry=function(e,t){e.remove(this._accessQueue),e.remove(this._writeQueue),this._updateCacheSize(e,!1),delete this._cache[e.key],t&&this._notify(e,t)},n.prototype.invalidateAll=function(){var e=this;Object.keys(this._cache).forEach(function(t){e.invalidate(t)})},n.prototype._canReap=function(){return this._spec.maxSize&&this.size>=this._spec.maxSize||this._spec.maxWeight&&this.weight>this._spec.maxWeight},t.exports=n}()}).call(this,e("_process"))},{_process:1}]},{},[2])(2)}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("hbs/handlebars",t):"object"==typeof exports?exports.Handlebars=t():e.Handlebars=t()}(this,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";var i=n(8).default;t.__esModule=!0;var a=i(n(1)),r=i(n(2)),s=n(3),o=n(4),l=i(n(5)),c=i(n(6)),u=i(n(7)),h=a.default.create;function d(){var e=h();return e.compile=function(t,n){return o.compile(t,n,e)},e.precompile=function(t,n){return o.precompile(t,n,e)},e.AST=r.default,e.Compiler=o.Compiler,e.JavaScriptCompiler=l.default,e.Parser=s.parser,e.parse=s.parse,e}var p=d();p.create=d,u.default(p),p.Visitor=c.default,p.default=p,t.default=p,e.exports=t.default},function(e,t,n){"use strict";var i=n(9).default,a=n(8).default;t.__esModule=!0;var r=i(n(10)),s=a(n(11)),o=a(n(12)),l=i(n(13)),c=i(n(14)),u=a(n(7));function h(){var e=new r.HandlebarsEnvironment;return l.extend(e,r),e.SafeString=s.default,e.Exception=o.default,e.Utils=l,e.escapeExpression=l.escapeExpression,e.VM=c,e.template=function(t){return c.template(t,e)},e}var d=h();d.create=h,u.default(d),d.default=d,t.default=d,e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i={Program:function(e,t,n,i){this.loc=i,this.type="Program",this.body=e,this.blockParams=t,this.strip=n},MustacheStatement:function(e,t,n,i,a,r){this.loc=r,this.type="MustacheStatement",this.path=e,this.params=t||[],this.hash=n,this.escaped=i,this.strip=a},BlockStatement:function(e,t,n,i,a,r,s,o,l){this.loc=l,this.type="BlockStatement",this.path=e,this.params=t||[],this.hash=n,this.program=i,this.inverse=a,this.openStrip=r,this.inverseStrip=s,this.closeStrip=o},PartialStatement:function(e,t,n,i,a){this.loc=a,this.type="PartialStatement",this.name=e,this.params=t||[],this.hash=n,this.indent="",this.strip=i},ContentStatement:function(e,t){this.loc=t,this.type="ContentStatement",this.original=this.value=e},CommentStatement:function(e,t,n){this.loc=n,this.type="CommentStatement",this.value=e,this.strip=t},SubExpression:function(e,t,n,i){this.loc=i,this.type="SubExpression",this.path=e,this.params=t||[],this.hash=n},PathExpression:function(e,t,n,i,a){this.loc=a,this.type="PathExpression",this.data=e,this.original=i,this.parts=n,this.depth=t},StringLiteral:function(e,t){this.loc=t,this.type="StringLiteral",this.original=this.value=e},NumberLiteral:function(e,t){this.loc=t,this.type="NumberLiteral",this.original=this.value=Number(e)},BooleanLiteral:function(e,t){this.loc=t,this.type="BooleanLiteral",this.original=this.value="true"===e},UndefinedLiteral:function(e){this.loc=e,this.type="UndefinedLiteral",this.original=this.value=void 0},NullLiteral:function(e){this.loc=e,this.type="NullLiteral",this.original=this.value=null},Hash:function(e,t){this.loc=t,this.type="Hash",this.pairs=e},HashPair:function(e,t,n){this.loc=n,this.type="HashPair",this.key=e,this.value=t},helpers:{helperExpression:function(e){return!("SubExpression"!==e.type&&!e.params.length&&!e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return 1===e.parts.length&&!i.helpers.scopedId(e)&&!e.depth}}};t.default=i,e.exports=t.default},function(e,t,n){"use strict";var i=n(8).default,a=n(9).default;t.__esModule=!0,t.parse=function(e,t){if("Program"===e.type)return e;return r.default.yy=u,u.locInfo=function(e){return new u.SourceLocation(t&&t.srcName,e)},(new o.default).accept(r.default.parse(e))};var r=i(n(15)),s=i(n(2)),o=i(n(16)),l=a(n(17)),c=n(13);t.parser=r.default;var u={};c.extend(u,l,s.default)},function(e,t,n){"use strict";var i=n(8).default;t.__esModule=!0,t.Compiler=l,t.precompile=function(e,t,n){if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new a.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);"data"in(t=t||{})||(t.data=!0);t.compat&&(t.useDepths=!0);var i=n.parse(e,t),r=(new n.Compiler).compile(i,t);return(new n.JavaScriptCompiler).compile(r,t)},t.compile=function(e,t,n){var i=void 0===arguments[1]?{}:arguments[1];if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new a.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);"data"in i||(i.data=!0);i.compat&&(i.useDepths=!0);var r=void 0;function s(){var t=n.parse(e,i),a=(new n.Compiler).compile(t,i),r=(new n.JavaScriptCompiler).compile(a,i,void 0,!0);return n.template(r)}function o(e,t){return r||(r=s()),r.call(this,e,t)}return o._setup=function(e){return r||(r=s()),r._setup(e)},o._child=function(e,t,n,i){return r||(r=s()),r._child(e,t,n,i)},o};var a=i(n(12)),r=n(13),s=i(n(2)),o=[].slice;function l(){}function c(e,t){if(e===t)return!0;if(r.isArray(e)&&r.isArray(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(!c(e[n],t[n]))return!1;return!0}}function u(e){if(!e.path.parts){var t=e.path;e.path=new s.default.PathExpression(!1,0,[t.original+""],t.original+"",t.loc)}}l.prototype={compiler:l,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var i=this.opcodes[n],a=e.opcodes[n];if(i.opcode!==a.opcode||!c(i.args,a.args))return!1}t=this.children.length;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[];var n=t.knownHelpers;if(t.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},n)for(var i in n)i in n&&(t.knownHelpers[i]=n[i]);return this.accept(e)},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++;return this.usePartial=this.usePartial||t.usePartial,this.children[n]=t,this.useDepths=this.useDepths||t.useDepths,n},accept:function(e){this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,n=t.length,i=0;i<n;i++)this.accept(t[i]);return this.options.blockParams.shift(),this.isSimple=1===n,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){u(e);var t=e.program,n=e.inverse;t=t&&this.compileProgram(t),n=n&&this.compileProgram(n);var i=this.classifySexpr(e);"helper"===i?this.helperSexpr(e,t,n):"simple"===i?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,n),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(e){this.usePartial=!0;var t=e.params;if(t.length>1)throw new a.default("Unsupported number of partial arguments: "+t.length,e);t.length||t.push({type:"PathExpression",parts:[],depth:0});var n=e.name.original,i="SubExpression"===e.name.type;i&&this.accept(e.name),this.setupFullMustacheParams(e,void 0,void 0,!0);var r=e.indent||"";this.options.preventIndent&&r&&(this.opcode("appendContent",r),r=""),this.opcode("invokePartial",i,n,r),this.opcode("append")},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){u(e);var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,n){var i=e.path,a=i.parts[0],r=null!=t||null!=n;this.opcode("getContext",i.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.accept(i),this.opcode("invokeAmbiguous",a,r)},simpleSexpr:function(e){this.accept(e.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,n){var i=this.setupFullMustacheParams(e,t,n),r=e.path,o=r.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",i.length,o);else{if(this.options.knownHelpersOnly)throw new a.default("You specified knownHelpersOnly, but used the unknown helper "+o,e);r.falsy=!0,this.accept(r),this.opcode("invokeHelper",i.length,r.original,s.default.helpers.simpleId(r))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],n=s.default.helpers.scopedId(e),i=!e.depth&&!n&&this.blockParamIndex(t);i?this.opcode("lookupBlockParam",i,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts)):this.opcode("lookupOnContext",e.parts,e.falsy,n):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,n=0,i=t.length;for(this.opcode("pushHash");n<i;n++)this.pushParam(t[n].value);for(;n--;)this.opcode("assignToHash",t[n].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:o.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=s.default.helpers.simpleId(e.path),n=t&&!!this.blockParamIndex(e.path.parts[0]),i=!n&&s.default.helpers.helperExpression(e),a=!n&&(i||t);if(a&&!i){var r=e.path.parts[0],o=this.options;o.knownHelpers[r]?i=!0:o.knownHelpersOnly&&(a=!1)}return i?"helper":a?"ambiguous":"simple"},pushParams:function(e){for(var t=0,n=e.length;t<n;t++)this.pushParam(e[t])},pushParam:function(e){var t=null!=e.value?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),"SubExpression"===e.type&&this.accept(e);else{if(this.trackIds){var n=void 0;if(!e.parts||s.default.helpers.scopedId(e)||e.depth||(n=this.blockParamIndex(e.parts[0])),n){var i=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,i)}else(t=e.original||t).replace&&(t=t.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,n,i){var a=e.params;return this.pushParams(a),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.accept(e.hash):this.opcode("emptyHash",i),a},blockParamIndex:function(e){for(var t=0,n=this.options.blockParams.length;t<n;t++){var i=this.options.blockParams[t],a=i&&r.indexOf(i,e);if(i&&a>=0)return[t,a]}}}},function(e,t,n){"use strict";var i=n(8).default;t.__esModule=!0;var a=n(10),r=i(n(12)),s=n(13),o=i(n(18));function l(e){this.value=e}function c(){}c.prototype={nameLookup:function(e,t){return c.isValidJavaScriptVariableName(t)?[e,".",t]:[e,"['",t,"']"]},depthedLookup:function(e){return[this.aliasable("this.lookup"),'(depths, "',e,'")']},compilerInfo:function(){var e=a.COMPILER_REVISION;return[e,a.REVISION_CHANGES[e]]},appendToBuffer:function(e,t,n){return s.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:n?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},compile:function(e,t,n,i){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!i,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var a=e.opcodes,s=void 0,o=void 0,l=void 0,c=void 0;for(l=0,c=a.length;l<c;l++)s=a[l],this.source.currentLocation=s.loc,o=o||s.loc,this[s.opcode].apply(this,s.args);if(this.source.currentLocation=o,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new r.default("Compile completed with content left on stack");var u=this.createFunctionContext(i);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u},d=this.context.programs;for(l=0,c=d.length;l<c;l++)d[l]&&(h[l]=d[l]);return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),i?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),t.srcName?(h=h.toStringWithSourceMap({file:t.destName})).map=h.map&&h.map.toString():h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new o.default(this.options.srcName)},createFunctionContext:function(e){var t="",n=this.stackVars.concat(this.registers.list);n.length>0&&(t+=", "+n.join(", "));var i=0;for(var a in this.aliases){var r=this.aliases[a];this.aliases.hasOwnProperty(a)&&r.children&&r.referenceCount>1&&(t+=", alias"+ ++i+"="+a,r.children[0]="alias"+i)}var s=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var o=this.mergeSource(t);return e?(s.push(o),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",o,"}"])},mergeSource:function(e){var t=this.environment.isSimple,n=!this.forceBuffer,i=void 0,a=void 0,r=void 0,s=void 0;return this.source.each(function(e){e.appendToBuffer?(r?e.prepend("  + "):r=e,s=e):(r&&(a?r.prepend("buffer += "):i=!0,s.add(";"),r=s=void 0),a=!0,t||(n=!1))}),n?r?(r.prepend("return "),s.add(";")):a||this.source.push('return "";'):(e+=", buffer = "+(i?"":this.initializeBuffer()),r?(r.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(i?"":";\n")),this.source.merge()},blockValue:function(e){var t=this.aliasable("helpers.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(e,0,n);var i=this.popStack();n.splice(1,0,i),this.push(this.source.functionCall(t,"call",n))},ambiguousBlockValue:function(){var e=this.aliasable("helpers.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var n=this.topStack();t.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(e){return[" != null ? ",e,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,n){var i=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[i++])),this.resolvePath("context",e,i,t)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t){e?this.pushStackLiteral("this.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",t,0,!0)},resolvePath:function(e,t,n,i){var a=this;if(this.options.strict||this.options.assumeObjects)this.push(function(e,t,n,i){var a=t.popStack(),r=0,s=n.length;e&&s--;for(;r<s;r++)a=t.nameLookup(a,n[r],i);return e?[t.aliasable("this.strict"),"(",a,", ",t.quotedString(n[r]),")"]:a}(this.options.strict,this,t,e));else for(var r=t.length;n<r;n++)this.replaceStack(function(r){var s=a.nameLookup(r,t[n],e);return i?[" && ",s]:[" != null ? ",s," : ",r]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"SubExpression"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t,n){var i=this.popStack(),a=this.setupHelper(e,t),r=n?[a.name," || "]:"",s=["("].concat(r,i);this.options.strict||s.push(" || ",this.aliasable("helpers.helperMissing")),s.push(")"),this.push(this.source.functionCall(s,"call",a.callParams))},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var n=this.popStack();this.emptyHash();var i=this.setupHelper(0,e,t),a=["(","(helper = ",this.lastHelper=this.nameLookup("helpers",e,"helper")," || ",n,")"];this.options.strict||(a[0]="(helper = ",a.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",a,i.paramsInit?["),(",i.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",i.callParams)," : helper))"])},invokePartial:function(e,t,n){var i=[],a=this.setupParams(t,1,i,!1);e&&(t=this.popStack(),delete a.name),n&&(a.indent=JSON.stringify(n)),a.helpers="helpers",a.partials="partials",e?i.unshift(t):i.unshift(this.nameLookup("partials",t,"partial")),this.options.compat&&(a.depths="depths"),a=this.objectLiteral(a),i.push(a),this.push(this.source.functionCall("this.invokePartial","",i))},assignToHash:function(e){var t=this.popStack(),n=void 0,i=void 0,a=void 0;this.trackIds&&(a=this.popStack()),this.stringParams&&(i=this.popStack(),n=this.popStack());var r=this.hash;n&&(r.contexts[e]=n),i&&(r.types[e]=i),a&&(r.ids[e]=a),r.values[e]=t},pushId:function(e,t,n){"BlockParam"===e?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):"PathExpression"===e?this.pushString(t):"SubExpression"===e?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:c,compileChildren:function(e,t){for(var n=e.children,i=void 0,a=void 0,r=0,s=n.length;r<s;r++){i=n[r],a=new this.compiler;var o=this.matchExistingProgram(i);null==o?(this.context.programs.push(""),o=this.context.programs.length,i.index=o,i.name="program"+o,this.context.programs[o]=a.compile(i,t,this.context,!this.precompile),this.context.environments[o]=i,this.useDepths=this.useDepths||a.useDepths,this.useBlockParams=this.useBlockParams||a.useBlockParams):(i.index=o,i.name="program"+o,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams=this.useBlockParams||i.useBlockParams)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var i=this.context.environments[t];if(i&&i.equals(e))return t}},programExpression:function(e){var t=this.environment.children[e],n=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"this.program("+n.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof l||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new l(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],n=void 0,i=void 0,a=void 0;if(!this.isInline())throw new r.default("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof l)t=["(",n=[s.value]],a=!0;else{i=!0;var o=this.incrStack();t=["((",this.push(o)," = ",s,")"],n=this.topStack()}var c=e.call(this,n);a||this.popStack(),i&&this.stackSlot--,this.push(t.concat(c,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];if(i instanceof l)this.compileStack.push(i);else{var a=this.incrStack();this.pushSource([a," = ",i,";"]),this.compileStack.push(a)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof l)return n.value;if(!t){if(!this.stackSlot)throw new r.default("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof l?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):((t=this.aliases[e]=this.source.wrap(e)).aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,n){var i=[];return{params:i,paramsInit:this.setupHelperArgs(t,e,i,n),name:this.nameLookup("helpers",t,"helper"),callParams:[this.contextName(0)].concat(i)}},setupParams:function(e,t,n){var i={},a=[],r=[],s=[],o=void 0;i.name=this.quotedString(e),i.hash=this.popStack(),this.trackIds&&(i.hashIds=this.popStack()),this.stringParams&&(i.hashTypes=this.popStack(),i.hashContexts=this.popStack());var l=this.popStack(),c=this.popStack();(c||l)&&(i.fn=c||"this.noop",i.inverse=l||"this.noop");for(var u=t;u--;)o=this.popStack(),n[u]=o,this.trackIds&&(s[u]=this.popStack()),this.stringParams&&(r[u]=this.popStack(),a[u]=this.popStack());return this.trackIds&&(i.ids=this.source.generateArray(s)),this.stringParams&&(i.types=this.source.generateArray(r),i.contexts=this.source.generateArray(a)),this.options.data&&(i.data="data"),this.useBlockParams&&(i.blockParams="blockParams"),i},setupHelperArgs:function(e,t,n,i){var a=this.setupParams(e,t,n,!0);return a=this.objectLiteral(a),i?(this.useRegister("options"),n.push("options"),["options=",a]):(n.push(a),"")}},function(){for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),t=c.RESERVED_WORDS={},n=0,i=e.length;n<i;n++)t[e[n]]=!0}(),c.isValidJavaScriptVariableName=function(e){return!c.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},t.default=c,e.exports=t.default},function(e,t,n){"use strict";var i=n(8).default;t.__esModule=!0;var a=i(n(12)),r=i(n(2));function s(){this.parents=[]}s.prototype={constructor:s,mutating:!1,acceptKey:function(e,t){var n=this.accept(e[t]);if(this.mutating){if(n&&(!n.type||!r.default[n.type]))throw new a.default('Unexpected node type "'+n.type+'" found when accepting '+t+" on "+e.type);e[t]=n}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new a.default(e.type+" requires "+t)},acceptArray:function(e){for(var t=0,n=e.length;t<n;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,n--)},accept:function(e){if(e){this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);return this.current=this.parents.shift(),!this.mutating||t?t:!1!==t?e:void 0}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")},BlockStatement:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash"),this.acceptKey(e,"program"),this.acceptKey(e,"inverse")},PartialStatement:function(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}},t.default=s,e.exports=t.default},function(e,t,n){(function(n){"use strict";t.__esModule=!0,t.default=function(e){var t=void 0!==n?n:window,i=t.Handlebars;e.noConflict=function(){t.Handlebars===e&&(t.Handlebars=i)}},e.exports=t.default}).call(t,function(){return this}())},function(e,t,n){"use strict";t.default=function(e){return e&&e.__esModule?e:{default:e}},t.__esModule=!0},function(e,t,n){"use strict";t.default=function(e){if(e&&e.__esModule)return e;var t={};if("object"==typeof e&&null!==e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},t.__esModule=!0},function(e,t,n){"use strict";var i=n(9).default,a=n(8).default;t.__esModule=!0,t.HandlebarsEnvironment=u,t.createFrame=p;var r=i(n(13)),s=a(n(12));t.VERSION="3.0.1";t.COMPILER_REVISION=6;t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};var o=r.isArray,l=r.isFunction,c=r.toString;function u(e,t){var n;this.helpers=e||{},this.partials=t||{},(n=this).registerHelper("helperMissing",function(){if(1!==arguments.length)throw new s.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}),n.registerHelper("blockHelperMissing",function(e,t){var i=t.inverse,a=t.fn;if(!0===e)return a(this);if(!1===e||null==e)return i(this);if(o(e))return e.length>0?(t.ids&&(t.ids=[t.name]),n.helpers.each(e,t)):i(this);if(t.data&&t.ids){var s=p(t.data);s.contextPath=r.appendContextPath(t.data.contextPath,t.name),t={data:s}}return a(e,t)}),n.registerHelper("each",function(e,t){if(!t)throw new s.default("Must pass iterator to #each");var n=t.fn,i=t.inverse,a=0,c="",u=void 0,h=void 0;function d(t,i,a){u&&(u.key=t,u.index=i,u.first=0===i,u.last=!!a,h&&(u.contextPath=h+t)),c+=n(e[t],{data:u,blockParams:r.blockParams([e[t],t],[h+t,null])})}if(t.data&&t.ids&&(h=r.appendContextPath(t.data.contextPath,t.ids[0])+"."),l(e)&&(e=e.call(this)),t.data&&(u=p(t.data)),e&&"object"==typeof e)if(o(e))for(var f=e.length;a<f;a++)d(a,a,a===e.length-1);else{var g=void 0;for(var b in e)e.hasOwnProperty(b)&&(g&&d(g,a-1),g=b,a++);g&&d(g,a-1,!0)}return 0===a&&(c=i(this)),c}),n.registerHelper("if",function(e,t){return l(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),n.registerHelper("unless",function(e,t){return n.helpers.if.call(this,e,{fn:t.inverse,inverse:t.fn,hash:t.hash})}),n.registerHelper("with",function(e,t){l(e)&&(e=e.call(this));var n=t.fn;if(r.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var i=p(t.data);i.contextPath=r.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}),n.registerHelper("log",function(e,t){var i=t.data&&null!=t.data.level?parseInt(t.data.level,10):1;n.log(i,e)}),n.registerHelper("lookup",function(e,t){return e&&e[t]})}u.prototype={constructor:u,logger:h,log:d,registerHelper:function(e,t){if("[object Object]"===c.call(e)){if(t)throw new s.default("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if("[object Object]"===c.call(e))r.extend(this.partials,e);else{if(void 0===t)throw new s.default("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var h={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&h.level<=e){var n=h.methodMap[e];(console[n]||console.log).call(console,t)}}};t.logger=h;var d=h.log;function p(e){var t=r.extend({},e);return t._parent=e,t}t.log=d},function(e,t,n){"use strict";function i(e){this.string=e}t.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},t.default=i,e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i=["description","fileName","lineNumber","message","name","number","stack"];function a(e,t){var n=t&&t.loc,r=void 0,s=void 0;n&&(e+=" - "+(r=n.start.line)+":"+(s=n.start.column));for(var o=Error.prototype.constructor.call(this,e),l=0;l<i.length;l++)this[i[l]]=o[i[l]];Error.captureStackTrace&&Error.captureStackTrace(this,a),n&&(this.lineNumber=r,this.column=s)}a.prototype=new Error,t.default=a,e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,t.extend=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e},t.indexOf=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}if(!r.test(e))return e;return e.replace(a,s)},t.isEmpty=function(e){return!e&&0!==e||!(!c(e)||0!==e.length)},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=/[&<>"'`]/g,r=/[&<>"'`]/;function s(e){return i[e]}var o,l=Object.prototype.toString;t.toString=l,(o=function(e){return"function"==typeof e})(/x/)&&(t.isFunction=o=function(e){return"function"==typeof e&&"[object Function]"===l.call(e)}),t.isFunction=o;var c=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===l.call(e)};t.isArray=c},function(e,t,n){"use strict";var i=n(9).default,a=n(8).default;t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,n=o.COMPILER_REVISION;if(t!==n){if(t<n){var i=o.REVISION_CHANGES[n],a=o.REVISION_CHANGES[t];throw new s.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+a+").")}throw new s.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},t.template=function(e,t){if(!t)throw new s.default("No environment passed to template");if(!e||!e.main)throw new s.default("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n={strict:function(e,t){if(!(t in e))throw new s.default('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]&&null!=e[i][t])return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:r.escapeExpression,invokePartial:function(n,i,a){a.hash&&(i=r.extend({},i,a.hash));n=t.VM.resolvePartial.call(this,n,i,a);var o=t.VM.invokePartial.call(this,n,i,a);null==o&&t.compile&&(a.partials[a.name]=t.compile(n,e.compilerOptions,t),o=a.partials[a.name](i,a));if(null!=o){if(a.indent){for(var l=o.split("\n"),c=0,u=l.length;c<u&&(l[c]||c+1!==u);c++)l[c]=a.indent+l[c];o=l.join("\n")}return o}throw new s.default("The partial "+a.name+" could not be compiled when running in runtime-only mode")},fn:function(t){return e[t]},programs:[],program:function(e,t,n,i,a){var r=this.programs[e],s=this.fn(e);return t||a||i||n?r=l(this,e,s,t,n,i,a):r||(r=this.programs[e]=l(this,e,s)),r},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=r.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler};function i(t){var a=void 0===arguments[1]?{}:arguments[1],r=a.data;i._setup(a),!a.partial&&e.useData&&(r=function(e,t){t&&"root"in t||((t=t?o.createFrame(t):{}).root=e);return t}(t,r));var s=void 0,l=e.useBlockParams?[]:void 0;return e.useDepths&&(s=a.depths?[t].concat(a.depths):[t]),e.main.call(n,t,n.helpers,n.partials,r,l,s)}return i.isTop=!0,i._setup=function(i){i.partial?(n.helpers=i.helpers,n.partials=i.partials):(n.helpers=n.merge(i.helpers,t.helpers),e.usePartial&&(n.partials=n.merge(i.partials,t.partials)))},i._child=function(t,i,a,r){if(e.useBlockParams&&!a)throw new s.default("must pass block params");if(e.useDepths&&!r)throw new s.default("must pass parent depths");return l(n,t,e[t],i,0,a,r)},i},t.wrapProgram=l,t.resolvePartial=function(e,t,n){e?e.call||n.name||(n.name=e,e=n.partials[e]):e=n.partials[n.name];return e},t.invokePartial=function(e,t,n){if(n.partial=!0,void 0===e)throw new s.default("The partial "+n.name+" could not be found");if(e instanceof Function)return e(t,n)},t.noop=function(){return""};var r=i(n(13)),s=a(n(12)),o=n(10);function l(e,t,n,i,a,r,s){function o(t){var a=void 0===arguments[1]?{}:arguments[1];return n.call(e,t,e.helpers,e.partials,a.data||i,r&&[a.blockParams].concat(r),s&&[t].concat(s))}return o.program=t,o.depth=s?s.length:0,o.blockParams=a||0,o}},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(e,t,n,i,a,r,s){var o=r.length-1;switch(a){case 1:return r[o-1];case 2:this.$=new i.Program(r[o],null,{},i.locInfo(this._$));break;case 3:case 4:case 5:case 6:case 7:this.$=r[o];break;case 8:this.$=new i.CommentStatement(i.stripComment(r[o]),i.stripFlags(r[o],r[o]),i.locInfo(this._$));break;case 9:this.$=new i.ContentStatement(r[o],i.locInfo(this._$));break;case 10:this.$=i.prepareRawBlock(r[o-2],r[o-1],r[o],this._$);break;case 11:this.$={path:r[o-3],params:r[o-2],hash:r[o-1]};break;case 12:this.$=i.prepareBlock(r[o-3],r[o-2],r[o-1],r[o],!1,this._$);break;case 13:this.$=i.prepareBlock(r[o-3],r[o-2],r[o-1],r[o],!0,this._$);break;case 14:case 15:case 16:this.$={path:r[o-4],params:r[o-3],hash:r[o-2],blockParams:r[o-1],strip:i.stripFlags(r[o-5],r[o])};break;case 17:this.$={strip:i.stripFlags(r[o-1],r[o-1]),program:r[o]};break;case 18:var l=i.prepareBlock(r[o-2],r[o-1],r[o],r[o],!1,this._$),c=new i.Program([l],null,{},i.locInfo(this._$));c.chained=!0,this.$={strip:r[o-2].strip,program:c,chain:!0};break;case 19:this.$=r[o];break;case 20:this.$={path:r[o-1],strip:i.stripFlags(r[o-2],r[o])};break;case 21:case 22:this.$=i.prepareMustache(r[o-3],r[o-2],r[o-1],r[o-4],i.stripFlags(r[o-4],r[o]),this._$);break;case 23:this.$=new i.PartialStatement(r[o-3],r[o-2],r[o-1],i.stripFlags(r[o-4],r[o]),i.locInfo(this._$));break;case 24:case 25:this.$=r[o];break;case 26:this.$=new i.SubExpression(r[o-3],r[o-2],r[o-1],i.locInfo(this._$));break;case 27:this.$=new i.Hash(r[o],i.locInfo(this._$));break;case 28:this.$=new i.HashPair(i.id(r[o-2]),r[o],i.locInfo(this._$));break;case 29:this.$=i.id(r[o-1]);break;case 30:case 31:this.$=r[o];break;case 32:this.$=new i.StringLiteral(r[o],i.locInfo(this._$));break;case 33:this.$=new i.NumberLiteral(r[o],i.locInfo(this._$));break;case 34:this.$=new i.BooleanLiteral(r[o],i.locInfo(this._$));break;case 35:this.$=new i.UndefinedLiteral(i.locInfo(this._$));break;case 36:this.$=new i.NullLiteral(i.locInfo(this._$));break;case 37:case 38:this.$=r[o];break;case 39:this.$=i.preparePath(!0,r[o],this._$);break;case 40:this.$=i.preparePath(!1,r[o],this._$);break;case 41:r[o-2].push({part:i.id(r[o]),original:r[o],separator:r[o-1]}),this.$=r[o-2];break;case 42:this.$=[{part:i.id(r[o]),original:r[o]}];break;case 43:this.$=[];break;case 44:r[o-1].push(r[o]);break;case 45:this.$=[];break;case 46:r[o-1].push(r[o]);break;case 53:this.$=[];break;case 54:r[o-1].push(r[o]);break;case 59:this.$=[];break;case 60:r[o-1].push(r[o]);break;case 65:this.$=[];break;case 66:r[o-1].push(r[o]);break;case 73:this.$=[];break;case 74:r[o-1].push(r[o]);break;case 77:this.$=[];break;case 78:r[o-1].push(r[o]);break;case 81:this.$=[];break;case 82:r[o-1].push(r[o]);break;case 85:this.$=[];break;case 86:r[o-1].push(r[o]);break;case 89:this.$=[r[o]];break;case 90:r[o-1].push(r[o]);break;case 91:this.$=[r[o]];break;case 92:r[o-1].push(r[o])}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function(e,t){throw new Error(e)},parse:function(e){var t=this,n=[0],i=[null],a=[],r=this.table,s="",o=0,l=0,c=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;a.push(u);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var d,p,f,g,b,v,m,y,S,A,_={};;){if(f=n[n.length-1],this.defaultActions[f]?g=this.defaultActions[f]:(null!==d&&void 0!==d||(A=void 0,"number"!=typeof(A=t.lexer.lex()||1)&&(A=t.symbols_[A]||A),d=A),g=r[f]&&r[f][d]),void 0===g||!g.length||!g[0]){var P="";if(!c){for(v in S=[],r[f])this.terminals_[v]&&v>2&&S.push("'"+this.terminals_[v]+"'");P=this.lexer.showPosition?"Parse error on line "+(o+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+S.join(", ")+", got '"+(this.terminals_[d]||d)+"'":"Parse error on line "+(o+1)+": Unexpected "+(1==d?"end of input":"'"+(this.terminals_[d]||d)+"'"),this.parseError(P,{text:this.lexer.match,token:this.terminals_[d]||d,line:this.lexer.yylineno,loc:u,expected:S})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+d);switch(g[0]){case 1:n.push(d),i.push(this.lexer.yytext),a.push(this.lexer.yylloc),n.push(g[1]),d=null,p?(d=p,p=null):(l=this.lexer.yyleng,s=this.lexer.yytext,o=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(m=this.productions_[g[1]][1],_.$=i[i.length-m],_._$={first_line:a[a.length-(m||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(m||1)].first_column,last_column:a[a.length-1].last_column},h&&(_._$.range=[a[a.length-(m||1)].range[0],a[a.length-1].range[1]]),void 0!==(b=this.performAction.call(_,s,l,o,this.yy,g[1],i,a)))return b;m&&(n=n.slice(0,-1*m*2),i=i.slice(0,-1*m),a=a.slice(0,-1*m)),n.push(this.productions_[g[1]][0]),i.push(_.$),a.push(_._$),y=r[n[n.length-2]][n[n.length-1]],n.push(y);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var a=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[a[0],a[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;var e,t,n,i,a;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length&&(!(n=this._input.match(this.rules[r[s]]))||t&&!(n[0].length>t[0].length)||(t=n,i=s,this.options.flex));s++);return t?((a=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=a.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:a?a[a.length-1].length-a[a.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,r[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)},options:{},performAction:function(e,t,n,i){function a(e,n){return t.yytext=t.yytext.substr(e,t.yyleng-n)}switch(n){case 0:if("\\\\"===t.yytext.slice(-2)?(a(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(a(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return t.yytext=t.yytext.substr(5,t.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(t.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:case 24:return 66;case 25:return 81;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return t.yytext=a(1,2).replace(/\\"/g,'"'),74;case 30:return t.yytext=a(1,2).replace(/\\'/g,"'"),74;case 31:return 79;case 32:case 33:return 76;case 34:return 77;case 35:return 78;case 36:return 75;case 37:return 69;case 38:return 71;case 39:case 40:return 66;case 41:return"INVALID";case 42:return 5}},rules:[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,42],inclusive:!0}}};return e}();function n(){this.yy={}}return e.lexer=t,n.prototype=e,e.Parser=n,new n}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";var i=n(8).default;t.__esModule=!0;var a=i(n(6));function r(){}function s(e,t,n){void 0===t&&(t=e.length);var i=e[t-1],a=e[t-2];return i?"ContentStatement"===i.type?(a||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(i.original):void 0:n}function o(e,t,n){void 0===t&&(t=-1);var i=e[t+1],a=e[t+2];return i?"ContentStatement"===i.type?(a||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(i.original):void 0:n}function l(e,t,n){var i=e[null==t?0:t+1];if(i&&"ContentStatement"===i.type&&(n||!i.rightStripped)){var a=i.value;i.value=i.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),i.rightStripped=i.value!==a}}function c(e,t,n){var i=e[null==t?e.length-1:t-1];if(i&&"ContentStatement"===i.type&&(n||!i.leftStripped)){var a=i.value;return i.value=i.value.replace(n?/\s+$/:/[ \t]+$/,""),i.leftStripped=i.value!==a,i.leftStripped}}r.prototype=new a.default,r.prototype.Program=function(e){var t=!this.isRootSeen;this.isRootSeen=!0;for(var n=e.body,i=0,a=n.length;i<a;i++){var r=n[i],u=this.accept(r);if(u){var h=s(n,i,t),d=o(n,i,t),p=u.openStandalone&&h,f=u.closeStandalone&&d,g=u.inlineStandalone&&h&&d;u.close&&l(n,i,!0),u.open&&c(n,i,!0),g&&(l(n,i),c(n,i)&&"PartialStatement"===r.type&&(r.indent=/([ \t]+$)/.exec(n[i-1].original)[1])),p&&(l((r.program||r.inverse).body),c(n,i)),f&&(l(n,i),c((r.inverse||r.program).body))}}return e},r.prototype.BlockStatement=function(e){this.accept(e.program),this.accept(e.inverse);var t=e.program||e.inverse,n=e.program&&e.inverse,i=n,a=n;if(n&&n.chained)for(i=n.body[0].program;a.chained;)a=a.body[a.body.length-1].program;var r={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:o(t.body),closeStandalone:s((i||t).body)};if(e.openStrip.close&&l(t.body,null,!0),n){var u=e.inverseStrip;u.open&&c(t.body,null,!0),u.close&&l(i.body,null,!0),e.closeStrip.open&&c(a.body,null,!0),s(t.body)&&o(i.body)&&(c(t.body),l(i.body))}else e.closeStrip.open&&c(t.body,null,!0);return r},r.prototype.MustacheStatement=function(e){return e.strip},r.prototype.PartialStatement=r.prototype.CommentStatement=function(e){var t=e.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},t.default=r,e.exports=t.default},function(e,t,n){"use strict";var i=n(8).default;t.__esModule=!0,t.SourceLocation=function(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}},t.id=function(e){return/^\[.*\]$/.test(e)?e.substr(1,e.length-2):e},t.stripFlags=function(e,t){return{open:"~"===e.charAt(2),close:"~"===t.charAt(t.length-3)}},t.stripComment=function(e){return e.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")},t.preparePath=function(e,t,n){n=this.locInfo(n);for(var i=e?"@":"",r=[],s=0,o=0,l=t.length;o<l;o++){var c=t[o].part,u=t[o].original!==c;if(i+=(t[o].separator||"")+c,u||".."!==c&&"."!==c&&"this"!==c)r.push(c);else{if(r.length>0)throw new a.default("Invalid path: "+i,{loc:n});".."===c&&(s++,"../")}}return new this.PathExpression(e,s,r,i,n)},t.prepareMustache=function(e,t,n,i,a,r){var s=i.charAt(3)||i.charAt(2),o="{"!==s&&"&"!==s;return new this.MustacheStatement(e,t,n,o,a,this.locInfo(r))},t.prepareRawBlock=function(e,t,n,i){if(e.path.original!==n){var r={loc:e.path.loc};throw new a.default(e.path.original+" doesn't match "+n,r)}i=this.locInfo(i);var s=new this.Program([t],null,{},i);return new this.BlockStatement(e.path,e.params,e.hash,s,void 0,{},{},{},i)},t.prepareBlock=function(e,t,n,i,r,s){if(i&&i.path&&e.path.original!==i.path.original){var o={loc:e.path.loc};throw new a.default(e.path.original+" doesn't match "+i.path.original,o)}t.blockParams=e.blockParams;var l=void 0,c=void 0;n&&(n.chain&&(n.program.body[0].closeStrip=i.strip),c=n.strip,l=n.program);r&&(r=l,l=t,t=r);return new this.BlockStatement(e.path,e.params,e.hash,t,l,e.strip,c,i&&i.strip,this.locInfo(s))};var a=i(n(12))},function(e,t,n){"use strict";t.__esModule=!0;var i=n(13),a=void 0;try{}catch(e){}function r(e,t,n){if(i.isArray(e)){for(var a=[],r=0,s=e.length;r<s;r++)a.push(t.wrap(e[r],n));return a}return"boolean"==typeof e||"number"==typeof e?e+"":e}function s(e){this.srcFile=e,this.source=[]}a||((a=function(e,t,n,i){this.src="",i&&this.add(i)}).prototype={add:function(e){i.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){i.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),s.prototype={prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,"\n"])}),e},each:function(e){for(var t=0,n=this.source.length;t<n;t++)e(this.source[t])},empty:function(){var e=void 0===arguments[0]?this.currentLocation||{start:{}}:arguments[0];return new a(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var t=void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return e instanceof a?e:(e=r(e,this,t),new a(t.start.line,t.start.column,this.srcFile,e))},functionCall:function(e,t,n){return n=this.generateList(n),this.wrap([e,t?"."+t+"(":"(",n,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var i=r(e[n],this);"undefined"!==i&&t.push([this.quotedString(n),":",i])}var a=this.generateList(t);return a.prepend("{"),a.add("}"),a},generateList:function(e,t){for(var n=this.empty(t),i=0,a=e.length;i<a;i++)i&&n.add(","),n.add(r(e[i],this,t));return n},generateArray:function(e,t){var n=this.generateList(e,t);return n.prepend("["),n.add("]"),n}},t.default=s,e.exports=t.default}])}),define("hbs/underscore",[],function(){var e={},t=Array.prototype,n=Object.prototype,i=Function.prototype,a=t.slice,r=t.unshift,s=n.toString,o=n.hasOwnProperty,l=t.forEach,c=t.map,u=t.reduce,h=t.reduceRight,d=t.filter,p=t.every,f=t.some,g=t.indexOf,b=t.lastIndexOf,v=Array.isArray,m=Object.keys,y=i.bind,S=function(e){return new I(e)};S.VERSION="1.3.3";var A=S.each=S.forEach=function(t,n,i){if(null!=t)if(l&&t.forEach===l)t.forEach(n,i);else if(t.length===+t.length){for(var a=0,r=t.length;a<r;a++)if(a in t&&n.call(i,t[a],a,t)===e)return}else for(var s in t)if(S.has(t,s)&&n.call(i,t[s],s,t)===e)return};S.map=S.collect=function(e,t,n){var i=[];return null==e?i:c&&e.map===c?e.map(t,n):(A(e,function(e,a,r){i[i.length]=t.call(n,e,a,r)}),e.length===+e.length&&(i.length=e.length),i)},S.reduce=S.foldl=S.inject=function(e,t,n,i){var a=arguments.length>2;if(null==e&&(e=[]),u&&e.reduce===u)return i&&(t=S.bind(t,i)),a?e.reduce(t,n):e.reduce(t);if(A(e,function(e,r,s){a?n=t.call(i,n,e,r,s):(n=e,a=!0)}),!a)throw new TypeError("Reduce of empty array with no initial value");return n},S.reduceRight=S.foldr=function(e,t,n,i){var a=arguments.length>2;if(null==e&&(e=[]),h&&e.reduceRight===h)return i&&(t=S.bind(t,i)),a?e.reduceRight(t,n):e.reduceRight(t);var r=S.toArray(e).reverse();return i&&!a&&(t=S.bind(t,i)),a?S.reduce(r,t,n,i):S.reduce(r,t)},S.find=S.detect=function(e,t,n){var i;return _(e,function(e,a,r){if(t.call(n,e,a,r))return i=e,!0}),i},S.filter=S.select=function(e,t,n){var i=[];return null==e?i:d&&e.filter===d?e.filter(t,n):(A(e,function(e,a,r){t.call(n,e,a,r)&&(i[i.length]=e)}),i)},S.reject=function(e,t,n){var i=[];return null==e?i:(A(e,function(e,a,r){t.call(n,e,a,r)||(i[i.length]=e)}),i)},S.every=S.all=function(t,n,i){var a=!0;return null==t?a:p&&t.every===p?t.every(n,i):(A(t,function(t,r,s){if(!(a=a&&n.call(i,t,r,s)))return e}),!!a)};var _=S.some=S.any=function(t,n,i){n||(n=S.identity);var a=!1;return null==t?a:f&&t.some===f?t.some(n,i):(A(t,function(t,r,s){if(a||(a=n.call(i,t,r,s)))return e}),!!a)};S.include=S.contains=function(e,t){var n=!1;return null==e?n:g&&e.indexOf===g?-1!=e.indexOf(t):n=_(e,function(e){return e===t})},S.invoke=function(e,t){var n=a.call(arguments,2);return S.map(e,function(e){return(S.isFunction(t)?t||e:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-1/0;var i={computed:-1/0};return A(e,function(e,a,r){var s=t?t.call(n,e,a,r):e;s>=i.computed&&(i={value:e,computed:s})}),i.value},S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var i={computed:1/0};return A(e,function(e,a,r){var s=t?t.call(n,e,a,r):e;s<i.computed&&(i={value:e,computed:s})}),i.value},S.shuffle=function(e){var t,n=[];return A(e,function(e,i,a){t=Math.floor(Math.random()*(i+1)),n[i]=n[t],n[t]=e}),n},S.sortBy=function(e,t,n){var i=S.isFunction(t)?t:function(e){return e[t]};return S.pluck(S.map(e,function(e,t,a){return{value:e,criteria:i.call(n,e,t,a)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;return void 0===n?1:void 0===i?-1:n<i?-1:n>i?1:0}),"value")},S.groupBy=function(e,t){var n={},i=S.isFunction(t)?t:function(e){return e[t]};return A(e,function(e,t){var a=i(e,t);(n[a]||(n[a]=[])).push(e)}),n},S.sortedIndex=function(e,t,n){n||(n=S.identity);for(var i=0,a=e.length;i<a;){var r=i+a>>1;n(e[r])<n(t)?i=r+1:a=r}return i},S.toArray=function(e){return e?S.isArray(e)?a.call(e):S.isArguments(e)?a.call(e):e.toArray&&S.isFunction(e.toArray)?e.toArray():S.values(e):[]},S.size=function(e){return S.isArray(e)?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,n){return null==t||n?e[0]:a.call(e,0,t)},S.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},S.last=function(e,t,n){return null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},S.rest=S.tail=function(e,t,n){return a.call(e,null==t||n?1:t)},S.compact=function(e){return S.filter(e,function(e){return!!e})},S.flatten=function(e,t){return S.reduce(e,function(e,n){return S.isArray(n)?e.concat(t?n:S.flatten(n)):(e[e.length]=n,e)},[])},S.without=function(e){return S.difference(e,a.call(arguments,1))},S.uniq=S.unique=function(e,t,n){var i=n?S.map(e,n):e,a=[];return e.length<3&&(t=!0),S.reduce(i,function(n,i,r){return(t?S.last(n)===i&&n.length:S.include(n,i))||(n.push(i),a.push(e[r])),n},[]),a},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=S.intersect=function(e){var t=a.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=S.flatten(a.call(arguments,1),!0);return S.filter(e,function(e){return!S.include(t,e)})},S.zip=function(){for(var e=a.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t),i=0;i<t;i++)n[i]=S.pluck(e,""+i);return n},S.indexOf=function(e,t,n){if(null==e)return-1;var i,a;if(n)return e[i=S.sortedIndex(e,t)]===t?i:-1;if(g&&e.indexOf===g)return e.indexOf(t);for(i=0,a=e.length;i<a;i++)if(i in e&&e[i]===t)return i;return-1},S.lastIndexOf=function(e,t){if(null==e)return-1;if(b&&e.lastIndexOf===b)return e.lastIndexOf(t);for(var n=e.length;n--;)if(n in e&&e[n]===t)return n;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),a=0,r=new Array(i);a<i;)r[a++]=e,e+=n;return r};var P=function(){};S.bind=function(e,t){var n,i;if(e.bind===y&&y)return y.apply(e,a.call(arguments,1));if(!S.isFunction(e))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(a.call(arguments)));P.prototype=e.prototype;var r=new P,s=e.apply(r,i.concat(a.call(arguments)));return Object(s)===s?s:r}},S.bindAll=function(e){var t=a.call(arguments,1);return 0==t.length&&(t=S.functions(e)),A(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var i=t.apply(this,arguments);return S.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},S.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(a.call(arguments,1)))},S.throttle=function(e,t){var n,i,a,r,s,o,l=S.debounce(function(){s=r=!1},t);return function(){n=this,i=arguments;return a||(a=setTimeout(function(){a=null,s&&e.apply(n,i),l()},t)),r?s=!0:o=e.apply(n,i),l(),r=!0,o}},S.debounce=function(e,t,n){var i;return function(){var a=this,r=arguments;n&&!i&&e.apply(a,r),clearTimeout(i),i=setTimeout(function(){i=null,n||e.apply(a,r)},t)}},S.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments))}},S.wrap=function(e,t){return function(){var n=[e].concat(a.call(arguments,0));return t.apply(this,n)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},S.keys=m||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t},S.values=function(e){return S.map(e,S.identity)},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return A(a.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},S.pick=function(e){var t={};return A(S.flatten(a.call(arguments,1)),function(n){n in e&&(t[n]=e[n])}),t},S.defaults=function(e){return A(a.call(arguments,1),function(t){for(var n in t)null==e[n]&&(e[n]=t[n])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e},S.isEqual=function(e,t){return function e(t,n,i){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;if(t._chain&&(t=t._wrapped),n._chain&&(n=n._wrapped),t.isEqual&&S.isFunction(t.isEqual))return t.isEqual(n);if(n.isEqual&&S.isFunction(n.isEqual))return n.isEqual(t);var a=s.call(t);if(a!=s.call(n))return!1;switch(a){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var r=i.length;r--;)if(i[r]==t)return!0;i.push(t);var o=0,l=!0;if("[object Array]"==a){if(l=(o=t.length)==n.length)for(;o--&&(l=o in t==o in n&&e(t[o],n[o],i)););}else{if("constructor"in t!="constructor"in n||t.constructor!=n.constructor)return!1;for(var c in t)if(S.has(t,c)&&(o++,!(l=S.has(n,c)&&e(t[c],n[c],i))))break;if(l){for(c in n)if(S.has(n,c)&&!o--)break;l=!o}}return i.pop(),l}(e,t,[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!=e.nodeType)},S.isArray=v||function(e){return"[object Array]"==s.call(e)},S.isObject=function(e){return e===Object(e)},S.isArguments=function(e){return"[object Arguments]"==s.call(e)},S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),S.isFunction=function(e){return"[object Function]"==s.call(e)},S.isString=function(e){return"[object String]"==s.call(e)},S.isNumber=function(e){return"[object Number]"==s.call(e)},S.isFinite=function(e){return S.isNumber(e)&&isFinite(e)},S.isNaN=function(e){return e!=e},S.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==s.call(e)},S.isDate=function(e){return"[object Date]"==s.call(e)},S.isRegExp=function(e){return"[object RegExp]"==s.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return o.call(e,t)},S.noConflict=function(){return root._=previousUnderscore,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var i=0;i<e;i++)t.call(n,i)},S.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},S.result=function(e,t){if(null==e)return null;var n=e[t];return S.isFunction(n)?n.call(e):n},S.mixin=function(e){A(S.functions(e),function(t){k(t,S[t]=e[t])})};var w=0;S.uniqueId=function(e){var t=w++;return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,C={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var R in C)C[C[R]]=R;var T=/\\|'|\r|\n|\t|\u2028|\u2029/g,x=/\\(\\|'|r|n|t|u2028|u2029)/g,O=function(e){return e.replace(x,function(e,t){return C[t]})};S.template=function(e,t,n){n=S.defaults(n||{},S.templateSettings);var i="__p+='"+e.replace(T,function(e){return"\\"+C[e]}).replace(n.escape||E,function(e,t){return"'+\n_.escape("+O(t)+")+\n'"}).replace(n.interpolate||E,function(e,t){return"'+\n("+O(t)+")+\n'"}).replace(n.evaluate||E,function(e,t){return"';\n"+O(t)+"\n;__p+='"})+"';\n";n.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+i+"return __p;\n";var a=new Function(n.variable||"obj","_",i);if(t)return a(t,S);var r=function(e){return a.call(this,e,S)};return r.source="function("+(n.variable||"obj")+"){\n"+i+"}",r},S.chain=function(e){return S(e).chain()};var I=function(e){this._wrapped=e};S.prototype=I.prototype;var M=function(e,t){return t?S(e).chain():e},k=function(e,t){I.prototype[e]=function(){var e=a.call(arguments);return r.call(e,this._wrapped),M(t.apply(S,e),this._chain)}};return S.mixin(S),A(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=t[e];I.prototype[e]=function(){var t=this._wrapped;n.apply(t,arguments);var i=t.length;return"shift"!=e&&"splice"!=e||0!==i||delete t[0],M(t,this._chain)}}),A(["concat","join","slice"],function(e){var n=t[e];I.prototype[e]=function(){return M(n.apply(this._wrapped,arguments),this._chain)}}),I.prototype.chain=function(){return this._chain=!0,this},I.prototype.value=function(){return this._wrapped},S}),function(window){var JSON=window.JSON||{};!function(){"use strict";function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,a,r,s,o=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,n=0;n<r;n+=1)s[n]=str(n,l)||"null";return a=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,a}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"==typeof rep[n]&&(a=str(i=rep[n],l))&&s.push(quote(i)+(gap?": ":":")+a);else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(a=str(i,l))&&s.push(quote(i)+(gap?": ":":")+a);return a=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,a}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,i,a=e[t];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(void 0!==(i=walk(a,n))?a[n]=i:delete a[n]);return reviver.call(e,t,a)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",["hbs/handlebars","hbs/underscore","hbs/json2"],function(e,t,n){var i,a,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=function(){throw new Error("Environment unsupported.")},o=[],l="w+",c="hbs",u="/styles/",h="/demo-build/styles/",d="templates/helpers/",p="screen.build.css",f="onHbsRead";e.registerHelper("$",function(){}),"undefined"!=typeof window&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(a=function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return!0===arguments[0]?new XDomainRequest:new XMLHttpRequest;for(t=0;t<3;t++){n=r[t];try{e=new ActiveXObject(n)}catch(e){}if(e){r=[n];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},getIEVersion=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)&&(e=parseFloat(RegExp.$1))}return e},s=function(e,t){var n=!1;if(0!=e.indexOf("http"))n=!1;else{var i="https"===e.substr(0,5)?8:7,r="https"===window.location.href.substr(0,5)?8:7,s=e.substr(i).split("/").shift(),o=getIEVersion();n=s!=window.location.href.substr(r).split("/").shift()&&o>=7}if(n){var l=a(!0);l.open("GET",e),l.onload=function(){t(l.responseText,e)},l.onprogress=function(){},l.ontimeout=function(){},l.onerror=function(){},setTimeout(function(){l.send()},0)}else{var c=a();c.open("GET",e,!0),c.onreadystatechange=function(n){4===c.readyState&&t(c.responseText,e)},c.send(null)}}):"undefined"!=typeof process&&process.versions&&process.versions.node?(i=require.nodeRequire("fs"),s=function(e,t){var n=i.readFileSync(e,"utf8")||"";t(n=n.replace(/^\uFEFF/,""),e)}):"undefined"!=typeof java&&void 0!==java.io&&(s=function(e,t){for(var n,i=new java.io.FileInputStream(e),a=new java.io.InputStreamReader(i,"UTF-8"),r=new java.io.BufferedReader(a),s="";null!==(n=r.readLine());)s+=new String(n)+"\n";r.close(),t(s,e)});var g,b=[],v={},m=[];return{get:function(){return e},write:function(e,t,n){if(t+"@hbs"in o){var i=o[t+"@hbs"];n.asModule(e+"!"+t,i)}},version:"3.0.3",load:function(i,a,r,y){var S=i+"@hbs";(g=g||y).hbs=g.hbs||{};var A=0==g.hbs.helpers,_="";g.hbs.partialsUrl&&((_=g.hbs.partialsUrl).match(/\/$/)||(_+="/")),g.hbs.fetchText&&(s=g.hbs.fetchText);var P;function w(e,n){var i=[];return e&&e.body&&(i=function e(n,i){return t(n).forEach(function(t){t&&t.type&&"PartialStatement"===t.type&&"SubExpression"!==t.name.type&&i.push(t.name.original),t&&t.program&&t.program.body&&e(t.program.body,i),t&&t.inverse&&t.inverse.body&&e(t.inverse.body,i)}),i}(e.body,[])),n&&n.partials&&n.partials.length&&t(n.partials).forEach(function(e){i.push(e)}),t.unique(i)}function E(e){return!!("SubExpression"===e.type||e.params&&e.params.length||e.hash)}function C(n,i){E(n)&&void 0!==n.path&&function(t,n){void 0===e.helpers[t]&&n.push(t)}(n.path.original,i),n&&n.params&&n.params.forEach(function(e){C(e,i)}),n&&n.hash&&n.hash.pairs&&t(n.hash.pairs).forEach(function(e){C(e.value,i)})}function R(e){var n=[],i=[];e&&e.body&&(n=function e(n,i,a,r){a=a?a+".":"";return t(n).forEach(function(t){var n;(E(t)||"MustacheStatement"===t.type)&&C(t,r),t&&t.mustache&&e([t.mustache],i,a+"",r),t&&t.program&&t.program.body&&(n=e([t.path],[],"",r)[0]||"",t.inverse&&t.inverse.body&&e(t.inverse.body,i,a+""+(n?a+""?"."+n:n:""),r),e(t.program.body,i,a+""+(n?a+""?"."+n:n:""),r))}),i}(e.body,[],void 0,i));var a=["helperMissing","blockHelperMissing","each","if","unless","with","log","lookup"];return{vars:t(n).chain().unique().map(function(e){return""===e?".":e.length&&"."===e[e.length-1]?e.substr(0,e.length-1)+"[]":e}).value(),helpers:t(i).chain().unique().map(function(e){if(!t(a).contains(e))return e}).compact().value()}}function T(e){for(var t=e.split("/"),n=0;n<t.length;n++)".."===t[n]?(delete t[n-1],delete t[n]):"."===t[n]&&delete t[n];return t.join("/").replace(/\/\/+/g,"/")}var x=g.hbs&&!1===g.hbs.templateExtension;P=x?a.toUrl(i):a.toUrl(i+"."+(g.hbs&&g.hbs.templateExtension?g.hbs.templateExtension:c)),s(P,function(s,y){var P,E,C,O,I,M=g.isBuild&&g[f]?g[f]:function(e,t,n){return n},k=e.parse(M(i,y,s)),N=function(e){var t,i;if(e&&e.body&&(t=e.body[0])&&"CommentStatement"===t.type)try{return i=t.value.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),n.parse(i),i}catch(e){return n.stringify({description:i})}return"{}"}(k),j=R(k),D=j.vars,J=j.helpers||[],L="",q=[],B=i.substr(0,i.lastIndexOf("/")+1);if("{}"!==N)try{C=n.parse(N)}catch(e){console.log("couldn't parse meta for %s",y)}var F,H,U=w(k,C);for(var G in g.hbs=g.hbs||{},g.hbs._partials=g.hbs._partials||{},U)if(U.hasOwnProperty(G)&&"string"==typeof U[G]){var V,W=U[G];if(V=W.match(/^(\.|\/)+/)?T(B+W):T(_+W),x){if(y===a.toUrl(V))continue}else if(y===a.toUrl(V+"."+(g.hbs&&g.hbs.templateExtension?g.hbs.templateExtension:c)))continue;g.hbs._partials[V]=g.hbs._partials[V]||[],g.hbs._partials[V].references=g.hbs._partials[V].references||[],g.hbs._partials[V].references.push(W),g.hbs._loadedDeps=g.hbs._loadedDeps||{},q[G]="hbs!"+V}if(P=q.join("', '"),J=J.concat(C&&C.helpers?C.helpers:[]),(E=A?"":function(){var e,t=[],n=g.hbs&&g.hbs.helperPathCallback?g.hbs.helperPathCallback:function(e){return(g.hbs&&g.hbs.helperDirectory?g.hbs.helperDirectory:d)+e};for(e=0;e<J.length;e++)t[e]="'"+n(J[e],y)+"'";return t}().join(","))&&(E=","+E),C)try{C.styles&&(b=t.union(b,C.styles),require.isBrowser&&!g.isBuild?(O=document.head||document.getElementsByTagName("head")[0],t(C.styles).forEach(function(e){v[e]||((I=document.createElement("link")).href=g.baseUrl+u+e+".css",I.media="all",I.rel="stylesheet",I.type="text/css",O.appendChild(I),v[e]=I)})):g.isBuild&&(F=require.nodeRequire("fs"),H=t(C.styles).map(function(e){return v[e]?"":(v[e]=!0,"@import url("+e+".css);\n")}).join("\n"),F.open(__dirname+h+p,l,"0666",function(e,t){F.writeSync(t,H,null,encoding="utf8"),F.close(t)}),l="a"))}catch(e){console.log("error injecting styles")}g.isBuild||g.serverRender||(L="t.meta = "+N+";\nt.helpers = "+n.stringify(J)+";\nt.deps = "+n.stringify(q)+";\nt.vars = "+n.stringify(D)+";\n");var Q=g.hbs||{},$=t.extend(Q.compileOptions||{},{originalKeyFallback:Q.originalKeyFallback}),K=function(t,n,i){var a,r;return"data"in(i=i||{})||(i.data=!0),i.compat&&(i.useDepths=!0),a=e.parse(t),r=(new e.Compiler).compile(a,i),(new e.JavaScriptCompiler).compile(r,i)}(s,0,$),z="'hbs!"+i+"',";P&&(P=", '"+P+"'");var Y=[];g.hbs._partials[i]&&(Y=g.hbs._partials[i].references);var X=g.hbs&&g.hbs.handlebarsPath?g.hbs.handlebarsPath:"hbs/handlebars";for(s="/* START_TEMPLATE */\ndefine("+z+"['hbs','"+X+"'"+P+E+"], function( hbs, Handlebars ){ \nvar t = Handlebars.template("+K+");\nHandlebars.registerPartial('"+i+"', t);\n",G=0;G<Y.length;G++)s+="Handlebars.registerPartial('"+Y[G]+"', t);\n";s+=L+"return t;\n});\n/* END_TEMPLATE */\n",g.isBuild&&(o[S]=s),g.isBuild||(s+="\r\n//# sourceURL="+y),g.isBuild?(r.fromText(i,s),a([i],function(e){r(e)})):a(q,function(){r.fromText(s),a([i],function(e){r(e)})}),g.removeCombined&&y&&m.push(y)})},onLayerEnd:function(){g.removeCombined&&i&&m.forEach(function(e){i.existsSync(e)&&i.unlinkSync(e)})}}}),define("js/components/generic_module",["backbone","underscore"],function(e,t){var n=["className","activate"],i=function(e){e=e||{},this.mid=t.uniqueId("module"),t.extend(this,t.pick(e,n)),this.initialize.call(this,e)};return t.extend(i.prototype,e.Events,{className:"GenericModule",initialize:function(){},destroy:function(){},activate:function(e){t.extend(this,t.pick(e,n))}}),i.extend=e.Model.extend,i}),define("js/components/pubsub_events",[],function(){return{START_SEARCH:"[PubSub]-New-Query",INVITING_REQUEST:"[PubSub]-Inviting-Request",DELIVERING_REQUEST:"[PubSub]-New-Request",EXECUTE_REQUEST:"[PubSub]-Execute-Request",EXECUTE_STORED_QUERY:"[PubSub]-Execute-Stored-Query",DELIVERING_RESPONSE:"[PubSub]-New-Response",CLOSING_GATES:"[PubSub]-Closing",CLOSED_FOR_BUSINESS:"[PubSub]-Closed",OPENING_GATES:"[PubSub]-Opening",OPEN_FOR_BUSINESS:"[PubSub]-Ready",SMALL_FIRE:"[PubSub]-Problem",BIG_FIRE:"[PubSub]-Big-Problem",CITY_BURNING:"[PubSub]-Disaster",FEEDBACK:"[FC]-FeedBack",DISPLAY_DOCUMENTS:"[Router]-Display-Documents",DISPLAY_DOCUMENTS_DETAILS:"[Router]-Display-Documents-Details",GET_QTREE:"[FC]-GetQTree",NAVIGATE:"[Router]-Navigate-With-Trigger",PAGE_CHANGE:"[Navigator]Page-Changed",CUSTOM_EVENT:"[PubSub]-Custom-Event",ARIA_ANNOUNCEMENT:"[PubSub]-Aria-Announcement",USER_ANNOUNCEMENT:"[PubSub]-User-Announcement",ALERT:"[Alert]-Message",ORCID_ANNOUNCEMENT:"[PubSub]-Orcid-Announcement",APP_LOADED:"[App]-Application-Loaded",APP_BOOTSTRAPPED:"[App]-Application-Bootstrapped",APP_STARTING:"[App]-Application-Starting",APP_STARTED:"[App]-Application-Started",APP_EXIT:"[App]-Exit",PAPER_SELECTION:"[User]-Paper-Selection",BULK_PAPER_SELECTION:"[User]-Bulk-Paper-Selection",STORAGE_PAPER_UPDATE:"[User]-Paper-Update",LIBRARY_CHANGE:"[PubSub]-Library-Change"}}),define("js/components/pubsub_key",["underscore"],function(e){var t=function(t){e.extend(this,t)};return e.extend(t,{newInstance:function(n){var i={id:e.has(n,"id")?n.id:e.uniqueId(":psk"),creator:e.has(n,"creator")?n.creator:null};return new t({getId:function(){return i.id},getCreator:function(){return i.creator}})}}),t}),define("js/mixins/dependon",["underscore","js/components/pubsub_events","js/components/pubsub_key"],function(e,t,n){return{BeeHive:{setBeeHive:function(t){if(e.isEmpty(t))throw new Error("Huh? Empty Beehive? Trying to be funny?");this.__beehive=t},getBeeHive:function(){if(!this.hasBeeHive())throw new Error("The BeeHive is inactivate (or dead :<})");return this.__beehive},hasBeeHive:function(){return!(!this.__beehive||!(this.__beehive.active||this.__beehive.__facade__&&this.__beehive.getActive()))},getPubSub:function(){if(!this.hasBeeHive())throw new Error("The BeeHive is inactive (or dead >:})");if(this.__ctx||(this.__ctx={}),this.__ctx.pubsub)return this.__ctx.pubsub;var i=this.__beehive.getService("PubSub");return i&&i.__facade__?i:(this.__ctx.pubsub={_key:i.getPubSubKey(),_exec:function(t,a){if((a=e.toArray(a))[0]instanceof n)throw Error("You have given us a PubSub key, this.publish() method does not need it.");a.unshift(this._key),i[t].apply(i,a)},publish:function(){this._exec("publish",arguments)},subscribe:function(){this._exec("subscribe",arguments)},subscribeOnce:function(){this._exec("subscribeOnce",arguments)},unsubscribe:function(){this._exec("unsubscribe",arguments)},getCurrentPubSubKey:function(){return this._key}},e.extend(this.__ctx.pubsub,t),this.__ctx.pubsub)},hasPubSub:function(){return!!this.hasBeeHive()&&e.isObject(this.__beehive.getService("PubSub"))}},App:{setApp:function(t){if(e.isUndefined(t))throw new Error("App object cannot be empty");this.__app=t},getApp:function(){return this.__app},hasApp:function(){return!e.isEmpty(this.__app)}}}}),define("js/components/transition",["underscore"],function(e){var t=function(t,n){if(!e.isString(t))throw new Error("Endpoint name must be a string");this.endpoint=t,e.extend(this,n)};return e.extend(t.prototype,{route:!1,trigger:!1,replace:!1,title:!1,execute:function(){throw new Error("You must override this method")}}),t}),define("js/components/transition_catalog",["underscore","js/components/transition"],function(e,t){var n=function(e){this._catalog={}};return e.extend(n.prototype,{add:function(e){if(!(e instanceof t))throw new Error("You can add only Transition objects");return this._catalog[e.endpoint]=e,e},get:function(e){return this._catalog[e]},remove:function(e){delete this._catalog[e]}}),n}),define("js/components/navigator",["underscore","jquery","cache","js/components/generic_module","js/mixins/dependon","js/components/transition","js/components/transition_catalog","analytics"],function(e,t,n,i,a,r,s,o){var l=i.extend({initialize:function(e){e=e||{},this.router=e.router,this.catalog=new s},activate:function(t){this.setBeeHive(t),this.storage=t.getObject("AppStorage");var n=this.getPubSub();n.subscribe(n.NAVIGATE,e.bind(this.navigate,this)),n.subscribe(n.CUSTOM_EVENT,e.bind(this._onCustomEvent,this))},_onCustomEvent:function(e,t){"update-document-title"===e&&this._updateDocumentTitle(t)},_cleanRoute:function(e){var t=e.match(/[#\/]?([^\/]*)\//);return t&&t.length>1?"/"+t[1]:e},_setPageAndEmitEvent:e.debounce(function(e,t){o("set","page",this._cleanRoute(e)),o("send","pageview",{dimension1:t})},300),navigate:function(n,i,a){var r=t.Deferred();if(!(this.router&&this.router instanceof Backbone.Router))return r.reject(new Error("Navigator must be given 'router' instance")),r.promise();var s=this.catalog.get(n);if(!s)return this.handleMissingTransition(arguments),r.reject(new Error("Missing route; going to 404")),r.promise();if(!s.execute)return r.resolve().promise();var o,l=e.bind(function(){var e=!!(s.replace||i&&i.replace);if(""===s.route||s.route){var a=""===s.route?"/":s.route;this._setPageAndEmitEvent(a,n),this.router.navigate(a,{trigger:!1,replace:e})}t("head").find("meta[data-highwire]").remove(),this._updateDocumentTitle(s.title),r.resolve()},this);try{(o=s.execute.apply(s,arguments))&&e.isFunction(o.then)?o.then(l):l()}catch(e){this.handleTransitionError(s,e,arguments);var c=new Error("Error transitioning to route; going to 404");return r.reject(c).promise()}return r.promise()},_updateDocumentTitle:function(t){if(!e.isUndefined(t)&&!1!==t){var n=this.storage.getDocumentTitle(),i=e.bind(function(e){document.title=""===e?"NASA/ADS":e+" - NASA/ADS",this.storage.setDocumentTitle(e)},this);t!==n&&i(t)}},handleMissingTransition:function(e){console.error("Cannot handle 'navigate' event: "+JSON.stringify(arguments));var t=this.getPubSub();t.publish(t.BIG_FIRE,"navigation-error",arguments),this.catalog.get("404")&&t.publish(t.NAVIGATE,"404")},handleTransitionError:function(e,t,n){console.error("Error while executing transition",e,n),console.error(t.stack);var i=this.getPubSub();i.publish(i.CITY_BURNING,"navigation-error",arguments),this.catalog.get("404")&&i.publish(i.NAVIGATE,"404")},set:function(){if(1==arguments.length){if(arguments[1]instanceof r)return this.catalog.add(arguments[1]);throw new Error("You must be kiddin' sir!")}if(2==arguments.length){var t=arguments[0];if(e.isFunction(arguments[1]))return this.catalog.add(new r(t,{execute:arguments[1]}));if(e.isObject(arguments[1])&&arguments[1].execute)return this.catalog.add(new r(t,arguments[1]));throw new Error("Himmm, I dont know how to create a catalog rule with this input:",arguments)}throw new Error("Himmm, I dont know how to create a catalog rule with this input:",arguments)},get:function(e){return this.catalog.get(e)}});return e.extend(l.prototype,a.BeeHive),l}),define("js/components/facade",["underscore","js/components/facade"],function(e,t){return(t=function(e,t){var n;return n={},this.mixIn(e,t,n),n.mixIn=this.mixIn,n}).prototype.mixIn=function(t,n,i){var a,r;for(a in i=i||this,t)if(r=t[a],a in n){var s=n[a];if("function"==typeof r)i[a]=e.bind(r,n);else if("function"==typeof s)i[a]=e.bind(s,n);else if(e.isUndefined(s));else if(e.isString(s)||e.isNumber(s)||e.isBoolean(s)||e.isDate(s)||e.isNull(s)||e.isRegExp(s))i["get"+a.substring(0,1).toUpperCase()+a.substring(1)]=e.bind(function(){return this.ctx[this.name]},{ctx:n,name:a}),i[a]=s;else if(s.hasOwnProperty("__facade__")&&s.__facade__)i[a]=s;else{if(!(e.isObject(s)&&"getHardenedInstance"in s))throw new Error("Sorry, you can't wrap '"+a+"': "+s);i[a]=s.getHardenedInstance()}}else{if("function"!=typeof r)throw new Error("Unknown key: "+a+"("+r+")");i[a]=e.bind(r,n)}return i.__facade__=!n||Boolean(!n.constructor||(!n.constructor.name||n.constructor.name)),i},t}),define("js/mixins/hardened",["underscore","js/components/facade"],function(e,t){return{_getHardenedInstance:function(e,n){if(!("hardenedInterface"in this||e))throw Error("Error: this.hardenedInterface is not defined");return new t(e||("hardenedInterface"in this?this.hardenedInterface:{}),n)},getHardenedInstance:function(e){return this._getHardenedInstance(e,this)}}}),define("js/components/api_feedback",["underscore","backbone","js/mixins/hardened"],function(e,t,n){var i=function(t){e.extend(this,e.defaults(t||{},{code:200,msg:void 0})),this.setCode(this.code)};i.CODES={INVALID_PASSWORD:498,ACCOUNT_NOT_FOUND:495,ALREADY_LOGGED_IN:493,REQUIRES_LOGIN:491,TOO_MANY_CHARACTERS:486,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,INTERNAL_SERVER_ERROR:500,BAD_GATEWAY:502,SERVER_ERROR:503,TOO_MANY_FAILURES:580,ALL_FINE:200,KEEP_WAITING:190,TESTING:0,MAKE_SPACE:-1,UNMAKE_SPACE:-1.1,SEARCH_CYCLE_STARTED:-2,SEARCH_CYCLE_FAILED_TO_START:-3,SEARCH_CYCLE_PROGRESS:-4,SEARCH_CYCLE_STOP_MONITORING:-5,SEARCH_CYCLE_FINISHED:-6,QUERY_ASSISTANT:-7,ALERT:-8,CANNOT_ROUTE:-9,API_REQUEST_ERROR:-10,BIBCODE_DATA_REQUESTED:-11};var a={};return e.each(e.pairs(i.CODES),function(e){a[e[1]]=e[0]}),e.extend(i.prototype,{hardenedInterface:{code:"integer value of the code",msg:"string message",toJSON:"for cloning",getApiRequest:"to get the original request",getSenderKey:"retrieve the senders key"},initialize:function(){},toJSON:function(){return{code:this.code,msg:this.msg}},setCode:function(e){if(!a[e])throw new Error("This code is not in the list ApiCodes - please extend js/components/api_feedback first:",this.code);this.code=e},setApiRequest:function(e){this.req=e},getApiRequest:function(){return this.req},setMsg:function(e){this.msg=e},getSenderKey:function(){return this.senderKey},setSenderKey:function(e){this.senderKey=e}},n),i.extend=t.Model.extend,i}),define("js/components/multi_params",["backbone","underscore","jquery"],function(e,t,n){return e.Model.extend({locked:!1,_checkLock:function(){if(!0===this.locked)throw Error("Object locked for modifications")},isLocked:function(){return this.locked},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},clone:function(){if(this.isLocked()){var e=new this.constructor(this.attributes);return e.lock(),e}return new this.constructor(this.attributes)},hasVal:function(e){return!t.isEmpty(this.get(e))},_validate:function(e,n){for(var i in e){if(!t.isString(i))throw new Error("Keys must be strings, not: "+i);var a=e[i];if(a=t.without(t.flatten(a),"",!1,null,void 0,NaN),!t.isArray(a))throw new Error("Values were not converted to an Array");if(t.isEmpty(a)&&!0!==n.unset)throw new Error("Empty values not allowed");if(!t.every(a,function(e){return t.isString(e)||t.isNumber(e)&&!t.isNaN(e)}))throw new Error("Invalid value (not a string or number): "+a);e[i]=a}return!0},set:function(n,i,a){var r;if(this._checkLock(),null==n)return this;for(var s in"object"===_typeof(n)?(r=n,a=i):(r={})[n]=i,r){var o=r[s];t.isArray(o)||(r[s]=t.flatten([o]))}e.Model.prototype.set.call(this,r,a)},unset:function(){this._checkLock(),e.Model.prototype.unset.apply(this,arguments)},add:function(n,i,a){var r;if(this._checkLock(),null==n)return this;for(var s in"object"===_typeof(n)?(r=n,a=i):(r={})[n]=i,r){var o=r[s];t.isArray(o)||(o=t.flatten([o])),this.has(s)&&(o=t.clone(this.get(s)).concat(o)),r[s]=o}e.Model.prototype.set.call(this,r,a)},sync:function(){throw Error("MultiParams cannot be saved to server")},url:function(e){e||(e=this.attributes);var i=t.pairs(e).sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}),a=n.param(t.object(i),!0);return a=(a=a.replace(/\+/g,"%20")).replace(/%E2%80%9[ECD]/g,"%22")},parse:function(e,n){if(t.isString(e)){var i={};return(e=decodeURI(e)).indexOf("?")>-1&&(i["#path"]=[e.slice(0,e.indexOf("?"))],e=e.slice(e.indexOf("?")+1)),e.indexOf("#")>-1&&(i["#hash"]=this._parse(e.slice(e.indexOf("#")+1)),e=e.slice(0,e.indexOf("#"))),i["#query"]=this._parse(e),this._checkParsed(i)}return this._checkParsed(e)},_parse:function(e){var t,n={};if(!e.trim())return n;for(var i,a,r=e.slice(e.indexOf("?")+1).split("&"),s=0;s<r.length;s++){t=r[s].split("="),i=decodeURIComponent(t[0].split("+").join(" "));var o=t[1];t.length>2&&(t.shift(),o=t.join("=")),a=decodeURIComponent(o.split("+").join(" ")),void 0!==n[i]?n[i].push(a):n[i]=[a]}return n},_checkParsed:function(e){return t.isObject(e)&&"#query"in e?e["#query"]:e},load:function(e){this._checkLock();var t=this.parse(e);return this.clear(),this.set(t),this}})}),define("js/components/solr_params",["js/components/multi_params","backbone","underscore","jquery"],function(e,t,n,i){return e.extend({fieldsToConcatenate:[],defaultOperator:" ",fieldProcessors:{"*":function(e,t){return[e.join(t.defaultOperator)]}},initialize:function(e,t){t&&n.extend(this,n.pick(t,["fieldsToConcatenate","defaultOperator","fieldProcessors"]))},url:function(t,i){for(var a=n.clone(this.attributes),r=this.fieldsToConcatenate.length,s="",o=0;o<r;o++)s=this.fieldsToConcatenate[o],this.has(s)&&(this.fieldProcessors[s]?a[s]=this.fieldProcessors[s](this.get(s),this):a[s]=this.fieldProcessors["*"](this.get(s),this));return e.prototype.url.call(this,a)}})}),define("js/components/api_query",["backbone","underscore","js/components/solr_params","js/components/facade"],function(e,t,n,i){var a={add:"add values",set:"set (replace existing)",get:"get values",has:"has a key",hasVal:"more specific `has` using _.isEmpty",url:"url string of the params",load:"loads query as a string",clear:"clears all values",unset:"removes a key",toJSON:"values back as JSON object",clone:"make a copy",isLocked:!0,lock:!0,unlock:!0,pairs:"get all values as pairs",keys:"as keys",values:"only values",hasChanged:"whether this object has modification (since its creation)",previousAttributes:"get all changed attributes",previous:"previous values for a given attribute"},r=function(e,t){this.innerQuery=new i(a,e instanceof n?e:new n(e,t))},s={};return t.each(t.keys(a),function(e,t,n){s[e]=function(){return this.innerQuery[e].apply(this.innerQuery,arguments)}}),t.extend(r.prototype,s,{clone:function(){var e=this.innerQuery.clone.apply(this.innerQuery,arguments);return new r(e)},load:function(){var e=this.innerQuery.load.apply(this.innerQuery,arguments);return new r(e)}}),r}),define("js/components/api_query_updater",["underscore","js/components/api_query"],function(e,t){var n=function(t,n){if(!t||!e.isString(t))throw new Error("You must initialize the ApiQueryUpdater with a context (which is a string)");this.context=t,this.defaultOperator=" ",this.operators=[" ","AND","OR","NOT","NEAR"],this.defaultMode="limit",this.operationModes=["limit","exclude","expand","replace","remove"],this.impossibleString="￼￼￼",e.extend(this,n)};return e.extend(n.prototype,{updateQuery:function(t,n,i,a,r){if(r=e.defaults({},r,{prefix:"__"}),!n||!e.isString(n))throw new Error("You must tell us what parameter to update in the ApiQuery");var s,o,l,c,u,h=this._n(n,r.prefix),d=e.clone(t.get(n));if(c=this._getExistingVals(t,h),a=this._sanitizeConditionAsArray(a),"limit"==(i=this._sanitizeMode(i)))u="AND";else if("exclude"==i)u="NOT";else if("expand"==i)u="OR";else{if("replace"==i)return this._closeExistingVals(t,this._n(n,r.prefix)),t.set(this._n(n,r.prefix),["AND",a[0]]),t.set(n,a[0]);if("remove"!=i)throw new Error("Unsupported mode/operator:",i);u=c[0]}if(!t.has(n)){var p=[u].concat(a);return t.set(n,this._buildQueryFromConditions(p)),void t.set(this._n(n,r.prefix),p)}if(c){if(c[0]!==u)return this._closeExistingVals(t,h),this.updateQuery(t,n,i,a);s=this._buildQueryFromConditions(c)}else if(c=[u],1==d.length)if(-1==d[0].indexOf(" "))s=d[0],c.push(d[0]);else{s=d[0];var f=d[0].toLowerCase();f.indexOf(" and ")>-1||f.indexOf(" or ")>-1||f.indexOf(" not ")>-1||f.indexOf(" near")>-1||f.indexOf("(")>2?c.push("("+d[0]+")"):c.push(d[0])}else s=this.impossibleString;if("limit"==i||"expand"==i){l=e.union(c,a),o=this._buildQueryFromConditions(l);var g=e.clone(d);if(this._modifyArrayReplaceString(g,s,o))return t.set(n,g),void t.set(h,l)}if("exclude"==i){var b=e.clone(c);b[0]="OR",s=" NOT "+this._buildQueryFromConditions(b),l=e.union(c,a);var v=e.clone(l);v[0]="OR",o=" NOT "+this._buildQueryFromConditions(v);g=e.clone(d);if(this._modifyArrayReplaceString(g,s,o))return t.set(n,g),void t.set(h,l)}else if("remove"==i){l=e.difference(c,a),o=this._buildQueryFromConditions(l);g=e.clone(d);if(this._modifyArrayReplaceString(g,s,o))return t.set(n,g),void t.set(h,l)}"limit"==i?l=this._modifyArrayAddString(d,a,"AND"):"exclude"==i?l=this._modifyArrayAddString(d,a,"NOT"):"expand"==i&&(l=this._modifyArrayAddString(d,a,"OR")),t.set(h,l),t.set(n,d)},needsEscape:function(e){for(var t,n=0;n<e.length;n++)if("\\"==(t=e[n])||"+"==t||"-"==t||"!"==t||"("==t||")"==t||":"==t||"^"==t||"["==t||"]"==t||'"'==t||"{"==t||"}"==t||"~"==t||"*"==t||"?"==t||"|"==t||"&"==t||"/"==t)return!0;return!1},escape:function(e){for(var t,n=[],i=0;i<e.length;i++)"\\"!=(t=e[i])&&"+"!=t&&"-"!=t&&"!"!=t&&"("!=t&&")"!=t&&":"!=t&&"^"!=t&&"["!=t&&"]"!=t&&'"'!=t&&"{"!=t&&"}"!=t&&"~"!=t&&"*"!=t&&"?"!=t&&"|"!=t&&"&"!=t&&"/"!=t||n.push("\\"),n.push(t);return n.join("")},escapeInclWhitespace:function(e){for(var t,n=[],i=0;i<e.length;i++)"\\"!=(t=e[i])&&"+"!=t&&"-"!=t&&"!"!=t&&"("!=t&&")"!=t&&":"!=t&&"^"!=t&&"["!=t&&"]"!=t&&'"'!=t&&"{"!=t&&"}"!=t&&"~"!=t&&"*"!=t&&"?"!=t&&"|"!=t&&"&"!=t&&"/"!=t&&" "!=t&&"\t"!=t||n.push("\\"),n.push(t);return n.join("")},quoteIfNecessary:function(e,t,n){return this.quote(e,t,n,!0)},quote:function(t,n,i,a){n||(n='"'),i||(i=n),e.isUndefined(a)&&(a=!1);for(var r,s=[],o=!1,l=0;l<t.length;l++)"\\"!=(r=t[l])&&"+"!=r&&"-"!=r&&"!"!=r&&"("!=r&&")"!=r&&":"!=r&&"^"!=r&&"["!=r&&"]"!=r&&'"'!=r&&"{"!=r&&"}"!=r&&"~"!=r&&"|"!=r&&"&"!=r&&"/"!=r&&" "!=r&&"\t"!=r||(o=!0),r!=n&&r!=i||!(0==l||l>0&&"\\"!==t[l-1])||s.push("\\"),s.push(r);return 1==a&&"\\"==s[0]&&'"'==s[1]&&"\\"==s[s.length-2]&&'"'==s[s.length-1]?(s[0]="",s[s.length-2]="",s.join("")):o||0==a?n+s.join("")+i:s.join("")},saveTmpEntry:function(e,t,n){var i,a=this._getTmpStorage(e,!0);return t in a&&(i=a[t]),a[t]=n,i},removeTmpEntry:function(e,t){var n=this._getTmpStorage(e,!0),i=n[t];return delete n[t],i},getTmpEntry:function(e,t,n){var i;return t in(i=n?this._getTmpStorage(e,!0):this._getTmpStorage(e,!1))?i[t]:(i[t]=n,n)},hasTmpEntry:function(e,t){return t in this._getTmpStorage(e)},_getTmpStorage:function(e,t){var n=this._n("__tmpStorage");if(!e.hasOwnProperty(n)){if(!t)return{};e[n]={}}return e[n]},_n:function(t,n){return(e.isString(n)?n:"__")+this.context+"_"+t},_buildQueryFromConditions:function(e){if(e.length<=1)throw new Error("Violation of contract: first condition is always an operator");var t=e[0];return" "!=t&&(t=" "+t+" "),"("+e.slice(1).join(t)+")"},_modifyArrayReplaceString:function(t,n,i,a){var r=0;if(a||(a=-1),!n)throw new Error("Your search is empty, you fool");return e.each(t,function(e,s){a>0&&r>a||e.indexOf(n)>-1&&(t[s]=e.replace(n,i),r+=1)}),r},_modifyArrayAddString:function(e,t,n){if(!(0!=e.length&&""!=e[e.length-1].trim()||"NOT"!=n&&"NEAR"!=n))throw new Error("Invalid operation; cannot apply NOT/NEAR on single clause");var i=[n,e[e.length-1]].concat(t);return e[e.length-1]=this._buildQueryFromConditions(i),i},_getExistingVals:function(e,t,n){return e.has(t)?e.get(t):n},_closeExistingVals:function(e,t){e.unset(t)},_sanitizeMode:function(t){if(!t)return this.defaultMode;var n=e.indexOf(this.operationModes,t);if(-1==n)throw new Error("Unkwnown mode: "+t);return this.operationModes[n]},_sanitizeOperator:function(t){if(!t)return this.defaultOperator;if(!e.isString(t))throw new Error("Operator must be a string");if(""==t.trim())return this.defaultOperator;t=t.toUpperCase();var n=e.indexOf(this.operators,t);if(-1==n)throw new Error("Unknown operator: ",t);return this.operators[n]},_sanitizeConditionAsArray:function(t){if(!t)throw new Error("The condition must be set (string/array of strings)");if(e.isString(t))return[t];if(0==(t=e.without(e.flatten(t),"",!1,null,void 0,NaN)).length)throw new Error("After removing empty values, no condition was left");return t},clean:function(n){var i={};return n&&n.keys&&e.each(n.keys(),function(e){"__"!=e.substring(0,2)&&(i[e]=n.get(e))}),new t(i)}}),n}),define("js/components/json_response",["underscore","backbone","js/components/api_query"],function(e,t,n){var i=function(t,n){var i,a=t||{};n||(n={}),this.rid=e.uniqueId("r"),this.readOnly=!n.hasOwnProperty("readOnly")||n.readOnly,this._url=n.hasOwnProperty("url")?n.url:null,n.parse&&(a=this.parse(a,n)||{}),(i=e.result(this,"defaults"))&&(a=e.defaults({},a,i)),this.attributes=a,this.initialize.apply(this,arguments)};return e.extend(i.prototype,{initialize:function(){},getApiQuery:function(){return this.apiQuery},setApiQuery:function(e){if(e){if(!(e instanceof n))throw new Error("Only ApiQuery instances accepted");this.apiQuery=e}},toJSON:function(e){return this._clone(this.attributes)},url:function(){return this._url?this._url:this.rid},set:function(e,t,n){if(this.readOnly)throw Error("You can't change read-only response object");var i=this._split(e);if(1==i.length)this.attributes[i[0]]=t;else{this.get(e);t}},_split:function(e){for(var t=[],n=0,i=e.length,a=0,r=[];n<i;)e[n]==r[r.length-1]?r.pop():'"'==e[n]||"'"==e[n]?r.push(e[n]):"."==e[n]&&0==r.length?(t.push(e.substring(a,n)),a=n+1):"["==e[n]&&0==r.length&&(t.push(e.substring(a,n)),t.push(e.substring(n,e.indexOf("]",n+1)+1)),a=n=e.indexOf("]",n+1)+1),n+=1;return a<i&&t.push(e.substring(a)),t},has:function(e){return this.get(e,!0)},get:function(t,n,i){if(!t)return this._clone(this.attributes);for(var a=this._split(t),r=[],s=this.attributes;a.length>0;){var o=a.shift();if(s.hasOwnProperty(o))s=s[o],r.push(o);else{if(!(o.indexOf("[")>-1)){if(n)return!1;if(void 0!==i)return i;throw new Error("Can't find: "+t+(r.length>0?" (worked up to: "+r.join(".")+")":""))}var l=o.trim().substring(1,o.length-1);if((l.indexOf('"')>-1||l.indexOf("'")>-1)&&s.hasOwnProperty(l.substring(1,l.length-1)))s=s[l.substring(1,l.length-1)],r.push(l);else{if(!e.isArray(s)){if(n)return!1;if(void 0!==i)return i;throw new Error("Can't find: "+t+(r.length>0?" (worked up to: "+r.join(".")+")":""))}var c=null;try{if(c=parseInt(l),e.isNaN(c)||s.length<=c||c<0){if(n)return!1;if(void 0!==i)return i;throw new Error}s=s[c],r.push(l)}catch(e){if(n)return!1;if(void 0!==i)return i;throw new Error("Can't find: "+t+(r.length>0?" (worked up to: "+r.join(".")+")":""))}}}}return!!n||this._clone(s)},clone:function(){return new this.constructor(this.attributes)},_clone:function(t){return this.readOnly&&e.isObject(t)?e.cloneDeep?e.cloneDeep(t):JSON.parse(JSON.stringify(t)):t},isLocked:function(){return this.readOnly},lock:function(){return this.readOnly=!0},unlock:function(){return this.readOnly=!1}}),i.extend=t.Model.extend,i}),define("js/components/default_request",["underscore","backbone","js/components/api_query","js/components/multi_params"],function(e,t,n,i){var a=function(t){if(e.isString(t))return!0;if(e.isArray(t))for(var n=t.length,i=0;i<n;i++){var a=t[i];if(!e.isString(a)&&!e.isNumber(a))return!1}return!0},r={query:function(t){return!!e.isUndefined(t)||t instanceof n},target:a,sender:a,options:a};return i.extend({_validate:function(t,n){return e.forOwn(t,function(e,n){var i=t[n];if(!(n in r))throw new Error("Invalid attr: "+n);if(!r[n].call(r,i))throw new Error("Invalid value:key "+n+i)}),!0},set:function(e,n,i){var a;if(this._checkLock(),null==e)return this;"object"===_typeof(e)?(a=e,i=n):(a={})[e]=n,t.Model.prototype.set.call(this,a,i)},_checkParsed:function(t){if(e.isObject(t)){var i={};return"#query"in t&&!e.isEmpty(t["#query"])&&(i.query=new n(t["#query"])),"#path"in t&&(i.target=t["#path"][0]),"#hash"in t&&e.extend(i,e.each(t["#hash"],function(e,t,n){1==e.length&&(n[t]=e[0])})),i}return t},url:function(t){t||(t=this.attributes);var n=t.target,a=n?e.isArray(n)?n.join("/"):n:"";return"query"in t&&(a+="?"+t.query.url()),"sender"in t&&(a+="#"+i.prototype.url.call(this,{sender:t.sender})),a},load:function(e){return i.prototype.load.call(this,e.indexOf("?")>-1?e:e+"?")}})}),define("js/components/api_request",["underscore","backbone","js/components/facade","js/components/default_request"],function(e,t,n,i){var a={get:"get a key",set:"set (replace existing)",url:"url string defining this request",has:"has a key",load:"loads request as a string",clear:"clears all values",unset:"removes a key",toJSON:"values back as JSON object",clone:"make a copy",isLocked:!0,lock:!0,unlock:!0,pairs:"get all values as pairs",keys:"as keys",values:"only values",hasChanged:"whether this object has modification (since its creation)",previousAttributes:"get all changed attributes",previous:"previous values for a given attribute"},r=function(e,t){this.innerRequest=new n(a,e instanceof i?e:new i(e,t))},s={};return e.each(e.keys(a),function(e,t,n){s[e]=function(){return this.innerRequest[e].apply(this.innerRequest,arguments)}}),e.extend(r.prototype,s,{clone:function(){var e=this.innerRequest.clone.apply(this.innerRequest,arguments);return new r(e)},load:function(){var e=this.innerRequest.load.apply(this.innerRequest,arguments);return new r(e)}}),r}),define("js/components/api_targets",["underscore","backbone"],function(e,t){var n={BOOTSTRAP:"/accounts/bootstrap",SEARCH:"search/query",QTREE:"search/qtree",BIGQUERY:"search/bigquery",EXPORT:"export/",SERVICE_AUTHOR_NETWORK:"vis/author-network",SERVICE_PAPER_NETWORK:"vis/paper-network",SERVICE_WORDCLOUD:"vis/word-cloud",SERVICE_METRICS:"metrics",SERVICE_OBJECTS:"objects",SERVICE_OBJECTS_QUERY:"objects/query",SERVICE_CITATION_HELPER:"citation_helper",SERVICE_AUTHOR_AFFILIATION_EXPORT:"authoraff",MYADS_STORAGE:"vault",AUTHOR_AFFILIATION_SEARCH:"author-affiliation/search",AUTHOR_AFFILIATION_EXPORT:"author-affiliation/export",RESOLVER:"resolver",CSRF:"accounts/csrf",USER:"accounts/user",USER_DATA:"vault/user-data",SITE_CONFIGURATION:"vault/configuration",TOKEN:"accounts/token",LOGOUT:"accounts/logout",REGISTER:"accounts/register",VERIFY:"accounts/verify",DELETE:"accounts/user/delete",RESET_PASSWORD:"accounts/reset-password",CHANGE_PASSWORD:"accounts/change-password",CHANGE_EMAIL:"accounts/change-email",RECOMMENDER:"recommender",GRAPHICS:"graphics",FEEDBACK:"feedback/slack",LIBRARY_IMPORT_CLASSIC_AUTH:"harbour/auth/classic",LIBRARY_IMPORT_CLASSIC_MIRRORS:"harbour/mirrors",LIBRARY_IMPORT_CLASSIC_TO_BBB:"biblib/classic",LIBRARY_IMPORT_ADS2_AUTH:"harbour/auth/twopointoh",LIBRARY_IMPORT_ADS2_TO_BBB:"biblib/twopointoh",LIBRARY_IMPORT_ZOTERO:"harbour/export/twopointoh/zotero",LIBRARY_IMPORT_MENDELEY:"harbour/export/twopointoh/mendeley",LIBRARY_IMPORT_CREDENTIALS:"harbour/user",ORCID_PREFERENCES:"orcid/preferences",ORCID_NAME:"orcid/orcid-name",LIBRARIES:"biblib/libraries",LIBRARY_TRANSFER:"biblib/transfer",DOCUMENTS:"biblib/documents",PERMISSIONS:"biblib/permissions",REFERENCE:"reference/text",_limits:{ExportWidget:{default:500,limit:3e3},Metrics:{default:7e3,limit:7e3},AuthorNetwork:{default:400,limit:1e3},PaperNetwork:{default:400,limit:1e3},ConceptCloud:{default:150,limit:150},BubbleChart:{default:1500}}};return n._doesntNeedCredentials=[n.SEARCH,n.QTREE,n.BIGQUERY,n.EXPORT,n.SERVICE_AUTHOR_NETWORK,n.SERVICE_PAPER_NETWORK,n.SERVICE_WORDCLOUD,n.SERVICE_METRICS,n.RECOMMENDER,n.GRAPHICS,n.FEEDBACK],n}),define("hbs!404",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return"<!doctype html>\n<html>\n<head>\n  <link rel=\"preload\" href=\"./styles/css/styles.css\" as=\"style\">\n  <link rel=\"stylesheet\" href=\"./styles/css/styles.css\">\n  <script src=\"//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.min.js\"><\/script>\n  <script>\n    !window.requirejs && document.write('<script src=\"./libs/requirejs/require.js\">\\x3C/script>');\n  <\/script>\n  <script>\n    require.config({\n      paths: {\n        'underscore': '//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.2/lodash.min',\n        'google-analytics': [\n          'libs/g',\n          'data:application/javascript,'\n        ],\n        'analytics': 'js/components/analytics',\n        'jquery': '//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min'\n      },\n      shim: {\n        'google-analytics': {\n          exports: '__ga__'\n        }\n      },\n      callback: function () {\n        window.GoogleAnalyticsObject = '__ga__';\n\n        require(['config/discovery.vars'], function(config) {\n          setTimeout(function () {\n            require(['google-analytics', 'analytics'], function () {\n              var qa = window[window.GoogleAnalyticsObject];\n              qa.l = Date.now();\n              qa('create', config.googleTrackingCode || '', config.googleTrackingOptions);\n            });\n          }, 0);\n        });\n      }\n    });\n    require(['analytics'], function (analytics) {\n      analytics('send', 'pageview');\n      analytics('send', 'event', 'error', 'automatic_redirection', '404.html');\n    });\n  <\/script>\n</head>\n<body>\n  <div>\n    <p> Bumblebee failed to load. Please try again.</p>\n  </div>\n</body>\n</html>\n"},useData:!0});return t.registerPartial("404",n),n}),define("hbs!js/apps/discovery/templates/orcid-modal-template",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){return'\n    <p>\n        If you <strong>wish for your ORCID claims to be accessible in the ADS,</strong> please first\n        <a href="#user/settings/orcid">fill out this brief form. </a>\n    </p>\n\n    <p>\n        After you have completed the form, you can immediately begin claiming papers.\n    </p>\n\n\n'},3:function(e,t,n,i){return'\n    <p>\n        If you <strong>want your ORCID claims to be accessible in the ADS,</strong>\n        please sign in to ADS or create an account and provide us with your permission to\n        make your claims public, along with a few other key pieces of information.\n\n    </p>\n    <p>\n        <a href="#user/account/login" class="btn btn-primary">log in to ADS </a>\n        or\n        <a href="#user/account/register" class="btn btn-primary">create a new account</a>\n\n    </p>\n    <p>\n        After you are signed in to your account, go to the "User Preferences" page,\n        click on the "ORCID Settings" tab, and fill in the brief form.\n    </p>\n\n\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a;return"\n\n"+(null!=(a=t.if.call(e,null!=e?e.adsLoggedIn:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?a:"")+"\n<p>\n    <b>If you don't care about your information being searchable in the ADS, just close this message and continue.</b>\n</p>"},useData:!0});return t.registerPartial("js/apps/discovery/templates/orcid-modal-template",n),n}),define("js/mixins/api_access",["underscore","backbone","js/components/api_query","js/components/api_request"],function(e,t,n,i){return{onBootstrap:function(e){var t=this.getBeeHive();if(e.access_token){t.getService("Api").setVals({access_token:e.token_type+":"+e.access_token,refresh_token:e.refresh_token,expire_in:e.expire_in}),console.warn("Redefining access_token: "+e.access_token);var n=t.getObject("User"),i=e.anonymous?void 0:e.username;n.setUser(i);var a=t.getService("PersistentStorage");a&&a.set&&a.set("appConfig",e)}else console.warn("bootstrap didn't provide access_token!")},getApiAccess:function(e){e=e||{};var t=this.getBeeHive().getService("Api"),a=this,r=$.Deferred();return t[e.tokenRefresh?"_request":"request"](new i({query:new n,target:this.bootstrapUrls?this.bootstrapUrls[0]:"/accounts/bootstrap"}),{done:function(t){e.reconnect&&a.onBootstrap(t),r.resolve(t)},fail:function(){r.reject.apply(r,arguments)},type:"GET"}),r}}}),define("js/apps/discovery/navigator",["jquery","backbone","underscore","js/components/navigator","js/components/api_feedback","js/components/api_query_updater","js/components/json_response","js/components/api_query","js/components/api_request","js/components/api_targets","hbs!404","hbs!js/apps/discovery/templates/orcid-modal-template","js/mixins/api_access"],function(e,t,n,i,a,r,s,o,l,c,u,h,d){var p=i.extend({start:function(t){var i=this,s=new r("navigator"),u=function(e){i.getPubSub().publish(i.getPubSub().FEEDBACK,new a(e))},d=function(e){i.getPubSub().publish(i.getPubSub().PAGE_CHANGE,e)},p=["Results","QueryInfo","AffiliationFacet","AuthorFacet","DatabaseFacet","RefereedFacet","KeywordFacet","BibstemFacet","BibgroupFacet","DataFacet","ObjectFacet","NedObjectFacet","VizierFacet","GraphTabs","QueryDebugInfo","ExportDropdown","VisualizationDropdown","SearchWidget","Sort","BreadcrumbsWidget","PubtypeFacet","OrcidSelector"],f=["TOCWidget","SearchWidget","ShowResources","ShowAssociated","ShowGraphicsSidebar","ShowLibraryAdd","MetaTagsWidget"];function g(e){return!t.getBeeHive().getObject("User").isLoggedIn()&&(t.getService("Navigator").navigate("authentication-page",{subView:"login",redirect:!0,next:e}),!0)}function b(n,i,a){return function(r,s){var o=e.Deferred(),l=this;if(g(l.endpoint))return o.resolve(),o.promise();var c=s.subView||i;return c||console.error("no subview or default view provided /to the navigator function!"),t.getObject("MasterPageManager").show("SettingsPage",[n,"UserNavbarWidget"]).then(function(){t.getWidget("SettingsPage").done(function(e){e.setActive(n,c)}),l.route="#user/settings/"+c,l.title="Settings"+(a?" | "+a:""),d("settings-page"),o.resolve()}),o.promise()}}function v(i,a){var r=e.Deferred(),s=this,o=a.widgetName,l=a.additional,c=l.format||"bibtex",u=a.subView,h=a.id,p=a.publicView;function f(i){var a=e.Deferred();return t.getObject("LibraryController").getLibraryBibcodes(i).done(function(e){t.getWidget("LibraryListWidget").then(function(r){var s=r.model.get("sort");t.getWidget(o).then(function(r){l=n.extend({},l,{sort:s}),r.renderWidgetForListOfBibcodes(e,l),t.getWidget("IndividualLibraryWidget").then(function(e){e.setSubView({subView:u,publicView:p,id:i}),a.resolve()})})})}),a.promise()}return"ExportWidget"===o&&"authoraff"===c&&(o="AuthorAffiliationTool"),t.getWidget(o).done(function(e){e.reset?e.reset():e.resetWidget&&e.resetWidget()}).done(function(){"ExportWidget"!==o||"classic"!==c?p?t.getObject("MasterPageManager").show("PublicLibrariesPage",["IndividualLibraryWidget",o]).then(function(){f(h).done(function(){s.route="#public-libraries/"+a.id,r.resolve()})}):t.getObject("MasterPageManager").show("LibrariesPage",["IndividualLibraryWidget","UserNavbarWidget",o]).then(function(){f(h).done(function(){s.route="#user/libraries/"+a.id,d("libraries-page"),r.resolve()})}):r.resolve()}),r.promise()}function m(i,r){var o=e.Deferred(),l=this;r=r||{};var c=t.getObject("AppStorage").getCurrentQuery();if(!c&&r.q)c=r.q;else if(!c&&!r.q)return o.resolve().promise();u({code:a.CODES.MAKE_SPACE});var h=n.map(i.split("-").slice(1),function(e){return e[0].toUpperCase()+e.slice(1)}).join("");return t.getObject("MasterPageManager").show("SearchPage",[h].concat(p.slice(1))).done(function(){var e="#search/"+s.clean(c.clone()).url()+"/"+i.split("-").slice(1).join("-");r&&r.onlySelected?t.getWidget(h).done(function(n){var i=t.getObject("AppStorage").getSelectedPapers();n.renderWidgetForListOfBibcodes(i),l.route=e,o.resolve()}):t.getWidget(h).done(function(t){t.renderWidgetForCurrentQuery({currentQuery:c}),l.route=e,o.resolve()})}),o.promise()}this.set("index-page",function(n){var i=this,a=e.Deferred();return t.getObject("MasterPageManager").show("LandingPage",["SearchWidget"]).then(function(){return t.getWidget("LandingPage").then(function(e){n&&"SearchWidget"===n.origin?e.setActive("SearchWidget"):e.setActive("SearchWidget",null,{origin:"index-page"}),i.route="",i.title="",a.resolve()})}),a.promise()}),this.set("SearchWidget",function(){var t=this,a=e.Deferred();return n.bind(i.get("index-page").execute,this,{origin:"SearchWidget"})().then(function(){t.route="",t.title="",a.resolve()}),a.promise()}),this.set("404",function(){var n=e.Deferred(),i=this;return t.getObject("MasterPageManager").show("ErrorPage").then(function(){i.route="404",i.replace=!0,n.resolve()}),n.promise()}),this.set("ClassicSearchForm",function(){var n=e.Deferred(),i=this;return t.getObject("MasterPageManager").show("LandingPage",["ClassicSearchForm"]).then(function(){t.getWidget("LandingPage").done(function(e){e.setActive("ClassicSearchForm")}),i.route="#classic-form",i.title="Classic Form",n.resolve()}),n.promise()}),this.set("PaperSearchForm",function(){var n=e.Deferred(),i=this;return t.getObject("MasterPageManager").show("LandingPage",["PaperSearchForm"]).then(function(){t.getWidget("LandingPage").done(function(e){e.setActive("PaperSearchForm")}),i.route="#paper-form",i.title="Paper Form",n.resolve()}),n.promise()}),this.set("LibraryImport",function(n,i){var a=this,r=e.Deferred();return g((a=this).endpoint)?(r.resolve(),r.promise()):(t.getObject("MasterPageManager").show("SettingsPage",["LibraryImport","UserNavbarWidget"]).then(function(){t.getWidget("SettingsPage").done(function(e){e.setActive("LibraryImport"),a.route="#user/settings/libraryimport",a.title="Library Import",d("settings-page"),r.resolve()})}),r.promise())}),this.set("UserSettings",b("UserSettings",void 0)),this.set("UserPreferences",b("UserPreferences","librarylink","Library Link Server")),this.set("LibraryActionsWidget",function(){var n=e.Deferred(),i=this;return g(i.endpoint)?n.resolve().promise():(t.getObject("MasterPageManager").show("LibrariesPage",["LibraryActionsWidget","UserNavbarWidget"]).then(function(){t.getWidget("LibraryActionsWidget").done(function(e){e.reset(),i.route="#user/libraries/actions",d("libraries-page"),n.resolve()})}),n.promise())}),this.set("AllLibrariesWidget",function(n,i){var a=e.Deferred(),r=this;if(g(r.endpoint))return a.resolve(),a.promise();i=i||"libraries";return t.getObject("MasterPageManager").show("LibrariesPage",["AllLibrariesWidget","UserNavbarWidget"]).then(function(){t.getWidget("AllLibrariesWidget").done(function(e){e.setSubView({view:i}),e.reset(),r.route="#user/libraries/",r.title="My Libraries",d("libraries-page")}),a.resolve()}),a.promise()}),this.set("LibraryAdminView",function(n){var i=e.Deferred();return t.getObject("MasterPageManager").show("LibrariesPage",["IndividualLibraryWidget","UserNavbarWidget"]).then(function(){t.getWidget("IndividualLibraryWidget").done(function(e){e.setSubView({subView:"admin"})}),d("libraries-page"),i.resolve()}),i.promise()}),this.set("IndividualLibraryWidget",function(i,a){var r=e.Deferred(),s=this;if(a.publicView=!!a.publicView&&a.publicView,!a.publicView&&g(s.endpoint))return r.resolve().promise();this.route=a.publicView?"#public-libraries/"+a.id:"#user/libraries/"+a.id;var o=a.publicView;return t.getObject("MasterPageManager").show(o?"PublicLibrariesPage":"LibrariesPage",o?["IndividualLibraryWidget","LibraryListWidget"]:["IndividualLibraryWidget","LibraryListWidget","UserNavbarWidget"]).then(function(){t.getObject("LibraryController").getLibraryMetadata(a.id).done(function(e){a.editRecords=n.contains(["write","admin","owner"],e.permission)&&!a.publicView,s.title=a.publicView?"Public":"Private Library | "+e.name,t.getWidget("LibraryListWidget","IndividualLibraryWidget").then(function(e){e.LibraryListWidget.setData(a),e.IndividualLibraryWidget.setSubView(a),o&&d("libraries-page"),r.resolve()})})}),r.promise()}),this.set("library-export",v),this.set("library-visualization",v),this.set("library-metrics",v),this.set("library-citation_helper",v),this.set("home-page",function(){var n=e.Deferred(),i=this;return g(i.endpoint)?n.resolve().promise():(t.getObject("MasterPageManager").show("HomePage",[]).then(function(){d("home-page"),i.title="Home",i.route="#user/home",n.resolve()}),n.promise())}),this.set("authentication-page",function(n,a){var r=e.Deferred(),s=(a=a||{}).subView||"login",o=this;return t.getBeeHive().getObject("User").isLoggedIn()?i.get("index-page").execute().then(function(){r.resolve()}):(a.redirect&&(o.replace=!0),t.getObject("MasterPageManager").show("AuthenticationPage",["Authentication"]).then(function(){t.getWidget("Authentication").done(function(e){a.next&&e.setNextNavigation(a.next),e.setSubView(s),o.route="#user/account/"+s,o.title="login"===s?"Sign In":"Register",r.resolve()})})),r.promise()}),this.set("results-page",function(i,r){var l=this,c=e.Deferred();return t.getObject("MasterPageManager").show("SearchPage",p).done(function(){var e=t.getObject("AppStorage").getCurrentQuery();if(e&&e.get("__original_url")){var i="#search/"+e.get("__original_url");e.unset("__original_url")}else i="#search/"+s.clean(e).url();if(e instanceof o){var r={};if(e.has("p_")){var h=function(e){if(n.isString(e))try{return parseInt(e)}catch(e){}return!1}(e.get("p_")[0]);r.page=h}else i+="&p_=0";n.isEmpty(r)||t.getWidget("Results").then(function(e){n.isFunction(e.updatePagination)&&e.updatePagination(r)})}e&&e.get("__qid")&&(i+="&__qid="+e.get("__qid")[0]),l.title=e&&e.get("q").length&&e.get("q")[0],l.route=i,u({code:a.CODES.UNMAKE_SPACE}),c.resolve()}),c.promise()}),this.set("export",function(n,r){var s=e.Deferred(),o=r.format||"bibtex",l=t.getObject("AppStorage");return t.getObject("MasterPageManager").show("SearchPage",["ExportWidget"].concat(p.slice(1))).then(function(){t.getWidget("ExportWidget").done(function(e){if("authoraff"!==o)if(u({code:a.CODES.MAKE_SPACE}),r.onlySelected&&l.hasSelectedPapers())e.renderWidgetForListOfBibcodes(l.getSelectedPapers(),{format:o,sort:l.hasCurrentQuery()&&l.getCurrentQuery().get("sort")[0]});else if(!1===r.onlySelected&&l.hasCurrentQuery())e.renderWidgetForCurrentQuery({format:o,currentQuery:l.getCurrentQuery(),numFound:l.get("numFound")});else if(void 0===r.onlySelected&&l.hasSelectedPapers())e.renderWidgetForListOfBibcodes(l.getSelectedPapers(),{format:o});else if(l.hasCurrentQuery())e.exportQuery({format:o,currentQuery:l.getCurrentQuery(),numFound:l.get("numFound")});else{t.getController("AlertsController").alert({msg:"There are no records to export yet (please search or select some)"}),i.get("results-page")()}else r.onlySelected&&l.hasSelectedPapers()?e.getAuthorAffForm({bibcodes:l.getSelectedPapers()}):e.getAuthorAffForm({currentQuery:l.getCurrentQuery()})}).done(function(){s.resolve()})}),s.promise()}),this.set("export-query",function(){var n=e.Deferred(),i=t.getService("Api"),r=t.getObject("AppStorage").getCurrentQuery(),s=t.getController("AlertsController");return r=new o({query:r.url()}),i.request(new l({query:r,target:c.MYADS_STORAGE+"/query",options:{done:function(){},type:"POST",xhrFields:{withCredentials:!1}}})).done(function(e){s.alert(new a({code:a.CODES.ALERT,msg:'The query has been saved. You can insert the following snippet in a webpage: <br/><img src="'+c.MYADS_STORAGE+"/query2svg/"+e.qid+'"></img><br/><br/><textarea rows="10" cols="50"><a href="'+location.protocol+"//"+location.host+location.pathname+"#execute-query/"+e.qid+'"><img src="'+c.MYADS_STORAGE+"/query2svg/"+e.qid+'"></img></a></textarea>',modal:!0})),n.resolve()}),n.promise()}),this.set("search-page",function(r,l){var c=!1;try{c=document.referrer.indexOf("tugboat/adsabs")>-1}catch(e){}var h,d,f=e.Deferred();l.page&&(h=n.map(l.page.split("-").slice(1),function(e){return e[0].toUpperCase()+e.slice(1)}).join("")),d=h&&["Metrics","AuthorNetwork","PaperNetwork","ConceptCloud","BubbleChart"].indexOf(h)>-1?[h].concat(p.slice(1)):p;var g=this,b=l&&l.context||{};return y(d,b).then(function(){u({code:a.CODES.UNMAKE_SPACE});var e=i.getPubSub();e.subscribe(e.FEEDBACK,function r(u){u&&u.code===a.CODES.SEARCH_CYCLE_FINISHED&&(function(){var e=i.getBeeHive().getObject("AppStorage").getCurrentQuery();e||(e=l.q);var a=s.clean(e);e.has("__qid")&&a.set("__qid",e.get("__qid")),g.route="#search/"+a.url(),e.has("__bigquerySource")?g.title=e.get("__bigquerySource")[0]:g.title=e.get("q").length&&e.get("q")[0],c&&(g.route+="&__tb=1");var r=e;if(r instanceof o){var u={};if(r.has("p_")){var h=function(e){if(n.isString(e))try{return parseInt(e)}catch(e){}return!1}(r.get("p_")[0]);u.page=h}else g.route+="&p_=0";n.isEmpty(u)||t.getWidget("Results").then(function(e){n.isFunction(e.updatePagination)&&e.updatePagination(u)})}l.page&&i.get(l.page)?n.bind(i.get(l.page).execute,g,l.page,{q:e})(l.page).then(function(){f.resolve()}):f.resolve()}(),e.unsubscribe(e.FEEDBACK,r))}),e.publish(e.START_SEARCH,l.q)}),f.promise()}),this.set("execute-query",function(n,r){var s=e.Deferred();return t.getService("Api").request(new l({target:c.MYADS_STORAGE+"/query/"+r,options:{done:function(e){var t=(new o).load(JSON.parse(e.query).query);i.getPubSub().publish(i.getPubSub().START_SEARCH,t),s.resolve()},fail:function(){t.getController("AlertsController").alert(new a({code:a.CODES.ERROR,msg:"The query with the given UUID cannot be found"})),i.get("index-page").execute().then(function(){s.resolve()})},type:"GET",xhrFields:{withCredentials:!1}}})),s.promise()}),this.set("user-action",function(t,n){var r,s,o="",u="",h=e.Deferred(),d=n.token,p=n.subView;function f(e,t,n){i.get("index-page").execute().then(function(){var t=e.responseJSON&&e.responseJSON.error?e.responseJSON.error:"error unknown";i.getPubSub().publish(i.getPubSub().ALERT,new a({code:0,title:u,msg:" <b>"+t+"</b> <br/>"+o,modal:!0,type:"danger"})),h.reject()})}if("register"===p)u="Registration failed.",o="<p>Please try again, or contact <b> adshelp@cfa.harvard.edu for support </b></p>",r=c.VERIFY+"/"+d,s=function(e){i.getApiAccess({reconnect:!0}).done(function(){i.get("index-page").execute().then(function(){var t="<p>You have been successfully registered with the username</p> <p><b>"+e.email+"</b></p>";i.getPubSub().publish(i.getPubSub().ALERT,new a({code:0,title:"Welcome to ADS",msg:t,modal:!0,type:"success"})),h.resolve()})}).fail(function(){this.apply(f,arguments)})};else if("change-email"===p)u="Attempt to change email failed",o="Please try again, or contact adshelp@cfa.harvard.edu for support",r=c.VERIFY+"/"+d,s=function(e){i.getApiAccess({reconnect:!0}).done(function(){i.get("index-page").execute().then(function(){var t="Your new ADS email is <b>"+e.email+"</b>";i.getPubSub().publish(i.getPubSub().ALERT,new a({code:0,title:"Email has been changed.",msg:t,modal:!0,type:"success"})),h.resolve()})}).fail(function(){this.apply(f,arguments)})};else{if("reset-password"!==p)return h.reject("Unknown subView: "+p),h.promise();s=function(){i.getBeeHive().getObject("Session").setChangeToken(d),i.getPubSub().publish(i.getPubSub().NAVIGATE,"authentication-page",{subView:"reset-password-2"}),h.resolve()},u="Password reset failed",o="Reset password token was invalid.",r=c.RESET_PASSWORD+"/"+d}var g=new l({target:r,options:{type:"GET",context:i,done:s,fail:f}});return i.getBeeHive().getService("Api").request(g),h.promise()}),this.set("orcid-instructions",function(){var n=this,i=e.Deferred();return t.getObject("MasterPageManager").show("OrcidInstructionsPage").then(function(){n.route="#orcid-instructions",n.title="Orcid Instructions"}),i.promise()}),this.set("orcid-page",function(r,s){var o=e.Deferred(),l=t.getService("OrcidApi"),c=t.getService("PersistentStorage"),u=t.getObject("AppStorage"),d=t.getObject("User"),p=this;return!l.hasAccess()&&l.hasExchangeCode()?(c?c.set("orcidAuthenticating",!0):console.warn("no persistent storage service available"),void l.getAccessData(l.getExchangeCode()).done(function(e){l.saveAccessData(e),d.setOrcidMode(!0),i.getPubSub().publish(i.getPubSub().APP_EXIT,{url:window.location.pathname+(s&&n.isString(s)?s:window.location.hash)})}).fail(function(){d.setOrcidMode(!1),console.warn("Unsuccessful login to ORCID"),t.getController("AlertsController").alert(new a({code:a.CODES.ALERT,msg:"Error getting OAuth code to access ORCID",modal:!0,events:{click:"button[data-dismiss=modal]"}})).done(function(){i.get("index-page").execute()})})):(l.hasAccess()?(c.get("orcidAuthenticating")&&(c.remove("orcidAuthenticating"),l.getADSUserData().done(function(e){e.hasOwnProperty("authorizedUser")||'["UserPreferences",{"subView":"orcid"}]'===JSON.stringify(u.get("stashedNav"))||t.getController("AlertsController").alert(new a({code:a.CODES.ALERT,msg:h({adsLoggedIn:t.getObject("User").isLoggedIn()}),type:"success",title:"You are now logged in to ORCID",modal:!0}))}).fail(function(e){console.warn(e)})),t.getObject("MasterPageManager").show("OrcidPage",["OrcidBigWidget","SearchWidget"]).then(function(){p.route="/user/orcid",p.title="My Orcid",o.resolve()})):i.get("index-page").execute().then(function(){p.route="",o.resolve()}),o.promise())}),this.set("show-author-network",function(e,t){return m.apply(this,arguments)}),this.set("show-concept-cloud",function(e,t){return m.apply(this,arguments)}),this.set("show-paper-network",function(e,t){return m.apply(this,arguments)}),this.set("show-bubble-chart",function(e,t){return m.apply(this,arguments)}),this.set("show-metrics",function(e,t){return m.apply(this,arguments)}),this.set("visualization-closed",this.get("results-page"));var y=function(e,n){return t.getObject("MasterPageManager").show("SearchPage",e,n)},S=function(n,i){var a=e.Deferred();return t.getObject("MasterPageManager").show("DetailsPage",n).then(function(){return t.getWidget("DetailsPage").then(function(e){a.resolve(e)})}),a.promise()};this.set("verify-abstract",function(){var t,n;e.Deferred;t=new o({q:"identifier:"+this.queryUpdater.quoteIfNecessary(bibcode),fl:"bibcode"}),n=new l({query:t,target:c.SEARCH,options:{done:function(e){subPage&&("Show"+subPage[0].toUpperCase()+subPage.slice(1),bibcode,subPage),e.response&&e.response.docs&&e.response.docs[0]?(bibcode=e.response.docs[0].bibcode,i.getPubSub().publish(i.getPubSub().DISPLAY_DOCUMENTS,new o({q:"bibcode:"+bibcode}))):e.response&&e.response.docs&&!e.response.docs.length&&console.error("the query  "+t.get("q")[0]+"  did not return any bibcodes")},fail:function(){console.log("Cannot identify page to load, bibcode: "+bibcode),i.getPubSub().publish(this.getPubSub().NAVIGATE,"index-page")}}}),this.getPubSub().publish(this.getPubSub().EXECUTE_REQUEST,n)});var A=function(t){var n=e.Deferred(),a=i.getPubSub();if(19===t.length&&/^\d{4}[A-z].*\d[A-z]$/.test(t))return n.resolve(t).promise();var r=new l({target:c.SEARCH,query:new o({q:"identifier:"+t,fl:"bibcode",rows:1}),options:{done:function(e){e&&e.response&&e.response.numFound>0&&n.resolve(e.response.docs[0].bibcode),n.resolve("null")},fail:function(){n.resolve("null")}}});return a.publish(a.EXECUTE_REQUEST,r),n.promise()},_=function(e){var a=e.id,r=e.bibcode,s=e.page,l=e.prefix,c=i.getPubSub();if(c.publish(c.DISPLAY_DOCUMENTS,new o({q:"identifier:"+r})),s.setActive(a),l){var u=t.getObject("AppStorage").getDocumentTitle();u&&-1===u.indexOf(l)&&(this.title=l+" | "+u)}else{var h=n.find(i.getBeeHive().getObject("DocStashController").getDocs()||[],{bibcode:r});h&&(this.title=h.title&&h.title[0])}};this.set("ShowAbstract",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowCitations",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e,prefix:"Citations"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowReferences",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e,prefix:"References"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowCoreads",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e,prefix:"Co-Reads"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowSimilar",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e,prefix:"Similar Papers"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowToc",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e,prefix:"Volume Content"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowMetrics",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{id:t,bibcode:r,page:e,prefix:"Metrics"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("ShowExportcitation",function(n,a){var r=this,s=e.Deferred(),l=a.subView||"default";return t.getObject("MasterPageManager").show("DetailsPage",[n].concat(f)).done(function(){t.getWidget("DetailsPage").done(function(e){a.bibcode&&A(a.bibcode).then(function(t){if(i.getPubSub().publish(i.getPubSub().DISPLAY_DOCUMENTS,new o({q:"identifier:"+t})),"null"===t)return e.setActive(null);e.widgets[n].ingestBroadcastedPayload(t),e.setActive(n,l),r.route=a.href,r.replace=!0,s.resolve()})})}),s.promise()}),this.set("ShowGraphics",function(t,n){var i=this,a=e.Deferred();return S([t].concat(f)).then(function(e){n.bibcode&&A(n.bibcode).then(function(r){_.call(i,{bibcode:r,page:e,id:t,prefix:"Graphics"}),i.route=n.href,i.replace=!0,a.resolve()})}),a.promise()}),this.set("show-author-affiliation-tool",function(n,i){var r=e.Deferred(),o=this,l=t.getObject("AppStorage").getCurrentQuery();return t.getObject("MasterPageManager").show("SearchPage",["AuthorAffiliationTool"].concat(p.slice(1))).done(function(){u({code:a.CODES.MAKE_SPACE}),t.getWidget("AuthorAffiliationTool").done(function(e){if(i&&i.onlySelected){var n=t.getObject("AppStorage").getSelectedPapers();e.renderWidgetForListOfBibcodes(n)}else e.renderWidgetForCurrentQuery({currentQuery:l});o.route="#search/"+s.clean(l).url(),r.resolve()})}),r.promise()})}});return n.extend(p.prototype,d),p}),define("js/components/solr_response",["js/components/json_response","js/components/solr_params","backbone","underscore","jquery"],function(e,t,n,i,a){return e.extend({initialize:function(){if(!this.has("responseHeader.params"))throw new Error("SOLR data error - missing: responseHeader.params");if(i.isString(this._url)){var e=new t;this._url=new t(e.parse(this._url)).url()}else{var n=this.get("responseHeader.params");this._url=new t(n).url()}},url:function(e,t){return this._url}})}),define("js/components/api_response",["underscore","backbone","js/components/solr_response","js/components/facade"],function(e,t,n,i){var a={set:"set (replace existing)",get:"get values",has:"has a key",toJSON:"values back as JSON object",clone:"make a copy",url:"url string of the params",isLocked:!0,lock:!0,unlock:!0,setApiQuery:"sets the ApiQuery",getApiQuery:"gets the query"},r=function(e,t){this.innerResponse=new i(a,e instanceof n?e:new n(e,t))},s={};return e.each(e.keys(a),function(e,t,n){s[e]=function(){return this.innerResponse[e].apply(this.innerResponse,arguments)}}),e.extend(r.prototype,s,{clone:function(){var e=this.innerResponse.clone.apply(this.innerResponse,arguments);return new r(e)}}),r}),define("js/bugutils/diagnostics",["jquery","underscore","js/components/api_query","js/components/api_request","js/components/api_response","js/mixins/dependon","js/components/generic_module","sprintf","js/components/api_targets"],function(e,t,n,i,a,r,s,o,l){var c=s.extend({activate:function(e,t){this.setApp(t),this.setBeeHive(e)},getFirstDoc:function(n,i){var a={query:{q:n,fl:"title,abstract,bibcode,id,author"},target:l.SEARCH};i&&t.extend(a,i);var r=e.Deferred();return this.apiRequest(a).done(function(e){r.resolve(e.response.docs[0])}),r.promise()},apiRequest:function(e,t){var a=this.getApp().getService("Api");if(!(e=e||{}).query)throw Error('You must pass in "query"');e.query instanceof n||(e.query=new n(e.query));var r=new i({target:e.target||l.SEARCH,query:e.query});return a.request(r,t)},ajax:function(t){var n=this.getApp().getService("Api");return t.headers=t.header||{},t.headers.Authorization=n.access_token,e.ajax(t)},jsonp:function(e,n){return e.dataType="jsonp",e.beforeSend=function(e,i){var a=i.url.split("&");t.each(a,function(e){e.startsWith("callback=")&&(i.url+="&"+(n||"json.wrf")+"="+e.replace("callback=",""))})},this.ajax(e)},printComparison:function(e){var t=[],n="%40s %40s %40s %10s";for(var i in t.push(o.sprintf(n,"field",e.first,e.second,"diff")),t.push("------------------------------------------------------------------------------------------------------------------------------------"),e.fields){var a=e.fields[i];t.push(o.sprintf(n,i,a.first,a.second,a.diff))}return console.log(t.join("\n")),t},compareTwoSearchInstances:function(n,i,a,r){var s=this,o=e.Deferred();if(a&&r){var l=this.countDocsInFields(n,a),c=this.countDocsInFields(i,r);e.when(l,c).done(function(e,a){var r=t.keys(e.fields),s=t.keys(a.fields),l=t.unique(r.concat(s)).sort(),c={};for(var u in l){u=l[u];var h=e.fields[u],d=a.fields[u];c[u]={first:h?h.numFound:"--",second:d?d.numFound:"--",diff:h&&d?d.numFound-h.numFound:"--"}}o.resolve({first:n,second:i,fields:c})})}else{var u=this.getListOfFields(n),h=this.getListOfFields(i);e.when(u,h).done(function(e,t){s.compareTwoSearchInstances(n,i,e,t).done(function(e){o.resolve(e)})})}return o},getListOfFields:function(t){var n=e.Deferred();return this.jsonp({url:t+"/admin/luke?numTerms=0&wt=json&indent=true",timeout:6e4}).done(function(e){var t=[];for(var i in e.fields)i.startsWith("_")||t.push(i);n.resolve(t)}),n},countDocsInFields:function(t,n){var i=e.Deferred(),a=[],r={},s={fields:{}};for(var o in n){var l=n[o],c=(e.Deferred(),"{!lucene}"+l+":*");console.log("Getting num docs for: "+c);var u=this.jsonp({url:t+"/query?q="+c+"&fl=id&wt=json&indent=true",context:{field:l,finalResult:s,cycleR:r},timeout:3e5}).done(function(e){this.finalResult.fields[this.field]={numFound:e.response.numFound};var n=0,a=[];for(var r in this.cycleR)"pending"==this.cycleR[r].state()&&(n+=1,a.push(r));console.log(t+" Got response for: "+this.field+" numFound: "+e.response.numFound+" requests to go: "+n+" "+(a.length<5?a.join(", "):"")),0==n&&i.resolve(this.finalResult)});r[l]=u,a.push(u)}return i},request:function(t){return e.ajax(t)},testOrcidLogin:function(){var e=this.getApp().getService("OrcidApi");e.signOut(),window.location=e.config.loginUrl},testOrcidSendingData:function(){var e=this.getApp();this.getFirstDoc("bibcode:1978yCat.1072....0C").done(function(t){e.getService("OrcidApi").addWorks([t]).done(function(e){console.log("result:",e,"expected: {}")})})},printPubSubSubscribers:function(e){var n=this.getApp().getService("PubSub"),i={};this.getApp().triggerMethodOnAll(function(e,t){if(this===n)i[n.pubSubKey.getId()]=e;else if(this.hasPubSub&&this.hasPubSub()){var a=this.getPubSub();a.getCurrentPubSubKey&&(i[a.getCurrentPubSubKey().getId()]&&console.warn("Redefining key that already exists: "+a.getCurrentPubSubKey().getId()+" "+i[a.getCurrentPubSubKey().getId()]),i[a.getCurrentPubSubKey().getId()]=e)}else console.warn("Instance without active PubSub: "+e,this)}),e&&(console.log("Printing list of all issued keys to PubSub"),t.each(t.keys(n._issuedKeys),function(e){var t;n._issuedKeys[e].getId&&i[n._issuedKeys[e].getId()]&&(t=i[n._issuedKeys[e].getId()]),t?console.log(e+"(parent:"+t+") -> "+i[e]):console.log(e+" -> "+i[e])}));var a={};console.log("Printing active subscribers to PubSub"),t.each(n._events,function(e,n,r){console.log(n+" ("+e.length+")"),t.each(e,function(e){var t=e.ctx.getId?i[e.ctx.getId()]:"unknown object";console.log("\t"+t),a[t]=a[t]?a[t]+1:1,void 0==t&&(a["undefined keys"]||(a["undefined keys"]=[]),a["undefined keys"].push(n+(e.ctx.getId?e.ctx.getId():"X")))})}),console.log(JSON.stringify(a,null," "))}});return t.extend(c.prototype,r.App,r.BeeHive),c}),define("js/components/alerts",["backbone","js/mixins/hardened"],function(e,t){return{TYPE:{ERROR:"error",INFO:"info",WARNING:"warning",SUCCESS:"success",DANGER:"danger"},ACTION:{CALL_PUBSUB:2,TRIGGER_FEEDBACK:1}}}),define("js/components/alerts_mediator",["underscore","jquery","cache","js/components/generic_module","js/mixins/dependon","js/components/api_feedback","js/mixins/hardened","js/components/alerts"],function(e,t,n,i,a,r,s,o){var l=i.extend({initialize:function(t){e.extend(this,e.pick(t,["debug","widgetName"]))},activate:function(t,n){this.setBeeHive(t),this.setApp(n);var i=this.getPubSub();i.subscribe(i.ALERT,e.bind(this.onAlert,this)),i.subscribe(i.NAVIGATE,e.bind(this.onNavigate,this)),this.getWidget().fail(function(){console.error("If you want to use AlertController, you also need to have a Widget capable of displaying the messages (default: AlertsWidget)"),i.publish(i.BIG_FIRE,"Alerts Widget not available")})},onNavigate:function(e){var t=this,n=this.getPubSub();"authentication-page"===e&&n.subscribeOnce(n.NAVIGATE,function(){var e=t.getWidget();e&&e.closeView&&e.closeView()})},onAlert:function(t,n){var i=this;return this.alert(t).done(function(t){if(e.isFunction(t))t();else if(e.isObject(t)&&t.action){switch(t.action){case o.ACTION.TRIGGER_FEEDBACK:i.getPubSub().publish(i.getPubSub().FEEDBACK,new r(t.arguments));break;case o.ACTION.CALL_PUBSUB:i.getPubSub().publish(t.signal,t.arguments);break;default:throw new Error("Unknown action type:"+t)}i._widget&&i._widget.closeView&&i._widget.closeView()}})},getWidget:function(){var e=t.Deferred(),n=this;return this._widget?e.resolve(this._widget):this.getApp()._getWidget(this.widgetName||"AlertsWidget").done(function(t){n._widget=t,e.resolve(t)}).fail(function(){e.reject()}),e.promise()},alert:function(e){var n=t.Deferred();return this.getWidget().done(function(t){t?t.alert(e).done(function(){n.resolve.apply(n,arguments)}):(console.warn('"AlertsWidget" has disappeared, we cant display messages to the user'),n.reject("AlertsWidget has disappeared"))}).fail(function(){n.reject("AlertsWidget not available")}),n.promise()},hardenedInterface:{debug:"state of the alerts",getHardenedInstance:"allow to create clone of the already hardened instance"}});return e.extend(l.prototype,a.BeeHive,a.App),e.extend(l.prototype,s),l}),define("js/components/app_storage",["backbone","underscore","js/components/api_query","js/mixins/hardened","js/mixins/dependon"],function(e,t,n,i,a){var r=e.Model.extend({activate:function(e){this.setBeeHive(e),t.bindAll(this,"onPaperSelection","onBulkPaperSelection");var n=this.getPubSub();n.subscribe(n.PAPER_SELECTION,this.onPaperSelection),n.subscribe(n.BULK_PAPER_SELECTION,this.onBulkPaperSelection)},initialize:function(){this.on("change:selectedPapers",function(e){if(this._updateNumSelected(),this.hasPubSub())var t=this.getPubSub();t.publish(t.STORAGE_PAPER_UPDATE,this.getNumSelectedPapers())})},setCurrentQuery:function(e){if(e||(e=new n),!(e instanceof n))throw new Error("You must save ApiQuery instance");this.set("currentQuery",e),this.getBeeHive().hasService("PersistentStorage")&&this.getBeeHive().getService("PersistentStorage").set("currentQuery",e.toJSON())},setCurrentNumFound:function(e){this.set("numFound",e)},getCurrentQuery:function(){return this.get("currentQuery")},hasCurrentQuery:function(){return this.has("currentQuery")},hasSelectedPapers:function(){return!!t.keys(this.get("selectedPapers")).length},getSelectedPapers:function(){return t.keys(this.get("selectedPapers")||{})},clearSelectedPapers:function(){this.set("selectedPapers",{})},addSelectedPapers:function(e){var n=t.clone(this.get("selectedPapers")||{}),i=!1;t.isArray(e)?t.each(e,function(e){n[e]||(n[e]=!0,i=!0)}):n[e]||(n[e]=!0,i=!0),i&&this.set("selectedPapers",n)},isPaperSelected:function(e){if(t.isArray(e))throw new Error("Identifier must be a string or a number");return!!(this.get("selectedPapers")||{})[e]},removeSelectedPapers:function(e){var n=t.clone(this.get("selectedPapers")||{});t.isArray(e)?t.each(e,function(e){delete n[e]}):e?delete n[e]:n={},this.set("selectedPapers",n)},getNumSelectedPapers:function(){return this._numSelectedPapers||0},_updateNumSelected:function(){this._numSelectedPapers=t.keys(this.get("selectedPapers")||{}).length},onPaperSelection:function(e){this.isPaperSelected(e)?this.removeSelectedPapers(e):this.addSelectedPapers(e)},onBulkPaperSelection:function(e,t){"remove"!=t?this.addSelectedPapers(e):this.removeSelectedPapers(e)},setConfig:function(e){this.set("dynamicConfig",e)},getConfigCopy:function(){return JSON.parse(JSON.stringify(this.get("dynamicConfig")))},setDocumentTitle:function(e){this.set("documentTitle",e)},getDocumentTitle:function(){return this.get("documentTitle")},hardenedInterface:{getNumSelectedPapers:"getNumSelectedPapers",isPaperSelected:"isPaperSelected",hasSelectedPapers:"hasSelectedPapers",getSelectedPapers:"getSelectedPapers",clearSelectedPapers:"clearSelectedPapers",getCurrentQuery:"getCurrentQuery",hasCurrentQuery:"hasCurrentQuery",setDocumentTitle:"setDocumentTitle",getDocumentTitle:"getDocumentTitle",getConfigCopy:"get read-only copy of dynamic config",set:"set a value into app storage",get:"get a val from app storage"}});return t.extend(r.prototype,i,a.BeeHive),r}),define("js/components/services_container",["js/components/facade","js/components/generic_module","js/mixins/hardened","underscore"],function(e,t,n,i){var a=t.extend({initialize:function(e){this._services=i.has(e,"services")?i.clone(e.services):{}},activate:function(){var e=arguments;i.each(i.values(this._services),function(t){i.isObject(t)&&"activate"in t&&t.activate.apply(t,e)})},destroy:function(){for(var e in this._services)this.remove(e)},add:function(e,t){if(this._services.hasOwnProperty(e))throw new Error("The service: "+e+" is already registered, remove it first!");if(!e||!t||!i.isString(e))throw new Error("The key must be a string and the service is an object");this._services[e]=t},remove:function(e,t){if(this._services.hasOwnProperty(e)){var n=this._services[e];return"destroy"in n&&n.destroy(),delete this._services[e],n}return null},has:function(e){return this._services.hasOwnProperty(e)},get:function(e){return this._services[e]},getAll:function(){return i.pairs(this._services)}});return i.extend(a.prototype,n,{getHardenedInstance:function(){var e,t={};for(var n in this._services)e=this._services[n],i.isObject(e)&&"getHardenedInstance"in e&&(t[n]=!0);var a=new this.constructor({services:this._getHardenedInstance(t,this._services)});return this._getHardenedInstance({get:!0,has:!0},a)}}),a}),define("js/components/beehive",["backbone","underscore","js/components/generic_module","js/mixins/dependon","js/mixins/hardened","js/components/services_container"],function(e,t,n,i,a,r){var s=[],o=n.extend({initialize:function(e){t.extend(this,t.pick(e,s)),this.Services=new r,this.Objects=new r,this.debug=!1,this.active=!0},activate:function(){this.Services.activate.apply(this.Services,arguments),this.Objects.activate(this),this.active=!0},destroy:function(){this.Services.destroy(arguments),this.Objects.destroy(arguments),this.active=!1},getService:function(e){return this.Services.get(e)},hasService:function(e){return this.Services.has(e)},addService:function(e,t){return this.Services.add(e,t)},removeService:function(e){return this.Services.remove(e)},getObject:function(e){return this.Objects.get(e)},hasObject:function(e){return this.Objects.has(e)},addObject:function(e,t){return this.Objects.add(e,t)},removeObject:function(e){return this.Objects.remove(e)},getDebug:function(){return this.debug},getAllServices:function(){return this.Services.getAll()},getAllObjects:function(){return this.Objects.getAll()},hardenedInterface:{Services:"services container",Objects:"objects container",debug:"state of the app",active:"active or not",getHardenedInstance:"allow to create clone of the already hardened instance"}});return t.extend(o.prototype,a,{getHardenedInstance:function(e){(e=t.clone(e||this.hardenedInterface)).getService=function(e){return n.Services.get(e)},e.hasService=function(e){return n.Services.has(e)},e.getObject=function(e){return n.Objects.get(e)},e.hasObject=function(e){return n.Objects.has(e)};var n=this._getHardenedInstance(e,this);return n}}),o}),define("js/components/application",["underscore","jquery","backbone","module","js/components/beehive","js/mixins/api_access"],function(e,t,n,i,a,r){var s=function(t){t||(t={}),this.aid=e.uniqueId("application"),this.debug=!0,e.extend(this,e.pick(t,["timeout","debug"])),this.initialize.apply(this,arguments)},o=function(){this.container={}};return e.extend(o.prototype,{has:function(e){return this.container.hasOwnProperty(e)},get:function(e){return this.container[e]},remove:function(e){delete this.container[e]},add:function(e,t){this.container[e]=t}}),e.extend(s.prototype,{initialize:function(e,t){this.__beehive=new a,this.__modules=new o,this.__controllers=new o,this.__widgets=new o,this.__plugins=new o,this.__barbarianRegistry={},this.__barbarianInstances={}},shim:function(){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))},loadModules:function(n,i){var a,r=[],s=this,o=n.core;o&&e.each(["controllers","modules","services","objects"],function(e){o[e]&&(a=s._loadModules(e,o[e]))&&r.push(a)});var l=n.plugins,c=n.widgets;i&&i.eagerLoad?(l&&(a=s._loadModules("plugins",l))&&r.push(a),c&&(a=s._loadModules("widgets",c))&&r.push(a)):(l&&e.each(l,function(e,t){var n={};n[t]=e,s.__plugins.add(t,s._loadModules("plugins",n,!1,!0))}),c&&e.each(c,function(e,t){var n={};n[t]=e,s.__widgets.add(t,s._loadModules("widgets",n,!1,!0))})),1===r.length&&r.push(a);var u=t.Deferred();return t.when.apply(t,r).then(function(){e.each(arguments,function(t,n){e.isArray(t)&&(s.debug&&console.log("application: registering "+t[0]),s._registerLoadedModules.apply(s,t))})}).done(function(){u.resolve()}).fail(function(){console.error("Generic error - we were not successul in loading all modules for config",n),arguments.length&&console.error(arguments),u.reject.apply(u,arguments)}),u.promise()},getBeeHive:function(){return this.__beehive},_registerLoadedModules:function(t,n){var i,a,r,s,o,l,c=this.getBeeHive(),u=this;if(l=function(e,t){if(t)return u.debug&&console.log("Creating instance of: "+e),t.prototype?new t:t&&t.hasOwnProperty(e)?t[e]:t;console.warn("Object "+e+" is empty, cannot instantiate it!")},"controllers"==t)r=e.bind(this.hasController,this),o=e.bind(function(e){this.__controllers.remove(e)},this),s=e.bind(function(e,t){this.__controllers.add(e,t)},this);else if("services"==t)r=e.bind(c.hasService,c),o=e.bind(c.removeService,c),s=e.bind(c.addService,c);else if("objects"==t)r=e.bind(c.hasObject,c),o=e.bind(c.removeObject,c),s=e.bind(c.addObject,c);else if("modules"==t)l=function(e,t){return t},r=e.bind(this.hasModule,this),o=e.bind(function(e){this.__modules.remove(e)},this),s=e.bind(function(e,t){this.__modules.add(e,t)},this);else if("widgets"==t)r=e.bind(this.hasWidget,this),o=e.bind(function(e){this.__widgets.remove(e)},this),s=e.bind(function(e,t){this.__widgets.add(e,t)},this),l=function(e,t){return t};else{if("plugins"!=t)throw new Error("Unknown section: "+t);r=e.bind(this.hasPlugin,this),o=e.bind(function(e){this.__plugins.remove(e)},this),s=e.bind(function(e,t){this.__plugins.add(e,t)},this),l=function(e,t){return t}}e.each(e.pairs(n),function(e){i=e[0],a=e[1],r(i)&&o(i);var t=l(i,a);t?s(i,t):console.warn("Removing "+i+"(because it is null!)")})},_checkPrescription:function(t){e.each(e.pairs(t),function(t,n,i){var a=t[0],r=t[1];if(!e.isString(a)||!e.isString(r))throw new Error("You are kidding me, the key/implementation must be string values")})},_loadModules:function(n,i,a,r){var s=this;this._checkPrescription(i),this.debug&&console.log("application: loading "+n,i);var o={},l=e.keys(i),c=e.values(i),u=t.Deferred(),h=function(){s.debug&&console.timeEnd("startLoading"+n);var t=arguments;e.each(l,function(e,n,i){o[e]=t[n]}),u.resolve(n,o),s.debug&&console.log("Loaded: type="+n+" state="+u.state(),o)},d=function(e){var t=e.requireModules&&e.requireModules[0];s.debug&&console.warn("Error loading impl="+t,e.requireMap),a?s.debug&&console.warn("Ignoring error"):u.reject(e)},p=function(){return s.debug&&console.time("startLoading"+n),require(c,h,d),s._setTimeout(u).promise()};return p.lazyLoad=r,r?p:p()},_setTimeout:function(e){return setTimeout(function(){"resolved"!=e.state()&&e.reject("Timeout, application is loading too long")},this.timeout||3e4),e},destroy:function(){this.getBeeHive().destroy()},activate:function(t){var n=this.getBeeHive(),i=this;i.debug&&console.log("application: beehive.activate()"),n.activate(n),e.each(this.getAllControllers(),function(e){i.debug&&console.log("application: controllers: "+e[0]+".activate(beehive, app)");var t=e[1];"activate"in t&&t.activate(n,i)}),e.each(this.getAllModules(),function(e){try{i.debug&&console.log("application: modules: "+e[0]+".activate(beehive)");var t=e[1];"activate"in t&&t.activate(n)}catch(t){console.error("Error activating:"+e[0]),console.error(t)}}),this.__activated=!0},isActivated:function(){return this.__activated||!1},hasService:function(e){return this.getBeeHive().hasService(e)},getService:function(e){return this.getBeeHive().getService(e)},hasObject:function(e){return this.getBeeHive().hasObject(e)},getObject:function(e){return this.getBeeHive().getObject(e)},hasController:function(e){return this.__controllers.has(e)},getController:function(e){return this.__controllers.get(e)},hasModule:function(e){return this.__modules.has(e)},getModule:function(e){return this.__modules.get(e)},hasWidget:function(e){return this.__widgets.has(e)},getWidgetRefCount:function(e,t){var n=this.__barbarianInstances[(t||"widget:")+e];return n?n.counter:-1},incrRefCount:function(e,t){var n=e+":"+t;if(!this.__barbarianInstances[n])throw Error("Invalid operation"+n+" is not initialized");this.__barbarianInstances[n].counter++},getWidget:function(n){var i=t.Deferred(),a=this;if(arguments.length>1){var r={},s=[];e.each(arguments,function(t){var n=t;s.push(a._getWidget(t).fail(function(){throw console.error("Error loading: "+t),e.each(r,function(e,t){a.returnWidget(t),delete r[t]}),er}).done(function(e){r[n]=e}))}),t.when.apply(t,s).done(function(){i.resolve(r)})}else n&&this._getWidget(n).done(function(e){i.resolve(e)});return setTimeout(function(){i.done(function(t){e.isArray(n)?e.each(n,function(e){a.returnWidget(e)}):a.returnWidget(n)})},1),i.promise()},_getWidget:function(e){return this._getThing("widget",e)},_getThing:function(e,n){var i=t.Deferred(),a=this;return this._lazyLoadIfNecessary(e,n).done(function(){var t=a._getOrCreateBarbarian(e,n);a.incrRefCount(e,n),i.resolve(t)}),i.promise()},returnWidget:function(e){var t=this.__barbarianInstances["widget:"+e];if(!t||!t.parent.dontKillMe)return t?(t.counter--,this._killBarbarian("widget:"+e),t.counter):-1},hasPlugin:function(e){return this.__plugins.has(e)},getPlugin:function(n){var i=t.Deferred(),a=this,r={};return arguments.length>1?(r={},e.each(arguments,function(t){if(t)try{r[t]=a._getPlugin(t)}catch(n){throw console.error("Error loading: "+t),e.each(r,function(e,t){a.returnPlugin(t),delete r[t]}),n}})):n&&(r=this._getPlugin(n)),setTimeout(function(){i.done(function(t){e.isArray(n)?e.each(n,function(e){a.returnPlugin(e)}):a.returnPlugin(n)})},1),i.resolve(r),i.promise()},getPluginRefCount:function(e){return this.getWidgetRefCount(e,"plugin:")},_getPlugin:function(e){return this._getThing("plugin",e)},returnPlugin:function(e){var t=this.__barbarianInstances["plugin:"+e];return t?(t.counter--,this._killBarbarian("plugin:"+e),t.counter):-1},getPluginOrWidgetName:function(t){if(!e.isString(t))throw Error("The psk argument must be a string");if(this.__barbarianRegistry[t])return this.__barbarianRegistry[t]},getPluginOrWidgetByPubSubKey:function(e){var t=this.getPluginOrWidgetName(e);if(void 0!==t){if(this._isBarbarianAlive(t))return this._getBarbarian(t);throw new Error("Eeeek, thisis unexpectEED bEhAvjor! Cant find barbarian with ID: "+e)}},getPskOfPluginOrWidget:function(e){e.split(":");if(this._isBarbarianAlive(e)){var t=this._getBarbarian(e);if(t.getPubSub&&t.getPubSub().getCurrentPubSubKey)return t.getPubSub().getCurrentPubSubKey().getId()}},_getOrCreateBarbarian:function(t,n){var i=t+":"+n;if("plugin"==t&&!this.hasPlugin(n)||"widget"==t&&!this.hasWidget(n))throw new Error("We cannot give you "+i+" (cause there is no constructor for it)");if(this._isBarbarianAlive(i))return this._getBarbarian(i);var a,r=new("plugin"==t?this.__plugins.get(n):this.__widgets.get(n)),s=this.getBeeHive().getHardenedInstance(),o=this.getService("PubSub");e.keys(o._issuedKeys);"activate"in r&&(this.debug&&console.log("application: "+i+".activate(beehive)"),a=r.activate(s));var l=e.without(e.keys(o._issuedKeys),e.keys(o._issuedKeys));return this._registerBarbarian(i,r,a,s,l),r},_lazyLoadIfNecessary:function(e,n){var i,a=t.Deferred(),r=this;if("plugin"==e)i=r.__plugins;else{if("widget"!=e)throw new Error(e+" cannot be lazy loaded, sorry");i=r.__widgets}var s=i.get(n);return null==s?a.reject(n+" does not exist"):s&&s.lazyLoad?s().done(function(e,t){r._registerLoadedModules(e,t),a.resolve()}):a.resolve(),a.promise()},_isBarbarianAlive:function(e){return!!this.__barbarianInstances[e]},_getBarbarian:function(e){return this.__barbarianInstances[e].parent},_registerBarbarian:function(t,n,i,a,r){this._killBarbarian(t),"getBeeHive"in n?this.__barbarianRegistry[n.getBeeHive().getService("PubSub").getCurrentPubSubKey().getId()]=t:this.__barbarianRegistry[a.getService("PubSub").getCurrentPubSubKey().getId()]=t;var s=[];i&&(s=this._registerBarbarianChildren(t,i)),r&&e.each(r,function(e){this.__barbarianRegistry[e]&&delete r[e]},this),this.__barbarianInstances[t]={parent:n,children:s,beehive:a,counter:0,psk:a.getService("PubSub").getCurrentPubSubKey(),bastards:r}},_registerBarbarianChildren:function(t,n){var i=[];return e.each(n,function(e,n){var a=t+"-"+(e.name||n);if(this.debug&&console.log("adding child object to registry: "+a),this._isBarbarianAlive(a))throw new Error("Contract breach, there already exists instance with a name: "+a);if("getBeeHive"in e){var r=e.getBeeHive().getService("PubSub").getCurrentPubSubKey().getId();if(this.__barbarianRegistry[r])throw new Error("Contract breach, the child of "+t+"is using the same pub-sub-key");this.__barbarianRegistry[r]=a}i.unshift(a)},this),i},_killBarbarian:function(t,n){var i=this.__barbarianInstances[t];if(i&&!(i.counter>0&&!0!==n)){i.children&&e.each(i.children,function(e){this._killBarbarian(e,!0)},this),e.each(this.__barbarianRegistry,function(e,n){e==t&&delete this.__barbarianRegistry[n]},this);var a=this.getService("PubSub");i.psk&&a.unsubscribe(i.psk),i.bastards,i.parent.destroy(),delete this.__barbarianInstances[t],"setBeeHive"in i.parent&&i.parent.setBeeHive({fake:"one"}),i=null,this.debug&&console.log("Destroyed: "+t)}},getAllControllers:function(){return e.pairs(this.__controllers.container)},getAllModules:function(){return e.pairs(this.__modules.container)},getAllPlugins:function(n){n=n||"plugin:";var i=t.Deferred(),a=[];return e.each(this.__barbarianInstances,function(e,t){t.indexOf(n)>-1&&a.unshift(t.replace(n,""))}),(n.indexOf("plugin:")>-1?this.getPlugin:this.getWidget).apply(this,a).done(function(t){var n=[];a.length>1?n=e.pairs(t):1==a.length&&(n=[[a[0],t]]),i.resolve(n)}),i.promise()},getAllWidgets:function(){return this.getAllPlugins("widget:")},getAllServices:function(){return this.getBeeHive().getAllServices()},getAllObjects:function(){return this.getBeeHive().getAllObjects()},triggerMethodOnAll:function(e,t){this.triggerMethod(this.getAllControllers(),"controllers",e,t),this.triggerMethod(this.getAllModules(),"modules",e,t);var n=this;this.getAllPlugins().done(function(i){i.length&&n.triggerMethod(i,"plugins",e,t)}),this.getAllWidgets().done(function(i){i.length&&n.triggerMethod(i,"widgets",e,t)}),this.triggerMethod(this.getBeeHive().getAllServices(),"BeeHive:services",e,t),this.triggerMethod(this.getBeeHive().getAllObjects(),"BeeHive:objects",e,t)},triggerMethod:function(t,n,i,a){var r=this;return e.map(t,function(t){var s=t[1];i in s?(r.debug&&console.log("application.triggerMethod: "+n+": "+t[0]+"."+i+"()"),s[i].call(s,a)):e.isFunction(i)&&(r.debug&&console.log("application.triggerMethod: "+n+": "+t[0]+" customCallback()"),i.call(s,n+":"+t[0],a))})}}),s.extend=n.Model.extend,s.extend(r)}),define("js/components/csrf_manager",["backbone","js/components/generic_module","js/mixins/hardened","js/components/api_request","js/components/api_targets","js/mixins/dependon"],function(e,t,n,i,a,r){var s=t.extend({activate:function(e){this.setBeeHive(e);var t=this.getPubSub();_.bindAll(this,["resolvePromiseWithNewKey"]),t.subscribe(t.DELIVERING_RESPONSE,this.resolvePromiseWithNewKey)},getCSRF:function(){this.deferred=$.Deferred();var e=new i({target:a.CSRF}),t=this.getPubSub();return t.publish(t.EXECUTE_REQUEST,e),this.deferred.promise()},resolvePromiseWithNewKey:function(e){var t=e.toJSON().csrf;this.deferred.resolve(t)},hardenedInterface:{getCSRF:"getCSRF"}});return _.extend(s.prototype,n,r.BeeHive),s}),define("js/components/doc_stash_controller",["backbone","js/components/generic_module","js/mixins/hardened","js/mixins/dependon"],function(e,t,n,i){var a=t.extend({_docs:[],activate:function(e){this.setBeeHive(e.getHardenedInstance());var t=this.getBeeHive().getService("PubSub");t.subscribe(t.START_SEARCH,_.bind(this.emptyStash,this))},stashDocs:function(e){this._docs.push.apply(this._docs,e)},getDocs:function(){return _.cloneDeep(this._docs)},emptyStash:function(){this._docs=[]},hardenedInterface:{stashDocs:"stash docs",getDocs:"getDocs"}});return _.extend(a.prototype,n,i.BeeHive),a}),define("js/components/feedback_mediator",["underscore","jquery","cache","js/components/generic_module","js/components/api_request","js/components/api_response","js/components/api_query_updater","js/components/api_feedback","js/components/pubsub_key","js/mixins/dependon"],function(e,t,n,i,a,r,s,o,l,c){var u=i.extend({initialize:function(e){this._cache=this._getNewCache(e.cache),this.debug=e.debug||!1,this._handlers={},this.app=null},_getNewCache:function(t){return new n(e.extend({maximumSize:150,expiresAfterWrite:1800},e.isObject(t)?t:{}))},activate:function(t,n){if(!n)throw new Error("This controller absolutely needs access to the app");this.setBeeHive(t),this.setApp(n);var i=this.getPubSub();i.subscribe(i.FEEDBACK,e.bind(this.receiveFeedback,this))},receiveFeedback:function(e,t){this.debug&&console.log("[EM]: received feedback:",e.toJSON(),t?t.getId():null);var n=this._getCacheKey(e,t),i=this._retrieveCacheEntry(n);i||(i=this.createNewCacheEntry(n),this._cache.put(n,i));var a=this.getFeedbackHandler(e,i);if(a){if(a.execute&&a.execute(e,i))return;if(a.call(this,e,i))return}this.handleFeedback(e,i)},removeFeedbackHandler:function(e){e.toString()in this._handlers&&delete this._handlers[e.toString()]},addFeedbackHandler:function(t,n){if(!t&&!e.isNumber(t))throw new Error("first argument must be code or code:string or string");if(!e.isFunction(n))throw new Error("second argument must be executable");this._handlers[t.toString()]=n},getFeedbackHandler:function(e,t){for(var n=[e.code+":"+t.id,t.id,e.code?e.code.toString():Date.now()],i=0;i<n.length;i++)if(n[i]in this._handlers)return this._handlers[n[i]]},_retrieveCacheEntry:function(e){return this._cache.getSync(e)},_getCacheKey:function(t,n){if(!t)throw new Error("ApiFeedback cannot be empty");if(t.getSenderKey())return t.getSenderKey();if(n){if(n instanceof l)return n.getId();if(e.isString(n))return n}var i=t.getApiRequest();if(i)return i.url();throw new Error("We cannot identify the origin (recipient) of this feedback")},createNewCacheEntry:function(e){return{waiting:0,max:0,errors:0,counter:0,created:Date.now(),id:e}},handleFeedback:function(e,t){var n=o.CODES;switch(t.counter+=1,e.code){case n.ALL_FINE:t.errors=0;break;case n.KEEP_WAITING:t.waiting+=t.started;break;case n.SERVER_ERROR:break;case n.ALERT:this.getApp().getController("AlertsController").onAlert(e,t)}}});return e.extend(u.prototype,c.BeeHive,c.App),u}),define("js/components/history_manager",["js/components/generic_module","js/mixins/dependon","js/mixins/hardened","js/components/pubsub_key"],function(e,t,n,i){var a=e.extend({initialize:function(){this._history=[]},activate:function(e){this.setBeeHive(e);var t=this.getPubSub();t.subscribe(t.NAVIGATE,_.bind(this.recordNav,this))},recordNav:function(){this._history.push([].slice.apply(arguments))},getCurrentNav:function(){return this._history[this._history.length-1]},getPreviousNav:function(){return this._history[this._history.length-2]},hardenedInterface:{getPreviousNav:"",getCurrentNav:""}});return _.extend(a.prototype,t.BeeHive,n),a}),define("js/components/library_controller",["backbone","js/components/generic_module","js/mixins/hardened","js/components/api_targets","js/components/api_request","js/components/api_feedback","js/components/api_query","js/mixins/dependon"],function(e,t,n,i,a,r,s,o){var l=e.Model.extend({defaults:function(){return{num_documents:0,date_last_modified:void 0,permission:void 0,description:"",public:!1,num_users:1,owner:void 0,date_created:void 0,id:void 0,title:""}}}),c=e.Collection.extend({model:l}),u=t.extend({initialize:function(){this.collection=new c},activate:function(t){var n=this;this.setBeeHive(t.getHardenedInstance());var i=this.getBeeHive().getService("PubSub");i.subscribe(i.INVITING_REQUEST,_.bind(this.updateCurrentQuery,this)),i.subscribe(i.USER_ANNOUNCEMENT,_.bind(this.handleUserAnnouncement,this)),i.subscribe(i.CUSTOM_EVENT,function(e){"invalidate-library-metadata"===e&&(n._metadataLoaded=!1)}),_.each(["change","add","reset","remove"],function(t){this.listenTo(this.collection,t,function(n,a){"change"==t&&n instanceof e.Model?(i.publish(i.LIBRARY_CHANGE,this.collection.toJSON(),{ev:t,id:n.id}),delete this._libraryBibcodeCache[n.id]):i.publish(i.LIBRARY_CHANGE,this.collection.toJSON(),{ev:t})})},this)},handleUserAnnouncement:function(e){"user_signed_in"==e?this._fetchAllMetadata():"user_signed_out"==e&&this.collection.reset({})},updateCurrentQuery:function(e){this._currentQuery=e},composeRequest:function(e,t,n){var i,r=(n=n||{}).data||void 0,s=$.Deferred();return i=new a({target:e,options:{context:this,type:t,data:JSON.stringify(r),contentType:"application/json",done:function(){var e=[_.extend(arguments[0],n.extraArguments),[].slice(arguments,1)];s.resolve.apply(void 0,e)},fail:function(e){var t=this.getPubSub();t.publish(t.CUSTOM_EVENT,"libraries:request:fail",e),s.reject.apply(void 0,arguments)}}}),this.getBeeHive().getService("Api").request(i),s.promise()},_executeApiRequest:function(e){var t=new a({target:i.SEARCH,query:e}),n=$.Deferred(),r=this.getPubSub();return r.subscribeOnce(r.DELIVERING_RESPONSE,_.bind(function(e){n.resolve(e)}),this),r.publish(r.EXECUTE_REQUEST,t),n.promise()},_getBibcodes:function(e){var t=$.Deferred(),n=this;if("all"==e.bibcodes){var i=e.limit||2e3,a=0,r=100,s=[],o=this._currentQuery.clone();o.unlock(),o.set("rows",100),o.set("fl","bibcode"),function e(){o.set("start",a),this._executeApiRequest(o).done(function(o){var l=_.map(o.get("response.docs"),function(e){return e.bibcode});[].push.apply(s,l),(a+=r)<i?e.call(n):t.resolve(s)})}.call(this)}else if("selected"==e.bibcodes){var l=this.getBeeHive().getObject("AppStorage").getSelectedPapers();t.resolve(l)}else{if(!_.isArray(e.bibcodes))throw new Error("should we add all bibcodes or only selected ones?");t.resolve(e.bibcodes)}return t.promise()},_fetchAllMetadata:function(){var e=this,t=i.LIBRARIES;return this.composeRequest(t,"GET").done(function(t){e._metadataLoaded=!0,e.collection.reset(t.libraries)})},getLibraryMetadata:function(e){if(e&&!this.collection.get(e))return this.fetchLibraryMetadata(e);var t=$.Deferred(),n=this;if(this._metadataLoaded){var i=e?n.collection.get(e).toJSON():n.collection.toJSON();t.resolve(i)}else this._fetchAllMetadata().done(function(i){setTimeout(function(){var i=e?n.collection.get(e).toJSON():n.collection.toJSON();t.resolve(i)},1)});return t.promise()},fetchLibraryMetadata:function(e){var t=this;if(!e)throw new Error("need to provide a library id");var n=$.Deferred();return this.composeRequest(i.LIBRARIES+"/"+e).done(function(e){n.resolve(e.metadata),t.collection.add(e.metadata,{merge:!0})}).fail(function(){t.getPubSub().publish(t.getPubSub().NAVIGATE,"404")}),n.promise()},_libraryBibcodeCache:{},getLibraryBibcodes:function(e){var t=$.Deferred(),n=this,r=1e4;if(this._libraryBibcodeCache[e])return t.resolve(this._libraryBibcodeCache[e]),t.promise();var o=r,l=0,c=100,u=[],h=i.LIBRARIES+"/"+e;n=this;function d(i){o=i.solr.response.numFound>r?r:i.solr.response.numFound;var a=_.pluck(i.solr.response.docs,"bibcode");[].push.apply(u,a),(l+=c)<o?p():(n._libraryBibcodeCache[e]=u,t.resolve(u))}function p(){var e=new s;e.set("rows",100),e.set("fl","bibcode"),e.set("start",l);var t=new a({target:h,query:e,options:{context:this,contentType:"application/x-www-form-urlencoded",done:d,fail:this.handleError}});n.getBeeHive().getService("Api").request(t)}return p.call(this),t.promise()},createLibrary:function(e){var t=this,n=i.LIBRARIES;return this.composeRequest(n,"POST",{data:e}).done(function(){t._fetchAllMetadata()})},deleteLibrary:function(e,t){var n=this,a=i.DOCUMENTS+"/"+e;return this.composeRequest(a,"DELETE").done(function(){n.collection.remove(e),n.getBeeHive().getService("PubSub").publish(n.getBeeHive().getService("PubSub").NAVIGATE,"AllLibrariesWidget","libraries");var i="Library <b>"+t+"</b> was successfully deleted";n.getBeeHive().getService("PubSub").publish(n.getBeeHive().getService("PubSub").ALERT,new r({code:0,msg:i,type:"success"}))}).fail(function(e){var i=JSON.parse(e.responseText).error,a="Library <b>"+t+"</b> could not be deleted : ("+i+")";n.getBeeHive().getService("PubSub").publish(n.getBeeHive().getService("PubSub").ALERT,new r({code:0,msg:a,type:"danger"}))})},updateLibraryContents:function(e,t){var n=this,a={data:t,extraArguments:{numBibcodesRequested:t.bibcode.length}},s=i.DOCUMENTS+"/"+e;return this.composeRequest(s,"POST",a).done(function(){n.fetchLibraryMetadata(e)}).fail(function(t){var i=JSON.parse(t.responseText).error,a="Library <b>"+n.collection.get(e).title+"</b> could not be updated: ("+i+")";n.getBeeHive().getService("PubSub").publish(n.getBeeHive().getService("PubSub").ALERT,new r({code:0,msg:a,type:"danger"}))})},performLibraryOperation:function(e,t){if(!t)throw new Error("must provide options object with action and set of secondary libraries (if necessary)");var n={},a=t.action&&t.action.toLowerCase(),r=t.libraries,s=t.name,o=/^(union|intersection|difference)$/.test(a),l=/^copy$/.test(a),c=/^empty$/.test(a);if(!_.isString(a)||!o&&!l&&!c)throw new Error(a+" is not one of the defined actions");if(!_.isString(e))throw new Error("must pass library ID as first parameter");if(o&&!_.isArray(r))throw new Error("libraries must be an array");if(l&&(!_.isArray(r)||1!==r.length))throw new Error("for copy action, libraries must have exactly 1 entry");r=_.unique(r),_.extend(n,{action:a}),o?_.extend(n,{libraries:r,name:s}):l&&_.extend(n,{libraries:r});var u=i.LIBRARIES+"/operations/"+e;return this.composeRequest(u,"POST",{data:n})},transferOwnership:function(e,t){if(!t||!_.isString(t))throw"new owner email address must be a string";if(!e||!_.isString(e))throw"library Id must be a string";var n=i.LIBRARY_TRANSFER+"/"+e,a={email:t};return this.composeRequest(n,"POST",{data:a})},updateLibraryMetadata:function(e,t){var n=this,a=i.DOCUMENTS+"/"+e;return this.composeRequest(a,"PUT",{data:t}).done(function(t){n.collection.get(e).set(t)}).fail(function(t){var i=JSON.parse(t.responseText).error,a="Library <b>"+n.collection.get(e).get("name")+"</b> could not be updated: ("+i+")";n.getBeeHive().getService("PubSub").publish(n.getBeeHive().getService("PubSub").ALERT,new r({code:0,msg:a,type:"danger"}))})},addBibcodesToLib:function(e){var t=this;return this._getBibcodes(e).then(function(n){return t.updateLibraryContents(e.library,{bibcode:n,action:"add"}).fail(function(){var n="Library <b>"+t.collection.get(e.library).title+"</b> could not be updated";t.getBeeHive().getService("PubSub").publish(t.getBeeHive().getService("PubSub").ALERT,new r({code:0,msg:n,type:"danger"}))})})},createLibAndAddBibcodes:function(e){var t=this;return this._getBibcodes(e).then(function(n){if(!n)throw new Error("Solr returned no bibcodes, can't put them in the new library");return e.bibcode=n,t.createLibrary(e).fail(function(){var e="Library <b>"+name+"</b> could not be created";t.getBeeHive().getService("PubSub").publish(t.getBeeHive().getService("PubSub").ALERT,new r({code:0,msg:e,type:"danger"}))})})},importLibraries:function(e){var t,n=$.Deferred(),r=this;if("classic"===e)t=i.LIBRARY_IMPORT_CLASSIC_TO_BBB;else{if("twopointoh"!==e)return void console.error("didn't recognize library endpoint! should be one of 'classic' or 'twopointoh' ");t=i.LIBRARY_IMPORT_ADS2_TO_BBB}return this.getBeeHive().getService("Api").request(new a({target:t,options:{done:function(e){n.resolve.apply(void 0,[].slice.apply(arguments)),r._fetchAllMetadata()},fail:function(e){n.reject.apply(void 0,[].slice.apply(arguments))}}})),n.promise()},hardenedInterface:{getLibraryMetadata:"returns json list of libraries, optional lib id as param",createLibrary:"createLibrary",createLibAndAddBibcodes:"createLibAndAddBibcodes",addBibcodesToLib:"addBibcodesToLib",deleteLibrary:"deleteLibrary",updateLibraryContents:"updateLibraryContents",updateLibraryMetadata:"updateLibraryMetadata",importLibraries:"importLibraries",transferOwnership:"transferOwnership",getLibraryBibcodes:"getLibraryBibcodes",performLibraryOperation:"performLibraryOperation"}});return _.extend(u.prototype,n,o.BeeHive),u}),define("js/components/persistent_storage",["underscore","js/components/generic_module","js/mixins/dependon","persist-js","module"],function(e,t,n,i,a){var r=a.config().namespace||"",s=t.extend({constructor:function(e){e=e||{},this._store=this.createStore(r+(e.name||""))},createStore:function(e){return this._createStore(e)},_createStore:function(t){var n=new i.Store(t,{about:"This is bumblebee persistent storage",defer:!0}),a=n.get("#keys");if(a)try{a=JSON.parse(a),e.isObject(a)||n.set("#keys","{}")}catch(e){n.set("#keys","{}")}else n.set("#keys","{}");return n},set:function(t,n){this._checkKey(t),e.isString(n)||(n=JSON.stringify(n)),this._store.set(t,n),this._setKey(t)},get:function(e){this._checkKey(e);var t=this._store.get(e);if(!t)return t;try{return JSON.parse(t)}catch(e){return t}},remove:function(e){this._checkKey(e),this._store.remove(e),this._delKey(e)},clear:function(){var e=this.get("#keys");for(var t in e)this._store.remove(t);this._store.set("#keys","{}")},keys:function(){return JSON.parse(this._store.get("#keys"))},_setKey:function(e){var t=this.keys()||{};t[e]=1,this._store.set("#keys",JSON.stringify(t))},_delKey:function(e){var t=this.keys()||{};delete t[e],this._store.set("#keys",JSON.stringify(t))},_checkKey:function(t){if(!e.isString(t))throw new Error("key must be string, received: "+t)}});return e.extend(s.prototype,n.BeeHive),s}),define("js/mixins/add_secondary_sort",[],function(){return{addSecondarySort:function(e){e.has("sort")||e.set("sort","date desc");var t=e.get("sort")[0].split(",")[0],n=t.indexOf(" asc")>-1?"bibcode asc":"bibcode desc";e.set("sort",t+", "+n)}}}),define("utils",["jquery","underscore","analytics"],function(e,t,n){return{qs:function(e,n,i){var a=e.replace(/[*+?^$.\[\]{}()|\\\/]/g,"\\$&"),r="(^|[\\?&])"+a+"=[^&]*",s=(n||location.hash).match(new RegExp(r,"g"));if(!s)return null;for(var o=[],l=0;l<s.length;l++)o.push(s[l].replace(new RegExp("(^|[\\?&])"+a+"="),""));if(i){var c=o.join(i);return decodeURIComponent(c.replace(/\+/g," "))}return!1===i?t.map(o,function(e){return decodeURIComponent(e.replace(/\+/g," "))}):void 0},updateHash:function(e,n,i){var a=e.replace(/[*+?^$.\[\]{}()|\\\/]/g,"\\$&"),r=t.isString(i)?i:location.hash,s=r.match(new RegExp("&?"+a+"=([^&]+)(&|$)"));if(s){var o=s[0].replace(s[1],n);return r.replace(s[0],o)}return i},difference:function e(n,i){return t.transform(n,function(n,a,r){t.isEqual(a,i[r])||(n[r]=t.isObject(a)&&t.isObject(i[r])?e(a,i[r]):a)})},getBrowserInfo:function(){var t=e.Deferred(),n=setTimeout(function(){t.reject()},3e3);return require(["bowser"],function(e){window.clearTimeout(n),t.resolve(e.parse(window.navigator.userAgent))},function(){t.reject()}),t.promise()},TimingEvent:function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Timers",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Generic Timer",i=arguments.length>2?arguments[2]:void 0;_classCallCheck(this,e),this.timingCategory=n,this.timingVar=t,this.timingLabel=i,this.time=null}return _createClass(e,[{key:"start",value:function(){this.time=+new Date,this._emitted=!1}},{key:"stop",value:function(){if(!this._emitted){var e=+new Date-this.time;n("send",{hitType:"timing",timingCategory:this.timingCategory,timingVar:this.timingVar,timingLabel:this.timingLabel,timingValue:e}),this._emitted=!0}}}]),e}(),waitForSelector:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=e.Deferred(),r=null;return function t(i){var s=e.apply(void 0,n);return s.length?a.resolve(s):i>=3100?a.reject("timeout"):void(r=setTimeout(function(){window.requestAnimationFrame(function(){return t(++i)})},100))}(0),a.promise.destroy=function(){window.clearTimeout(r),a.reject()},a.promise()},withPrerenderedContent:function(t){return t.handlePrerenderedContent=function(n,i){t.$el=e(t.tagName+"."+t.className,i),t.el=t.$el.get(0),t.delegateEvents(),t.model.once("change",function(){return t.getTemplate=function(){return t.getOption("template")}}),t.getTemplate=function(){return n}},t},escapeRegExp:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}}),define("js/components/query_mediator",["underscore","jquery","cache","js/components/generic_module","js/mixins/dependon","js/mixins/add_secondary_sort","js/components/api_request","js/components/api_response","js/components/api_query_updater","js/components/api_feedback","js/components/json_response","js/components/api_targets","js/components/api_query","js/components/alerts","utils","analytics"],function(e,t,n,i,a,r,s,o,l,c,u,h,d,p,f,g){var b=i.extend({initialize:function(t){t=t||{},this._cache=null,this.debug=t.debug||!1,this.queryUpdater=new l("QueryMediator"),this.failedRequestsCache=this._getNewCache({expiresAfterWrite:5}),this.maxRetries=t.maxRetries||3,this.recoveryDelayInMs=e.isNumber(t.recoveryDelayInMs)?t.recoveryDelayInMs:700,this.__searchCycle={waiting:{},inprogress:{},done:{},failed:{}},this.shortDelayInMs=e.isNumber(t.shortDelayInMs)?t.shortDelayInMs:300,this.longDelayInMs=e.isNumber(t.longDelayInMs)?t.longDelayInMs:100,this.monitoringDelayInMs=e.isNumber(t.monitoringDelayInMs)?t.monitoringDelayInMs:200,this.mostRecentQuery=new d},activateCache:function(e){this._cache=this._getNewCache((e||{}).cache)},_getNewCache:function(t){return new n(e.extend({maximumSize:100,expiresAfterWrite:1800},e.isObject(t)?t:{}))},activate:function(t,n){this.setBeeHive(t),this.setApp(n);var i=this.getPubSub();i.subscribe(i.START_SEARCH,e.bind(this.getQueryAndStartSearchCycle,this)),i.subscribe(i.DELIVERING_REQUEST,e.bind(this.receiveRequests,this)),i.subscribe(i.EXECUTE_REQUEST,e.bind(this.executeRequest,this)),i.subscribe(i.GET_QTREE,e.bind(this.getQTree,this))},getQTree:function(e,t){var n=new s({query:e,target:h.QTREE});this._executeRequest(n,t)},doQueryTranslation:function(e){var n=t.Deferred(),i=this.getPubSub(),a=new s({target:h.SERVICE_OBJECTS_QUERY,query:new d({query:e}),options:{type:"POST",contentType:"application/json"}});return i.subscribeOnce(i.DELIVERING_RESPONSE,function(e){n.resolve(e.toJSON())}),i.publish(i.EXECUTE_REQUEST,a),n.promise()},getQueryAndStartSearchCycle:function(e,t){var n=this,i=this.getPubSub();if(r.addSecondarySort(e),this.original_url&&e.get("q")&&-1!==e.get("q")[0].indexOf("simbid")){var a=e.clone(),o=e.get("q")[0];e.has("__original_query")&&(o=e.get("__original_query")[0]),a.set("q",o),this.original_url=this.queryUpdater.clean(a).url()}else this.original_url=this.queryUpdater.clean(e).url();if(this.original_query=e.get("q"),e.get("__bigquery")){e.set("bigquery","bibcode\n"+e.get("__bigquery").join("\n")),e.unset("__bigquery"),e.get("q")||e.set("q","*:*"),e.add("fq","{!bitset}");var l=new s({target:h.MYADS_STORAGE+"/query",query:e,options:{type:"POST",contentType:"application/json",done:function(i){var a=new d({q:e.get("q"),__qid:i.qid}),r=e.get("__bigquerySource");r&&a.set("__bigquerySource",r[0]),e.get("sort")&&a.set("sort",e.get("sort")),n.startSearchCycle(a,t)},fail:function(e,t,n){console.warn("bigquery failed:",[].slice.apply(arguments).join(",")),i.publish(i.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_FAILED_TO_START,error:{jqXHR:e,textStatus:t,errorThrown:n}}))}}});this.getBeeHive().getService("Api").request(l)}else if(e.get("q")[0].indexOf("object:")>-1){var u=function(n){e.set({q:n.query}),this.startSearchCycle(e,t)}.bind(this);this.doQueryTranslation(e.get("q")[0]).done(u)}else this.startSearchCycle.apply(this,arguments)},startSearchCycle:function(t,n){if(this.resetFailures(),this.getBeeHive().getObject("AppStorage")&&this.getBeeHive().getObject("AppStorage").clearSelectedPapers(),t.has("__saveBigQuery")&&this.mostRecentQuery.has("__qid")&&!t.has("__qid")&&(this.mostRecentQuery.set("q",t.get("q")),t=this.mostRecentQuery),this.mostRecentQuery=t,this.debug&&console.log("[QM]: received query:",this.hasApp()&&this.getApp().getPluginOrWidgetName(n.getId())||n.getId(),t.url()),t.keys().length<=0)console.error("[QM] : received empty query (huh?!)");else{t.get("q")[0].indexOf("simbid")>-1&&(t.add("__original_url",this.original_url),t.add("__original_query",this.original_query));var i=this.getPubSub();this.__searchCycle.running&&this.__searchCycle.waiting&&e.keys(this.__searchCycle.waiting)&&(console.error("The previous search cycle did not finish, and there already comes the next!"),e.forEach(e.extend({},this.__searchCycle.waiting,this.__searchCycle.inprogress),function(e){e.request.__STALE=!0})),this.reset(),this.__searchCycle.initiator=n.getId(),this.__searchCycle.collectingRequests=!0,this.__searchCycle.query=t.clone();var a=t.clone();a.unset("fl"),a.lock(),i.publish(i.INVITING_REQUEST,a);var r=this,s=function(){r.__searchCycle.collectingRequests=!1,r.startExecutingQueries()&&r.monitorExecution()};this.shortDelayInMs?setTimeout(s,this.shortDelayInMs):s()}},startExecutingQueries:function(t){var n=this,i=this.__searchCycle;if(!i.running&&!e.isEmpty(i.waiting)&&this.hasBeeHive()){var a;i.running=!0;var r=this.getBeeHive().getService("Api"),s=this.getPubSub();if(s&&r){var o,l;if((o=this.getApp().getPskOfPluginOrWidget("widget:Results"))&&i.waiting[o]&&(a=i.waiting[o],delete i.waiting[o]),!a&&i.waiting[i.initiator]&&(a=i.waiting[i.initiator],delete i.waiting[i.initiator]),!a)this.debug&&console.warn("DynamicConfig does not tell us which request to execute first (grabbing random one)."),a=i.waiting[l=e.keys(i.waiting)[0]],delete i.waiting[l];var u=a.key.getId();return i.inprogress[u]=a,this._executeRequest(a.request,a.key).done(function(t){if(!a.request.__STALE){var r;i.done[u]=a,delete i.inprogress[u],t.response&&t.response.numFound&&(r=t.response.numFound),s.publish(s.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_STARTED,query:i.query,request:a.request,numFound:r,cycle:i,response:t})),n.displayTugboatMessages();var o=function(){e.each(e.keys(i.waiting),function(t){a=i.waiting[t],delete i.waiting[t],i.inprogress[t]=a;var r=t;n._executeRequest.call(n,a.request,a.key).done(function(){a.request.__STALE||(i.done[r]=i.inprogress[r],delete i.inprogress[r])}).fail(function(){a.request.__STALE||(i.failed[r]=i.inprogress[r],delete i.inprogress[r])}).always(function(){i.finished||e.isEmpty(i.inprogress)&&(s.publish(s.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_FINISHED,cycle:i})),i.finished=!0)})})};n.longDelayInMs&&n.longDelayInMs>0?setTimeout(function(){o()},n.longDelayInMs):o()}}).fail(function(e,t,a){n.__searchCycle.error=!0,s.publish(s.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_FAILED_TO_START,cycle:i,request:this.request,error:{jqXHR:e,textStatus:t,errorThrown:a}}))}),!0}}},monitorExecution:function(){if(this.hasBeeHive()){var t=this,n=this.getPubSub();if(n){if(this.__searchCycle.monitor+=1,this.__searchCycle.monitor>100)return console.warn("Stopping monitoring of queries, it is running too long"),void n.publish(n.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_STOP_MONITORING,cycle:this.__searchCycle}));if(this.__searchCycle.inprogress&&e.isEmpty(this.__searchCycle.inprogress)){if(this.__searchCycle.finished)return;n.publish(n.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_FINISHED,cycle:this.__searchCycle}))}else{var i=e.keys(this.__searchCycle.waiting).length,a=i+e.keys(this.__searchCycle.done).length+e.keys(this.__searchCycle.inprogress).length+e.keys(this.__searchCycle.failed).length;n.publish(n.FEEDBACK,new c({code:c.CODES.SEARCH_CYCLE_PROGRESS,msg:i/a,total:a,todo:i,cycle:this.__searchCycle})),setTimeout(function(){t.monitorExecution()},t.monitoringDelayInMs)}}}},receiveRequests:function(e,t){this.debug&&console.log("[QM]: received request:",this.hasApp()&&this.getApp().getPluginOrWidgetName(t.getId())||t.getId(),e.url()),this.__searchCycle.collectingRequests?this.__searchCycle.waiting[t.getId()]={request:e,key:t}:this.executeRequest(e,t)},executeRequest:function(e,t){if(!(e instanceof s))throw new Error("Sir, I belive you forgot to send me a valid ApiRequest!");if(!t)throw new Error("Request executed, but no widget id provided!");return this._executeRequest(e,t)},getFailCacheValue:function(e){var t=this.failedRequestsCache;return t&&t.getSync(e)||t._cache[e]&&t._cache[e].value},_executeRequest:function(e,n){if(e.get("query")&&e.get("query").get("__qid")){var i=e.get("query").get("__qid")[0];e.set("target",h.MYADS_STORAGE+"/execute_query/"+i)}var a=this.getPubSub(),r=this.getBeeHive().getService("Api"),s=this._getCacheKey(e);if((this.getFailCacheValue(s)||0)>=this.maxRetries)return this.onApiRequestFailure.apply({request:e,key:n,requestKey:s,qm:this},[{status:c.CODES.TOO_MANY_FAILURES},"Error","This request has reached maximum number of failures (wait before retrying)"]),t.Deferred().reject();if(this._cache){var o=this._cache.getSync(s),l=this;if(o&&o.promise)return o.done(function(){l._cache.put(s,arguments),l.onApiResponse.apply({request:e,key:n,requestKey:s,qm:l},arguments)}),o.fail(function(){l._cache.invalidate(s),l.onApiRequestFailure.apply({request:e,pubsub:a,key:n,requestKey:s,qm:l},arguments)}),o;if(o){var u=t.Deferred();return u.done(function(){l.onApiResponse.apply({request:e,key:n,requestKey:s,qm:l},o)}),u.resolve(),u.promise()}var d=r.request(e,{done:function(){l._cache.put(s,arguments),l.onApiResponse.apply(this,arguments)},fail:function(){l._cache.invalidate(s),l.onApiRequestFailure.apply(this,arguments)},context:{request:e,key:n,requestKey:s,qm:l}});return this._cache.put(s,d),d}return r.request(e,{done:this.onApiResponse,fail:this.onApiRequestFailure,context:{request:e,key:n,requestKey:s,qm:this}})},onApiResponse:function(e,t,n){var i=this.qm;if(!this.request.__STALE){var a=e.responseHeader&&e.responseHeader.params?new o(e):new u(e);a.setApiQuery(this.request.get("query")),i.debug&&console.log("[QM]: sending response:",i.hasApp()&&i.getApp().getPluginOrWidgetName(this.key.getId())||this.key.getId(),e);var r=i.getBeeHive().getService("PubSub");r&&r.publish(this.key,r.DELIVERING_RESPONSE+this.key.getId(),a),i.failedRequestsCache.getIfPresent(this.requestKey)&&i.failedRequestsCache.invalidate(this.requestKey)}},onApiRequestFailure:function(e,t,n){var i=this.qm;if(!this.request.__STALE){this.request.get("query");i.debug&&console.warn("[QM]: request failed",e,t,n);var a=i.getFailCacheValue(this.requestKey)||0;if(i.failedRequestsCache.put(this.requestKey,a+1),i.tryToRecover.apply(this,arguments))return console.warn("[QM]: attempting recovery"),!0;var r=new c({code:c.CODES.API_REQUEST_ERROR,msg:t,request:this.request,error:e,psk:this.key,errorThrown:n,text:t}),s=i.getBeeHive().getService("PubSub");return s&&s.publish(this.key,s.FEEDBACK,r),!1}},tryToRecover:function(e,t,n){var i=this.qm,a=this.key,r=this.request,s=this.requestKey,o=e.status;if(o)switch(o){case 408:case 409:case 500:case 502:case 503:case 504:return g("send","event","introspection","retrying",o),setTimeout(function(){if(i._cache){var e=i._cache.getSync(s);if(e&&e.promise)i._cache.invalidate(s);else if(e)return}i._executeRequest.call(i,r,a)},i.recoveryDelayInMs),!0;default:g("send","event","introspection","not-retrying",o,JSON.stringify(i.mostRecentQuery.toJSON()))}},_getCacheKey:function(e){var t=e.get("query"),n=this.queryUpdater.clean(t);e.set("query",n);var i=e.url();return e.set("query",t),i},reset:function(){this.__searchCycle={waiting:{},inprogress:{},done:{},failed:{}},this._cache&&this._cache.invalidateAll()},getAlerter:function(){return this.getApp().getController(this.alertsController||"AlertsController")},displayTugboatMessages:function(){var t={AUTHOR_ANDED_WARNING:"Author search terms combined with AND rather than OR",ENTRY_DATE_OFFSET_ERROR:"Can not combine a date and offset (negative value) for the Entry Date",ENTRY_DATE_NON_NUMERIC_ERROR:"Found a non numeric value in the Entry Date",UNRECOGNIZABLE_VALUE:"Invalid value for {} supplied"};if(this.original_url){var n,i=[].concat(f.qs("error_message",this.original_url,!1)||[],f.qs("warning_message",this.original_url,!1)||[]),a=f.qs("unprocessed_parameter",this.original_url,!1)||[];(i=e.reduce(i,function(n,i){if(i=i.toUpperCase(),e.has(t,i)){var r=t[i];if("UNRECOGNIZABLE_VALUE"===i&&a.length>0){var s=encodeURIComponent(a.pop());r=r.replace("{}",/^\w+$/.test(s)?s:"parameter")}n.push(r)}return n},[])).length>0&&(i.push('See our <a style="text-decoration: underline; font-weight: bold" href="http://adsabs.github.io/help/faq/#classic-search-translator">docs</a> for more information'),n=i.join("<br/>"),this.getAlerter().alert(new c({type:p.TYPE.INFO,msg:n})))}},resetFailures:function(){this.failedRequestsCache.invalidateAll()}});return e.extend(b.prototype,a.BeeHive,a.App),b}),define("js/components/query_validator",["underscore"],function(e){function t(e,t){var n=new RegExp(e,t);return function(e){return n.test(e)?null:e}}function n(e,t,n){this.field=e,this.value=t,this.token=n}return function(){var i=function(e){return null!==e};this.validate=function(a){var r={result:!0},s=[i,new t(/^""$/),new t(/^\(\)$/),new t(/^\(\^\)$/),new t(/^\(""\)$/),new t(/^\("\^"\)$/),new t(/^"\^"$/)];try{var o=a.get("q").join(" ").trim();if(!o.length)return r;var l=function(e){for(var t=new RegExp(/:/),i=e.split(/\s+\b/),a=[],r=0;r<i.length;r++){var s=i[r].split(t);2===s.length&&a.push(new n(s[0],s[1],i[r]))}return a}(o)}catch(e){return r}var c=function(t,n){var i=[];for(var a in n){var r=e.compose.apply(e,t)(n[a].value);r||i.push({token:n[a].token,result:r})}return i}(s,l);return r.result=e.every(e.pluck(c,"result")),c.length&&(r.tests=c),r}}}),define("js/components/recaptcha_manager",["backbone","js/components/generic_module","js/mixins/hardened","js/mixins/dependon"],function(e,t,n,i){var a=t.extend({initialize:function(){this.grecaptchaDeferred=window.__grecaptcha__,this.siteKeyDeferred=$.Deferred(),this.when=$.when(this.siteKeyDeferred,this.grecaptchaDeferred),this.execPromise=$.Deferred()},activate:function(e){this.setBeeHive(e);var t=this.getPubSub();_.bindAll(this,["getRecaptchaKey"]),t.subscribe(t.APP_STARTED,this.getRecaptchaKey)},getRecaptchaKey:function(){var e=this.getBeeHive().getObject("AppStorage").getConfigCopy().recaptchaKey;this.siteKeyDeferred.resolve(e)},activateRecaptcha:function(e){"resolved"!==this.when.state()&&this.renderLoading(e);var t=this;clearTimeout(this.to),this.to=setTimeout(function(){"resolved"!==t.when.state()&&t.renderError(e)},5e3),this.when.done(_.partial(_.bind(this.renderRecaptcha,this),e)).fail(function(){t.renderError(e)})},getEl:function(e){return e.$(".g-recaptcha")},execute:function(){return this.execPromise=$.Deferred(),grecaptcha.execute(),this.execPromise.promise()},renderLoading:function(e){this.getEl(e).html('<p><i class="fa fa-spinner fa-spin"></i></p>'),this.enableSubmit(e,!1)},enableSubmit:function(e,t){e.$("button[type=submit],input[type=submit]").attr("disabled",!t)},renderError:function(e){this.getEl(e).html('<p class="text-danger">Error loading ReCAPTCHA, please try again</p>'),this.enableSubmit(e,!1)},renderRecaptcha:function(e,t,n){var i=this,a=this.getEl(e),r=$('<div class="form-group"></div>').append('<small class="recaptcha-msg">This site is protected by reCAPTCHA and the Google Privacy Policy and Terms of Service apply.</small>');a.closest("form").append(r),grecaptcha.render(a[0],{sitekey:t,size:"invisible",badge:"inline",callback:function(t){e.model&&e.model.set("g-recaptcha-response",t),i.execPromise.resolve(t)}}),this.enableSubmit(e,!0)},hardenedInterface:{activateRecaptcha:"activateRecaptcha",execute:"execute"}});return _.extend(a.prototype,n,i.BeeHive),a}),define("js/components/user",["underscore","backbone","js/components/api_request","js/components/api_targets","js/components/generic_module","js/mixins/dependon","js/mixins/hardened","js/components/api_feedback","js/mixins/api_access"],function(e,t,n,i,a,r,s,o,l){var c,u,h;return c=t.Model.extend({defaults:function(){return{isOrcidModeOn:!1,perPage:void 0}}}),u=t.Model.extend({defaults:function(){return{user:void 0,link_server:void 0,minAuthorPerResult:4,externalLinkAction:"Open in new tab",defaultDatabase:[{name:"Physics",value:!1},{name:"Astronomy",value:!1},{name:"General",value:!1}],defaultExportFormat:"BibTeX",defaultHideSidebars:"Show",customFormats:[],recentQueries:[]}}}),h=a.extend({initialize:function(t){this.localStorageModel=new c,this.listenTo(this.localStorageModel,"change",this.broadcastUserDataChange),this.userModel=new u,this.listenTo(this.userModel,"change:user",this.broadcastUserChange),this.listenTo(this.userModel,"change",function(e){"user"!==e&&this.broadcastUserDataChange.apply(this,arguments)}),e.bindAll(this,"completeLogIn","completeLogOut"),this.base_url=this.test?"location.origin":location.origin,this.buildAdditionalParameters()},activate:function(e){this.setBeeHive(e);this.getPubSub().subscribe(this.getPubSub().APP_STARTING,function(){var t=e.getService("OrcidApi"),n=e.getObject("User");null!==t.authData&&t.checkAccessOrcidApiAccess().fail(function(e){var i=e&&e.status;i&&"401"===i&&(t.signOut(),n.setOrcidMode(0))})});var t=e.getService("PersistentStorage");if(t){var n=t.get("UserPreferences");n&&this.localStorageModel.set(n)}},_persistModel:function(){var e=this.getBeeHive().getService("PersistentStorage");e&&e.set("UserPreferences",this.localStorageModel.toJSON())},setLocalStorage:function(e){this.localStorageModel.set(e),this._persistModel()},getLocalStorage:function(e){return this.localStorageModel.toJSON()},addToRecentQueries:function(e){try{var t=this.userModel.get("recentQueries");t.length>=10&&t.pop(),t.unshift(e.clone().toJSON()),this.userModel.set("recentQueries",t),this.setUserData({recentQueries:t})}catch(e){t=[]}return t},getRecentQueries:function(){return this.userModel.get("recentQueries")||[]},setOrcidMode:function(e){this.localStorageModel.set("isOrcidModeOn",e),this._persistModel()},isOrcidModeOn:function(){return this.localStorageModel.get("isOrcidModeOn")},broadcastUserDataChange:function(e){this.getPubSub().publish(this.getPubSub().USER_ANNOUNCEMENT,this.USER_INFO_CHANGE,e.changed)},broadcastUserChange:function(){var e=this.userModel.get("user")?this.USER_SIGNED_IN:this.USER_SIGNED_OUT;this.getPubSub().publish(this.getPubSub().USER_ANNOUNCEMENT,e,this.userModel.get("user")),this.redirectIfNecessary()},buildAdditionalParameters:function(){var e={};e.CHANGE_EMAIL={verify_url:this.base_url+"/#user/account/verify/change-email"},this.additionalParameters=e},handleFailedPOST:function(e,t,n,i){var a;this.getPubSub();a=e.responseJSON&&e.responseJSON.error?e.responseJSON.error:e.responseText?e.responseText:"error unknown",console.error("POST request failed for endpoint: ["+i+"]",a)},handleFailedGET:function(e,t,n,i){var a;this.getPubSub();a=e.responseJSON&&e.responseJSON.error?e.responseJSON.error:e.responseText?e.responseText:"error unknown",console.error("GET request failed for endpoint: ["+i+"]",a)},fetchData:function(e){return this.composeRequest({target:e,method:"GET"})},postData:function(t,n){return this.additionalParameters[t]&&e.extend(n,this.additionalParameters[t]),this.composeRequest({target:t,method:"POST",data:n})},putData:function(t,n){return this.additionalParameters[t]&&e.extend(n,this.additionalParameters[t]),this.composeRequest({target:t,method:"PUT",data:n})},sendRequestWithNewCSRF:function(t){t=e.bind(t,this),this.getBeeHive().getObject("CSRFManager").getCSRF().done(t)},composeRequest:function(t){var a,r=t.target,s=t.method,o=(l=t.data||{}).csrf,l=e.omit(l,"csrf"),c=i[r],u=this,h=$.Deferred();return a={target:c,options:{context:this,type:s,data:e.isEmpty(l)?void 0:JSON.stringify(l),contentType:"application/json",done:function(){h.resolve.apply(h,arguments)},fail:function(){var e="GET"==s?u.handleFailedGET:u.handleFailedPOST,t=[].slice.apply(arguments);t.push(r),e.apply(u,t),h.reject.apply(h,arguments)}}},o?this.sendRequestWithNewCSRF(function(e){a.options.headers={"X-CSRFToken":e},this.getBeeHive().getService("Api").request(new n(a))}):this.getBeeHive().getService("Api").request(new n(a)),h.promise()},redirectIfNecessary:function(){var e=this.getPubSub();if("AuthenticationPage"===this.getBeeHive().getObject("MasterPageManager").currentChild&&this.isLoggedIn()){var t=this.getBeeHive().getService("HistoryManager").getPreviousNav();t||(t="index-page"),e.publish.apply(e,[e.NAVIGATE].concat(t))}else"SettingsPage"!==this.getBeeHive().getObject("MasterPageManager").currentChild||this.isLoggedIn()||e.publish(e.NAVIGATE,"authentication-page")},setUser:function(e){this.userModel.set("user",e),this.isLoggedIn()&&this.completeLogIn()},completeLogIn:function(){var e=this;this.fetchData("USER_DATA").done(function(t){e.userModel.set(t)})},completeLogOut:function(){this.userModel.clear()},deleteAccount:function(){var e=this;return this.postData("DELETE",{csrf:!0}).done(function(){e.getApiAccess({reconnect:!0}).done(function(){e.completeLogOut()})})},changeEmail:function(t){var n=this,i=t.email;return t=e.extend(t,{csrf:!0}),this.postData("CHANGE_EMAIL",t).done(function(){n.getPubSub().subscribeOnce(n.getPubSub().NAVIGATE,function(){setTimeout(function(){var e="<p>Please check <b>"+i+"</b> for further instructions</p><p>(If you don't see the email, please <b>check your spam folder</b>)</p>";n.getPubSub().publish(n.getPubSub().ALERT,new o({code:0,msg:e,type:"success",title:"Success",modal:!0}))},100)}),n.getPubSub().publish(n.getPubSub().NAVIGATE,"index-page")})},changePassword:function(t){return t=e.extend(t,{csrf:!0}),this.postData("CHANGE_PASSWORD",t)},getToken:function(){return this.fetchData("TOKEN")},generateToken:function(){return this.putData("TOKEN",{csrf:!0})},getUserData:function(){return this.userModel.toJSON()},setUserData:function(e){var t=this;return this.postData("USER_DATA",e).done(function(e){t.userModel.set(e)})},getUserName:function(){return this.userModel.get("user")},isLoggedIn:function(){return!!this.userModel.get("user")},setMyADSData:function(e){return this.postData("USER_DATA",e)},getOpenURLConfig:function(){return this.getSiteConfig("link_servers")},getSiteConfig:function(e){var t=$.Deferred();var a=new n({target:e?i.SITE_CONFIGURATION+"/"+e:i.SITE_CONFIGURATION,options:{type:"GET",done:function(e){t.resolve(e)},fail:function(e){t.reject(e)}}});return this.getBeeHive().getService("Api").request(a),t.promise()},hardenedInterface:{setUser:"set username into user",isLoggedIn:"whether the user is logged in",getUserName:"get the user's email before the @",setLocalStorage:"sets an object in to user's local storage",getLocalStorage:"gives you a json object for user's local storage",isOrcidModeOn:"figure out if user has Orcid mode activated",setOrcidMode:"set orcid ui on or off",getOpenURLConfig:"get list of openurl endpoints",getUserData:"myads data",setUserData:"POST user data to myads endpoint",getRecentQueries:"get the 10 most recent queries as array",addToRecentQueries:"add a query to the set of recent queries",generateToken:"PUT to token endpoint to make a new token",getToken:"GET from token endpoint",deleteAccount:"POST to delete account endpoint",changePassword:"POST to change password endpoint",changeEmail:"POST to change email endpoint",setMyADSData:"",USER_SIGNED_IN:"constant",USER_SIGNED_OUT:"constant",USER_INFO_CHANGE:"constant"}}),e.extend(h.prototype,s,r.BeeHive,r.App,l,{USER_SIGNED_IN:"user_signed_in",USER_SIGNED_OUT:"user_signed_out",USER_INFO_CHANGE:"user_info_change"}),h}),define("js/components/session",["backbone","js/components/api_request","js/components/api_targets","js/mixins/hardened","js/components/generic_module","js/mixins/dependon","js/components/api_query","js/components/user","js/components/api_feedback","js/mixins/api_access"],function(e,t,n,i,a,r,s,o,l,c){var u=e.Model.extend({defaults:function(){return{resetPasswordToken:void 0}}}),h=a.extend({initialize:function(e){e=e||{};this.model=new u,this.test=!!e.test||void 0,_.bindAll(this,["loginSuccess","loginFail","registerSuccess","registerFail","resetPassword1Success","resetPassword1Fail","resetPassword2Success","resetPassword2Fail"])},activate:function(e){this.setBeeHive(e)},login:function(e){var i=$.Deferred(),a=this;return this.sendRequestWithNewCSRF(function(r){var o=new t({target:n.USER,query:new s({}),options:{type:"POST",data:JSON.stringify(e),contentType:"application/json",headers:{"X-CSRFToken":r},done:function(){i.resolve.apply(i,arguments),a.loginSuccess.apply(a,arguments)},fail:function(){i.reject.apply(i,arguments),a.loginFail.apply(a,arguments)},beforeSend:function(e,t){e.session=this}}});return this.getBeeHive().getService("Api").request(o)}),i.promise()},sendRequestWithNewCSRF:function(e){e=_.bind(e,this),this.getBeeHive().getObject("CSRFManager").getCSRF().done(e)},logout:function(){this.sendRequestWithNewCSRF(function(e){var i=new t({target:n.LOGOUT,query:new s({}),options:{context:this,type:"POST",headers:{"X-CSRFToken":e},contentType:"application/json",done:this.logoutSuccess}});return this.getBeeHive().getService("Api").request(i)})},register:function(e){var i=this.test?"location.origin":location.origin;_.extend(e,{verify_url:i+"/#user/account/verify/register"}),this.sendRequestWithNewCSRF(function(i){var a=new t({target:n.REGISTER,query:new s({}),options:{type:"POST",data:JSON.stringify(e),contentType:"application/json",headers:{"X-CSRFToken":i},done:this.registerSuccess,fail:this.registerFail}});return this.getBeeHive().getService("Api").request(a)})},resetPassword1:function(e){var i=this.test?"location.origin":location.origin;_.extend(e,{reset_url:i+"/#user/account/verify/reset-password"});var a=e.email;e=_.omit(e,"email");this.sendRequestWithNewCSRF(function(i){var r=new t({target:n.RESET_PASSWORD+"/"+a,query:new s({}),options:{type:"POST",data:JSON.stringify(e),headers:{"X-CSRFToken":i},contentType:"application/json",done:this.resetPassword1Success,fail:this.resetPassword1Fail}});return this.getBeeHive().getService("Api").request(r)})},resetPassword2:function(e){this.sendRequestWithNewCSRF(function(i){var a=new t({target:n.RESET_PASSWORD+"/"+this.model.get("resetPasswordToken"),query:new s({}),options:{type:"PUT",data:JSON.stringify(e),contentType:"application/json",headers:{"X-CSRFToken":i},done:this.resetPassword2Success,fail:this.resetPassword2Fail}});return this.getBeeHive().getService("Api").request(a)})},setChangeToken:function(e){this.model.set("resetPasswordToken",e)},loginSuccess:function(e,t,n){this.getApiAccess({reconnect:!0}).done(function(){})},loginFail:function(e,t,n){var i=this.getPubSub(),a="Log in was unsuccessful ("+(e.responseJSON&&e.responseJSON.error?e.responseJSON.error:e.responseJSON&&e.responseJSON.message?e.responseJSON.message:"error unknown")+")";i.publish(i.ALERT,new l({code:0,msg:a,type:"danger",fade:!0})),i.publish(i.USER_ANNOUNCEMENT,"login_fail",a)},logoutSuccess:function(e,t,n){var i=this;this.getApiAccess({reconnect:!0}).done(function(){i.getBeeHive().getObject("User").completeLogOut()})},registerSuccess:function(e,t,n){var i=this.getPubSub();i.publish(i.USER_ANNOUNCEMENT,"register_success")},registerFail:function(e,t,n){var i=this.getPubSub(),a="Registration was unsuccessful ("+(e.responseJSON&&e.responseJSON.error?e.responseJSON.error:"error unknown")+")";i.publish(i.ALERT,new l({code:0,msg:a,type:"danger",fade:!0})),i.publish(i.USER_ANNOUNCEMENT,"register_fail",a)},resetPassword1Success:function(e,t,n){var i=this.getPubSub();i.publish(i.USER_ANNOUNCEMENT,"reset_password_1_success")},resetPassword1Fail:function(e,t,n){var i=this.getPubSub(),a="password reset step 1 was unsuccessful ("+(e.responseJSON&&e.responseJSON.error?e.responseJSON.error:"error unknown")+")";i.publish(i.ALERT,new l({code:0,msg:a,type:"danger",fade:!0})),i.publish(i.USER_ANNOUNCEMENT,"reset_password_1_fail",a)},resetPassword2Success:function(e,t,n){var i,a;i=this.getApiAccess({reconnect:!0}),a=this.getPubSub(),i.done(function(){a.publish(a.USER_ANNOUNCEMENT,"reset_password_2_success");a.publish(a.NAVIGATE,"index-page"),a.publish(a.ALERT,new l({code:0,msg:"Your password has been successfully reset!",type:"success",modal:!0}))}),i.fail(function(e){var t="Your password was not successfully reset. Please try to follow the link from the email you received again.\n\n("+(e.responseJSON&&e.responseJSON.error?e.responseJSON.error:"error unknown")+")";a.publish(a.USER_ANNOUNCEMENT,"reset_password_2_fail",t),a.publish(a.ALERT,new l({code:0,msg:t,type:"danger",modal:!0}))})},resetPassword2Fail:function(e,t,n){var i=this.getPubSub(),a="password reset step 2 was unsuccessful ("+(e.responseJSON&&e.responseJSON.error?e.responseJSON.error:"error unknown")+")";i.publish(i.ALERT,new l({code:0,msg:a,type:"danger",fade:!0})),i.publish(i.USER_ANNOUNCEMENT,"reset_password_2_fail",a)},hardenedInterface:{login:"log the user in",logout:"log the user out",register:"registers a new user",resetPassword1:"sends an email to account",resetPassword2:"updates the password",setChangeToken:"the router stores the token to reset password here"}});return _.extend(h.prototype,r.BeeHive,i,c),h}),define("js/mixins/discovery_bootstrap",["underscore","backbone","js/components/api_query","js/components/api_request","js/components/pubsub_events","hbs","js/components/api_targets"],function(e,t,n,i,a,r,s){var o=function(){var n=new RegExp("^#(/?("+["classic-form","paper-form","index","search","execute-query","abs","user","orcid-instructions","public-libraries"].join("|")+").*/?)?$","i"),i=e.memoize(function(e){return!!n.test(e)&&e.replace(/^\/?#\/?/,"/")}),a=function(e){if(window.bbb)try{return bbb.getBeeHive().getService("Navigator").router.navigate(e.data.url,{trigger:!0,replace:!1}),!1}catch(e){console.error(e.message)}else console.error("cannot find application object")},r=!1;$(document).on("mousedown focus","a",function(e){if(t.history&&t.history.options&&t.history.options.pushState){var n=$(this);if(!n.data().dontHandle){var s=i(n.attr("href"));if(s){var o=n.attr("href");return n.attr("href",s),e.metaKey||e.ctrlKey?void(r=!0):r&&"focusin"===e.type?void(r=!1):(r=!1,n.one("click",{url:s},a),n.one("mouseup blur",function(){n.attr("href",o)}),!1)}}}})};return{configure:function(){var e=this.getObject("DynamicConfig");if(e){var t=this.getBeeHive(),n=t.getService("Api");e.root&&(n.url=e.root+"/"+n.url,this.root=e.root),void 0!==e.debug&&(t.debug=e.debug,this.getController("QueryMediator").debug=e.debug),e.apiRoot&&(n.url=e.apiRoot),e.version&&(n.clientVersion=e.version),n.modifyRequestOptions=function(e,t){-1==s._doesntNeedCredentials.indexOf(t.get("target"))&&(e.xhrFields={withCredentials:!0})};var i=t.getService("OrcidApi");e.orcidProxy&&(i.orcidProxyUri=location.origin+e.orcidProxy),this.bootstrapUrls=e.bootstrapUrls,e.useCache&&this.triggerMethodOnAll("activateCache")}},bootstrap:function(){var t=this.getBeeHive(),a=(this.getObject("DynamicConfig"),$.Deferred()),r=t.getService("PersistentStorage").get("appConfig");if(r&&r.expire_in&&new Date(r.expire_in)>new Date)return a.resolve(r).promise();var s=this.getBeeHive().getService("Api");if(this.bootstrapUrls){var o=this.bootstrapUrls.length,l={},c={done:function(t){o--,e.extend(l,t),o<=0&&a.resolve(l)},fail:function(){--o<=0&&a.resolve(l)},type:"GET",timeout:9999};e.each(this.bootstrapUrls,function(e){e.indexOf("http")>-1?(c.u=e,s.request(new i({query:new n,target:""}),c)):(delete c.u,s.request(new i({query:new n,target:e}),c))}),setTimeout(function(){"resolved"!==a.state()&&a.reject(new Error("Timed out while loading modules"))},1e4)}else setTimeout(function(){a.resolve({})},1);return a},reload:function(e){if(!(location.search.indexOf("debug")>-1))return location.search&&location.search.indexOf("bbbRedirect=1")>-1?this.redirect(e):void(location.search=location.search?location.search+"&bbbRedirect=1":"bbbRedirect=1");console.warn("Debug stop, normally would reload to: "+e)},redirect:function(e){this.router&&(location.pathname=this.router.root+e),location.href=location.protocol+"//"+location.hostname+":"+location.port+location.pathname.substring(0,location.pathname.lastIndexOf("/"))+"/"+e},start:function(n){var i=$.Deferred(),a=this,r=this.getBeeHive(),s=(r.getService("Api"),this.getObject("DynamicConfig"));this.getBeeHive().getObject("AppStorage").setConfig(s);var l=function(e){throw new Error("Ooops. Check you config! There is no "+e+" component @#!")},c=a.getBeeHive().Services.get("Navigator");c||l("services.Navigator");var u=a.getObject("MasterPageManager");return u||l("objects.MasterPageManager"),u.assemble(a).done(function(){var l=$("div#body-template-container");if(window.__PRERENDERED){var h=$("div#content-container");$(h.selector,u.view.el).html(h.html()),l.html(u.view.el)}else l.html(u.view.el);a.router=new n,a.router.activate(r.getHardenedInstance()),c.start(a),c.router=a.router;var d=location.search.indexOf("pushstate=false")>-1,p=e.defaults({pushState:!d&&void 0},s&&s.routerConf);t.history.start(p),o(),$(document).on("scroll",function(){$("#landing-page-layout").length>0||($(window).scrollTop()>50?($(".s-quick-add").addClass("hidden"),$(".s-search-bar-full-width-container").addClass("s-search-bar-motion")):($(".s-search-bar-full-width-container").removeClass("s-search-bar-motion"),$(".s-quick-add").removeClass("hidden")))}),i.resolve()}),i.promise()}}}),define("js/mixins/formatter",[],function(){var e={formatNum:function(e){var t=[],n=(e+="").split("."),i="";return 2===n.length&&(e=n[0],i="."+n[1]),e.length<4?e+i:(e=e.split("").reverse(),_.each(e,function(n,i){t.unshift(n),(i+1)%3==0&&i!==e.length-1&&t.unshift(",")}),t.join("")+i)}};return e}),define("js/mixins/openurl_generator",["underscore"],function(e){var t=function(t){return e.isString(t)},n=function(t){return e.isArray(t)},i={url_ver:"Z39.88-2004",rft_val_fmt:"info:ofi/fmt:kev:mtx:",rfr_id:"info:sid/ADS",sid:"ADS"};return{getOpenUrl:function(e){var a=e||{},r=a.metadata,s=a.linkServer,o=void 0===s?"":s,l=r||{},c=l.page,u=l.doi,h=l.doctype,d=l.bibcode,p=l.author,f=l.issue,g=l.volume,b=l.pub,v=l.year,m=l.title,y=l.issn,S=l.isbn,A=t(d)&&(d.includes("PhDT")?"PhD":!!d.includes("MsT")&&"Masters"),_=t(h)&&t(d)&&d.includes("PhDT")?"dissertation":t(h)?h:"article",P=_objectSpread({},i,{"rft.spage":!!n(c)&&c[0].split("-")[0],id:!!n(u)&&"doi:"+u[0],genre:_,rft_id:[!!n(u)&&"info:doi/"+u[0],!!t(d)&&"info:bibcode/"+d],"rft.degree":A,"rft.aulast":!!t(p)&&p.split(", ")[0],"rft.aufirst":!!t(p)&&p.split(", ")[1],"rft.issue":!!t(f)&&f,"rft.volume":!!t(g)&&g,"rft.jtitle":!!t(b)&&b,"rft.date":!!t(v)&&v,"rft.atitle":!!n(m)&&m[0],"rft.issn":!!n(y)&&y[0],"rft.isbn":!!n(S)&&S[0],"rft.genre":_,rft_val_fmt:i.rft_val_fmt+(t(h)?h:"article")}),w=_objectSpread({},P,{spage:P["rft.spage"],volume:P["rft.volume"],title:P["rft.jtitle"],atitle:P["rft.atitle"],aulast:P["rft.aulast"],aufirst:P["rft.aufirst"],date:P["rft.date"],isbn:P["rft.isbn"],issn:P["rft.issn"]}),E=o.includes("?")?o+"&":o+"?",C=Object.keys(w).filter(function(e){return w[e]}).map(function(e){if(w[e])return n(w[e])?w[e].filter(function(e){return e}).map(function(t){return"".concat(e,"=").concat(t)}).join("&"):"".concat(e,"=").concat(w[e])});return encodeURI(E+C.join("&"))}}}),define("js/mixins/link_generator_mixin",["underscore","js/mixins/openurl_generator"],function(e,t){var n=t.getOpenUrl,i=["ADS PDF","ADS Scanned Article","My Institution","Publisher Article","Publisher PDF","arXiv PDF"],a={AcA:{shortName:"AcA",description:"Acta Astronomica Data Files"},ADS_PDF:{name:"ADS PDF",shortName:"ADS",description:"ADS PDF",type:"PDF"},ADS_SCAN:{name:"ADS Scanned Article",description:"ADS scanned article",shortName:"ADS",type:"SCAN"},ALMA:{shortName:"ALMA",description:"Atacama Large Millimeter/submillimeter Array"},ARI:{shortName:"ARI",description:"Astronomisches Rechen-Institut"},Astroverse:{shortName:"Astroverse",description:"CfA Dataverse"},ATNF:{shortName:"ATNF",description:"Australia Telescope Online Archive"},Author:{shortName:"Author",description:"Author Hosted Dataset"},AUTHOR_HTML:{name:"Author Article",shortName:"Author",description:"Link to HTML page provided by author",type:"HTML"},AUTHOR_PDF:{name:"Author PDF",shortName:"Author",description:"Link to PDF page provided by author",type:"PDF"},BAVJ:{shortName:"BAVJ",description:"Data of the German Association for Variable Stars"},BICEP2:{shortName:"BICEP2",description:"BICEP/Keck Data"},CADC:{shortName:"CADC",description:"Canadian Astronomy Data Center"},CDS:{shortName:"CDS",description:"Strasbourg Astronomical Data Center"},Chandra:{shortName:"Chandra",description:"Chandra X-Ray Observatory"},Dryad:{shortName:"Dryad",description:"International Repository of Research Data"},EPRINT_HTML:{name:"arXiv Article",shortName:"arXiv",description:"Arxiv article",type:"HTML"},EPRINT_PDF:{name:"arXiv PDF",shortName:"arXiv",description:"ArXiv eprint",type:"PDF"},ESA:{shortName:"ESA",description:"ESAC Science Data Center"},ESO:{shortName:"ESO",description:"European Southern Observatory"},Figshare:{shortName:"Figshare",description:"Online Open Access Repository"},GCPD:{shortName:"GCPD",description:"The General Catalogue of Photometric Data"},Github:{shortName:"Github",description:"Web-based version-control and collaboration platform for software developers."},GTC:{shortName:"GTC",description:"Gran Telescopio CANARIAS Public Archive"},HEASARC:{shortName:"HEASARC",description:"NASA's High Energy Astrophysics Science Archive Research Center"},Herschel:{shortName:"Herschel",description:"Herschel Science Center"},IBVS:{shortName:"IBVS",description:"Information Bulletin on Variable Stars"},INES:{shortName:"INES",description:"IUE Newly Extracted Spectra"},IRSA:{shortName:"IRSA",description:"NASA/IPAC Infrared Science Archive"},ISO:{shortName:"ISO",description:"Infrared Space Observatory"},JWST:{shortName:"JWST",description:"JWST Proposal Info"},KOA:{shortName:"KOA",description:"Keck Observatory Archive"},MAST:{shortName:"MAST",description:"Mikulski Archive for Space Telescopes"},NED:{shortName:"NED",description:"NASA/IPAC Extragalactic Database"},NExScI:{shortName:"NExScI",description:"NASA Exoplanet Archive"},NOAO:{shortName:"NOAO",description:"National Optical Astronomy Observatory"},PANGAEA:{shortName:"PANGAEA",description:"Digital Data Library and a Data Publisher for Earth System Science"},PASA:{shortName:"PASA",description:"Publication of the Astronomical Society of Australia Datasets"},PDG:{shortName:"PDG",description:"Particle Data Group"},PDS:{shortName:"PDS",description:"The NASA Planetary Data System"},protocols:{shortName:"protocols",description:"Collaborative Platform and Preprint Server for Science Methods and Protocols"},PUB_HTML:{name:"Publisher Article",shortName:"Publisher",description:"Electronic on-line publisher article (HTML)",type:"HTML"},PUB_PDF:{name:"Publisher PDF",shortName:"Publisher",description:"Publisher PDF",type:"PDF"},SIMBAD:{shortName:"SIMBAD",description:"SIMBAD Database at the CDS"},Spitzer:{shortName:"Spitzer",description:"Spitzer Space Telescope"},TNS:{shortName:"TNS",description:"Transient Name Server"},Vizier:{shortName:"VizieR",description:"VizieR Catalog Service"},XMM:{shortName:"XMM",description:"XMM Newton Science Archive"},Zenodo:{shortName:"Zenodo",description:"Zenodo Archive"}},r=function(e){return encodeURIComponent(e)};return{LINK_TYPES:a,parseLinksData:function(t){var n=e.bind(this._parseLinksDataForModel,this),i=e.bind(this.parseResourcesData,this);return e.isArray(t)?e.map(t,function(e){try{var t=i(e);return n(e,t)}catch(t){return e}}):[]},parseResourcesData:function(t){var n=e.bind(this._processLinkData,this);if(e.isPlainObject(t)){if(e.isArray(t.property)&&e.isString(t.bibcode)){if(e.contains(t.property,"ESOURCE")&&!e.has(t,"esources"))throw new Error("if `property` property contains `ESOURCE`, then data must have `esources` field");if(e.contains(t.property,"DATA")&&!e.has(t,"data"))throw new Error("if `property` property contains `DATA`, then data must have `data` field");return n(e.extend({},t))}throw new Error("data must have `property` and `bibcode`")}throw new Error("data must be a plain object")},createUrlByType:function(t,n,i){var a=i;return e.isArray(a)&&(a=a[0]),e.isString(t)&&e.isString(n)&&e.isString(a)?"/link_gateway/"+t+"/"+n+":"+a:""},_createGatewayUrl:function(t,n){return e.isString(t)&&e.isString(n)?"/link_gateway/"+r(t)+"/"+n:""},_processLinkData:function(t){var r=this._createGatewayUrl,s=[],o=[],l=0,c=t.property;return e.forEach(t.esources,function(i,o,u){var h=i.split("_"),d=a[i],p=t.link_server;(t.doi||t.issn||t.isbn)&&p&&l<1&&(s.push({url:n({metadata:t,linkServer:p}),openUrl:!0,type:"INSTITUTION",shortName:"My Institution",name:"My Institution",description:"Find Article At My Institution"}),l+=1),h.length>1?s.push({url:r(t.bibcode,i),open:e.contains(c,h[0]+"_OPENACCESS"),shortName:d&&d.shortName||i,name:d&&d.name||i,type:d&&d.type||"HTML",description:d&&d.description}):s.push({url:r(t.bibcode,i),open:!1,shortName:d&&d.shortName||i,name:d&&d.name||i,type:d&&d.type||"HTML",description:d&&d.description})}),!e.find(s,{name:a.EPRINT_PDF.name})&&e.isArray(t.links_data)&&e.forEach(t.links_data,function(e){var t=JSON.parse(e);if(/preprint/i.test(t.type)){var n=a.EPRINT_PDF;s.push({url:t.url,open:!0,shortName:n&&n.shortName||t.type,name:n&&n.name||t.type,type:n&&n.type||"HTML",description:n&&n.description})}}),s=e.sortBy(s,function(e){var t=i.indexOf(e.name);return t>-1?t:9999}),e.forEach(t.data,function(e){var n=e.split(":"),i=a[n[0]];n.length>1?o.push({url:r(t.bibcode,n[0]),count:n[1],name:i?i.shortName:n[0],description:i?i.description:n[0]}):o.push({url:r(t.bibcode,e),count:"1",name:i?i.shortName:e,description:i?i.description:e})}),o=e.sortBy(o,"count").reverse(),{fullTextSources:s,dataProducts:o}},_parseLinksDataForModel:function(t,n){var i={list:[],data:[],text:[]},a=e.extend({},t,{links:i});if(e.isPlainObject(n)&&(i=e.assign(i,{data:i.data.concat(n.dataProducts||[]),text:i.text.concat(n.fullTextSources||[])})),!e.isPlainObject(a))throw new Error("data must be a plain object");if(e.isPlainObject(a["[citations]"])&&e.isString(a.bibcode)){var s=a["[citations]"];e.isNumber(s.num_citations)&&s.num_citations>0&&i.list.push({letter:"C",name:"Citations ("+s.num_citations+")",url:"#abs/"+r(a.bibcode)+"/citations"}),e.isNumber(s.num_references)&&s.num_references>0&&i.list.push({letter:"R",name:"References ("+s.num_references+")",url:"#abs/"+r(a.bibcode)+"/references"})}return e.isArray(a.property)&&e.isString(a.bibcode)&&e.contains(a.property,"TOC")&&i.list.push({letter:"T",name:"Table of Contents",url:"#abs/"+r(a.bibcode)+"/toc"}),a}}}),define("js/mixins/widget_utility",[],function(){var e={extendMethod:function(e,t,n){if(!_.isUndefined(t[n])){var i=e[n];e[n]=function(){var e=i.apply(this,arguments);return t[n].apply(this,arguments),e}}}};return e}),define("js/mixins/widget_mixin_method",["js/mixins/widget_utility"],function(e){return function(t,n){var i=this.prototype;_.extend(t,i),_.extend(t.events,i.events),_.each(Array.prototype.slice.call(arguments,1),function(n){e.extendMethod(i,t,n)})}}),define("js/mixins/widget_state_manager",["underscore","js/components/api_feedback"],function(e,t){return{STATES:{LOADING:"loading",ERRORED:"errored",IDLE:"idle",READY:"ready"},activateWidget:function(){this.__widgetHandlerManager=new function(){this.handlers={},this.on=function(e,t){this.handlers[e].push(t)},this.off=function(t){e.forEach(this.handlers,function(e,n){var i=e.indexOf(t);i>-1&&e.splice(i,1)})},this.fire=function(t,n,i){e.forEach(this.handlers[t],function(e){e.apply(i,n)})},e.reduce(t.CODES,function(e,t){return e[t]=[],e},this.handlers)};var n=this.getPubSub();n.subscribe(n.FEEDBACK,e.bind(this.__handleFeedback,this)),this.updateState("ready")},__handleFeedback:function(e,t){this.getPubSub().getCurrentPubSubKey().getId()===t.getId()&&this.__widgetHandlerManager.fire(e.code,arguments,this)},attachHandler:function(e,t){try{this.__widgetHandlerManager.on(e,t)}catch(e){console.error(e)}},attachGeneralHandler:function(n){e.forEach(t.CODES,e.bind(function(e){(e>0||e===t.CODES.API_REQUEST_ERROR)&&this.attachHandler(e,n)},this))},detachHandler:function(e){this.__widgetHandlerManager.off(e)},onReady:e.noop,onLoading:e.noop,onIdle:e.noop,onErrored:e.noop,onStateChange:e.noop,updateState:function(t){if(t&&e.isString(t)&&t!==this.__state){var n=this.__state;this.__state=t,this.__fireStateHandler(),this.onStateChange.call(this,t,n)}},getState:function(){return this.__state},__fireStateHandler:function(){var e={};e.ready=this.onReady,e.loading=this.onLoading,e.idle=this.onIdle,e.errored=this.onErrored,e[this.__state]&&e[this.__state].call(this,this)}}}),define("js/modules/orcid/work",["underscore","jsonpath"],function(e,t){var n={status:"$.status",title:"$.title",publicationDateMonth:"$.pubmonth",publicationDateYear:"$.pubyear",lastModifiedDate:"$.updated",sourceName:"$.source",putCode:"$.putcode",identifier:"$.identifier"},i={createdDate:'$["created-date"].value',lastModifiedDate:'$["last-modified-date"].value',sourceOrcidIdUri:'$.source["source-orcid"].uri',sourceOrcidIdPath:'$.source["source-orcid"].path',sourceOrcidIdHost:'$.source["source-orcid"].host',sourceClientIdUri:'$.source["source-client-id"].uri',sourceClientIdPath:'$.source["source-client-id"].path',sourceClientIdHost:'$.source["source-client-id"].host',sourceName:'$.source["source-name"].value',putCode:'$["put-code"]',path:"$.path",title:'$["title"].title.value',subtitle:'$["title"].subtitle.value',translatedTitle:'$["title"]["translated-title"].value',translatedTitleLang:'$["title"]["translated-title"]["language-code"]',journalTitle:'$["journal-title"].value',shortDescription:'$["short-description"]',citationType:'$.citation["citation-type"]',citationValue:'$.citation["citation-value"]',type:"$.type",publicationDateYear:'$["publication-date"].year.value',publicationDateMonth:'$["publication-date"].month.value',publicationDateDay:'$["publication-date"].day.value',publicationDateMedia:'$["publication-date"]["media-type"]',url:"$.url.value",contributorOrcidUri:'$["contributors"].contributor..["contributor-orcid"].uri',contributorOrcidPath:'$["contributors"].contributor..["contributor-orcid"].path',contributorOrcidHost:'$["contributors"].contributor..["contributor-orcid"].host',contributorName:'$["contributors"].contributor..["credit-name"].value',contributorEmail:'$["contributors"].contributor..["contributor-email"].value',contributorAttributes:'$["contributors"].contributor..["contributor-attributes"]',contributorSequence:'$["contributors"].contributor..["contributor-attributes"]["contributor-sequence"]',contributorRole:'$["contributors"].contributor..["contributor-attributes"]["contributor-role"]',externalIdValue:'$["external-ids"]["external-id"]..["external-id-value"]',externalIdType:'$["external-ids"]["external-id"]..["external-id-type"]',externalIdUrl:'$["external-ids"]["external-id"]..["external-id-url"]',externalIdRelationship:'$["external-ids"]["external-id"]..["external-id-relationship"]',country:"$.country.value",visibility:"$.visibility.value",identifier:"$.identifier"},a=function(a,r){a=a||{},this.useOrcidPaths=r,this._root=a,this.sources=[],this.getSources=function(){return e.isEmpty(this.sources)?[this.getSourceName()]:this.sources},this.setSources=function(t){return e.isArray(t)&&(this.sources=t),this.sources},this.get=function(n){var i=t.query(this._root,n);return e.isEmpty(i)?null:e.isArray(i)&&i.length<=1?i[0]:i},this.getAsOrcid=function(){return e.reduce(i,e.bind(function(n,i){var a=this.get(i);return a&&(e.isArray(a)?e.forEach(a,function(e,a){t.value(n,i.replace("..","["+a+"]"),e)}):t.value(n,i,a)),n},this),{})},this.toADSFormat=function(){var t;return this.useOrcidPaths&&((t=this.getExternalIds()).doi&&(t.doi=[t.doi]),t.identifier=e.values(t)[0]),e.extend({},{title:[this.getTitle()],formattedDate:this.getFormattedPubDate(),source_name:this.getSources().join("; "),identifier:this.getIdentifier(),_work:this},t)},this.getExternalIds=function(){var t=this.getExternalIdType(),n=this.getExternalIdValue();return t=e.isArray(t)?t:[t],n=e.isArray(n)?n:[n],t.length!==n.length?{}:e.reduce(t,function(e,t,i){return e[t]=n[i],e},{})},this.getFormattedPubDate=function(){return(this.getPublicationDateYear()||"????")+"/"+(this.getPublicationDateMonth()||"??")};var s=this.useOrcidPaths?i:n;e.reduce(s,function(t,n,i){e.isString(i)&&i.slice&&(t["get"+(i[0].toUpperCase()+i.slice(1))]=e.partial(t.get,n));return t},this)};return a.adsToOrcid=function(n,a){var r="$.pubdate",s="$.abstract",o="$.bibcode",l="$.pub",c="$.doi[0]",u="$.author[*]",h="$.title[0]",d="$.doctype",p="$.all_ids",f=function(n,i,a){return a&&(e.isArray(a)?e.forEach(a,function(e,a){t.value(n,i.replace("..","["+a+"]"),e)}):t.value(n,i,a)),n},g=function(i){var a=t.query(n,i);return e.isEmpty(a)?null:e.isArray(a)&&a.length<=1?a[0]||"":a||""},b={};try{var v={types:[],values:[],relationships:[]},m=g(o),y=g(c);m&&(v.types.push("bibcode"),v.values.push(m),v.relationships.push("SELF")),y&&(v.types.push("doi"),v.values.push(y),v.relationships.push("SELF"));var S=g(p),A=!1;e.isArray(S)&&(A=S.find(function(e){return e.toLowerCase().startsWith("arxiv")})),A&&(A=A.substr(6),v.types.push("arxiv"),v.values.push(A),v.relationships.push("SELF")),f(b,i.publicationDateYear,g(r).split("-")[0]),"00"===g(r).split("-")[1]?f(b,i.publicationDateMonth,null):f(b,i.publicationDateMonth,g(r).split("-")[1]),f(b,i.shortDescription,g(s).slice(0,4997)+"..."),f(b,i.externalIdType,v.types),f(b,i.externalIdValue,v.values),f(b,i.externalIdRelationship,v.relationships),f(b,i.journalTitle,g(l)),f(b,i.type,{article:"JOURNAL_ARTICLE",inproceedings:"CONFERENCE_PAPER",abstract:"CONFERENCE_ABSTRACT",eprint:"WORKING_PAPER",phdthesis:"DISSERTATION",techreport:"RESEARCH_TECHNIQUE",inbook:"BOOK_CHAPTER",circular:"RESEARCH_TOOL",misc:"OTHER",book:"BOOK",proceedings:"BOOK",bookreview:"BOOK_REVIEW",erratum:"JOURNAL_ARTICLE",proposal:"OTHER",newsletter:"NEWSLETTER_ARTICLE",catalog:"DATA_SET",intechreport:"RESEARCH_TECHNIQUE",mastersthesis:"DISSERTATION",obituary:"OTHER",pressrelease:"OTHER",software:"RESEARCH_TECHNIQUE",talk:"LECTURE_SPEECH"}[g(d)]||"JOURNAL_ARTICLE");var _=g(u);_=e.isArray(_)?_:[_],f(b,i.contributorName,_);var P=e.map(_,function(){return"AUTHOR"});f(b,i.contributorRole,P),f(b,i.title,g(h)),a&&f(b,i.putCode,a)}catch(e){return null}return b},a}),define("js/modules/orcid/profile",["underscore","jsonpath","js/modules/orcid/work"],function(e,t,n){var i={workSummaries:"$"};return function(a){this._root=a||{},this.works=[],this.get=function(n){var i=t.query(this._root,n);return e.isEmpty(i)?null:e.isArray(i)&&i.length<=1?i[0]:i},this.getWorks=function(){return this.works},this.setWorks=function(e){return this.works=e,this},this.toADSFormat=function(){var t=e.sortBy(this.getWorks(),function(e){return e.getTitle()});return{responseHeader:{params:{}},response:{numFound:(t=e.map(t,function(e){return e.toADSFormat()})).length,start:0,docs:t}}},e.reduce(i,function(t,n,i){return e.isString(i)&&i.slice&&(t["get"+(i[0].toUpperCase()+i.slice(1))]=e.partial(t.get,n)),t},this),this.works=e.map(this.getWorkSummaries(),function(e){return new n(e)})}}),define("js/modules/orcid/bio",["underscore","jsonpath","js/modules/orcid/work"],function(e,t,n){var i={firstName:'$.name["given-names"].value',lastName:'$.name["family-name"].value',orcid:"$.name.path"};return function(n){this._root=n||{},this.get=function(e){return t.query(this._root,e)[0]},this.toADSFormat=function(){return{responseHeader:{params:{orcid:this.getOrcid(),firstName:this.getFirstName(),lastName:this.getLastName()}}}},e.reduce(i,function(t,n,i){return e.isString(i)&&i.slice&&(t["get"+(i[0].toUpperCase()+i.slice(1))]=e.partial(t.get,n)),t},this)}}),define("js/modules/orcid/orcid_api",["underscore","bootstrap","jquery","backbone","js/components/generic_module","js/mixins/dependon","js/components/pubsub_events","js/mixins/link_generator_mixin","js/components/api_query","js/components/api_request","js/mixins/hardened","js/components/api_targets","js/components/api_query_updater","js/components/api_feedback","js/modules/orcid/work","js/modules/orcid/profile","js/modules/orcid/bio"],function(e,t,n,i,a,r,s,o,l,c,u,h,d,p,f,g,b){var v=a.extend({initialize:function(){this.userData={},this.addCache=[],this.deleteCache=[],this.getUserProfileCache=[],this.authData=null,this.addWait=3e3,this.deleteWait=100,this.profileWait=100,this.maxAddChunkSize=100,this.maxDeleteChunkSize=10,this.db={},this.clearDBWait=3e4,this.dbUpdatePromise=null,this.maxQuerySize=100,this.queryUpdater=new d("orcid_api"),this.orcidApiTimeout=3e4,this.adsQueryTimeout=10,this.dirty=!0},activate:function(t){var n=t.getService("PersistentStorage"),i=t.getObject("DynamicConfig");if(this.setBeeHive(t),this.config={},e.extend(this.config,i.Orcid),n){var a=n.get("Orcid");a&&a.authData&&this.saveAccessData(a.authData)}this._addWork=e.debounce(this._addWork,this.addWait),this._getUserProfile=e.debounce(this._getUserProfile,this.profileWait),this._deleteWork=e.debounce(this._deleteWork,this.deleteWait)},checkAccessOrcidApiAccess:function(){return this.hasAccess()?this.getUserProfile():n.Deferred().reject().promise()},hasAccess:function(){return!(!this.authData||!this.authData.expires)&&this.authData.expires>(new Date).getTime()},signIn:function(e){this.getPubSub().publish(this.getPubSub().APP_EXIT,{type:"orcid",url:this.config.loginUrl+"&redirect_uri="+encodeURIComponent(this.config.redirectUrlBase+(e||"/user/orcid"))}),this.getPubSub().publish(this.getPubSub().ORCID_ANNOUNCEMENT,"login")},setADSUserData:function(e){var t=this.getBeeHive().getService("Api").url+h.ORCID_PREFERENCES+"/"+this.authData.orcid,n=this.createRequest(t,{method:"POST"},e);return n.fail(function(){console.error.apply(console,["ADS ORCiD preferences could not be set"].concat(arguments))}),n},getADSUserData:function(){var e=this,t=this.getBeeHive().getService("Api").url+h.ORCID_PREFERENCES+"/"+this.authData.orcid,n=this.createRequest(t);return n.fail(function(){e.signOut(),e.getBeeHive().getObject("User").setOrcidMode(0);var t=e.getPubSub();t.publish(t.ALERT,new p({title:"Expired ORCID login",msg:["Your ORCID login has expired.","Please reload the page and sign in again to access the page.","",'<button onclick="location.reload()" class="btn btn-primary" role="button">Reload</button>'].join("<br/>"),modal:!0,type:"warning"}))}),n},getUserBio:function(){var e=new n.Deferred,t=this.getBeeHive().getService("Api").url+h.ORCID_NAME+"/"+this.authData.orcid,i=this.createRequest(t);return i.fail(function(){console.error.apply(console,["ADS name could not be retrieved"].concat(arguments)),e.reject()}),i.done(function(t){var n=new b(t);e.resolve(n)}),e.promise()},signOut:function(){this.saveAccessData(null),this.getPubSub().publish(this.getPubSub().ORCID_ANNOUNCEMENT,"logout")},hasExchangeCode:function(e){return!!this.getExchangeCode(e)},getExchangeCode:function(e){return this.getUrlParameter("code",e||window.location.search)},getUrlParameter:function(e,t){for(var n=t.substring(1).split("&"),i=0;i<n.length;i++){var a=n[i].split("=");if(a[0]===e)return decodeURIComponent(a[1])}},getAccessData:function(t){var i=this.getBeeHive().getService("Api"),a=n.Deferred(),r={url:this.config.exchangeTokenUrl,done:e.bind(a.resolve,a),fail:e.bind(a.reject,a),always:e.bind(a.always,a),headers:{Accept:"application/json",Authorization:i.access_token}};return i.request(new c({target:this.config.exchangeTokenUrl,query:new l({code:t})}),r),a.promise()},saveAccessData:function(e){var t=this.getBeeHive();e&&!e.expires&&e.expires_in&&(e.expires=(new Date).getTime()+(1e3*e.expires_in-1e3)),this.authData=e;var n=t.getService("PersistentStorage");if(n){var i=n.get("Orcid")||{};i.authData=e,n.set("Orcid",i)}},getUrl:function(t,n){var i=this.config.apiEndpoint+"/"+this.authData.orcid+{profile_bib:"/orcid-profile/simple",profile_full:"/orcid-profile/full?update=True",works:"/orcid-works",work:"/orcid-work"}[t],a=e.isArray(n)?n.join(","):n;return a&&(i+="/"+a),i},createRequest:function(t,i,a){if(e.isUndefined(t))throw new Error("Url must be defined");var r=n.Deferred(),s=this.sendData(t,a,i||{});return s.done(e.bind(r.resolve,r)),s.fail(e.bind(r.reject,r)),s.always(e.bind(r.always,r)),r.promise()},_getUserProfile:function(){var t=this.createRequest(this.getUrl("profile_full")),n=this.getUserProfileCache.splice(0);t.done(function(t){e.forEach(n,function(n){orcidProfile=new g(t),n.resolve(orcidProfile.setWorks(e.map(t,function(e,t){return new f(e)})))})}),t.fail(function(){var t=arguments;e.forEach(n,function(e){e.reject.apply(e,t)})})},getUserProfile:function(){var e=n.Deferred();return this.getUserProfileCache.push(e),this._getUserProfile.call(this),e.promise()},getWork:function(t){var i=n.Deferred();return this.createRequest(this.getUrl("works",t)).done(function(e){i.resolve(new f(e))}).fail(e.bind(i.reject,i)),i.promise()},getWorks:function(t){if(!e.isArray(t))throw new TypeError("putcodes must be an Array");for(var i=n.Deferred(),a=[],r=0,s=t.length;r<s;r+=50){var o=t.slice(r,r+50),l=this.getUrl("works")+"/"+o.join(",");a.push(e.partial(this.createRequest,l))}var c=n.when.apply(n,a);return c.done(e.bind(i.resolve,i)),c.fail(function(){i.reject(arguments)}),i.promise()},updateWork:function(t){if(!e.isPlainObject(t))throw new TypeError("Work should be a simple object");var i=t["put-code"];if(!i)return n.Deferred().reject().promise();var a=this.getUrl("works",i);return this.createRequest(a,{method:"PUT"},t)},deleteWork:function(t){if(!e.isNumber(t))throw new TypeError("putcode should be a number");var i=n.Deferred();return this.deleteCache.push({id:e.uniqueId(),putCode:t,promise:i}),this._deleteWork.call(this),i.promise()},_deleteWork:function(){for(var t,i=this,a=this.deleteCache.slice(0),r=[],s=[],o=0;o<a.length;o+=this.maxDeleteChunkSize)t=a.slice(o,o+this.maxDeleteChunkSize),s.push(t);e.forEach(s,function(t,n){e.forEach(t,function(t){r.push(t.promise.promise()),e.delay(function(){i.createRequest(i.getUrl("works",t.putCode),{beforeSend:function(e){e._id=t.id},method:"DELETE"}).done(e.bind(t.promise.resolve,t.promise)).fail(e.bind(t.promise.reject,t.promise)).always(e.bind(t.promise.always,t.promise));var n=i.deleteCache.indexOf(t);i.deleteCache.splice(n,n+1)},i.deleteWait*n)})});n.when.apply(n,r).always(function(){i.deleteCache=e.reduce(i.deleteCache,function(e,t){return"pending"===t.promise.state()?t.promise.reject():e.push(t),e},[])})},addWork:function(t){if(!e.isPlainObject(t))throw new TypeError("Should be plain object");var i=n.Deferred();return this.addCache.push({id:e.uniqueId(),work:t,promise:i}),this._addWork.call(this),i.promise()},_addWork:function(){var t=this,n=e.map(t.addCache,"work"),i=e.map(t.addCache,"id"),a=t._addWorks(n,i);a.done(function(n){e.forEach(n,function(n,i){var a=e.find(t.addCache,function(e){return e.id===i});if(!a)return console.error("No Cache entry found"),!0;var r=a.promise,s=a.work;n?n.error?409===n.error["response-code"]?r.resolve(s):r.reject():r.resolve(new f(n.work)):r.reject();var o=t.addCache.indexOf(a);t.addCache.splice(o,o+1)})}),a.fail(function(n){var i=arguments;e.forEach(n,function(n){var a=e.findIndex(t.addCache,{id:n});if(a>=0){var r=t.addCache[a].promise;t.addCache.splice(a,a+1),"pending"===r.state()&&r.reject.apply(r,i)}})})},_addWorks:function(t,i){var a=this;if(!e.isArray(t)||!e.isArray(i))throw new TypeError("works and ids must be arrays");for(var r,s,o=n.Deferred(),l=[],c=0;c<t.length;c+=this.maxAddChunkSize){r=t.slice(c,c+this.maxAddChunkSize),s=i.slice(c,c+this.maxAddChunkSize);var u={bulk:[]};e.each(r,function(e){u.bulk.push({work:e})});var h=this.getUrl("works");l.push(this.createRequest(h,{beforeSend:function(e){e.cacheIds=s},method:"POST"},u))}return n.when.apply(n,l).then(function(){var t=e.isArray(arguments[0])?arguments:[arguments],n=e.reduce(t,function(t,n){var i=n&&n[0]&&n[0].bulk,a=n&&n[2]&&n[2].cacheIds;return e.forEach(a,function(e,n){t[e]=i[n]}),t},{});o.resolve(n)},function(e){a.setDirty(),o.reject.apply(o,[e.cacheIds].concat(arguments))}),o.promise()},sendData:function(t,i,a){var r=n.Deferred();a=a||{};var s={type:"GET",url:t,contentType:"application/json",cache:!!this.dbUpdatePromise,timeout:this.orcidApiTimeout,done:e.bind(r.resolve,r),fail:e.bind(r.reject,r),always:e.bind(r.always,r)};i?(s.dataType="json",s.data=JSON.stringify(i),s.converters={"* text":window.String,"text html":!0,"text json":function(e){return e=e||"{}",n.parseJSON(e)},"text xml":n.parseXML}):s.data=null,e.extend(s,a);var o=this.getBeeHive().getService("Api");return s.headers||(s.headers={}),s.headers.Authorization=o.access_token,!s.headers["Orcid-Authorization"]&&this.authData&&(s.headers["Orcid-Authorization"]="Bearer "+this.authData.access_token),s.headers["Content-Type"]||(s.headers["Content-Type"]="application/json"),s.headers.Accept||(s.headers.Accept="application/json"),o.request(new c({target:t,query:new l,options:s})),r.promise()},_checkIdsInADS:function(t){var i=this.getBeeHive().getService("Api"),a=n.Deferred();t.set("fl","bibcode, doi, alternate_bibcode"),t.set("rows","5000");var r=function(){a.resolve({})};return i.request(new c({target:h.SEARCH,query:t,options:{done:function(t){if(!t||!t.response||!t.response.docs)return a.resolve({});var n=e.reduce(t.response.docs,function(t,n){var i=n.bibcode.toLowerCase();return t["identifier:"+i]=i,e.each(n.doi,function(e){var n="identifier:"+e.toLowerCase().replace("doi:","");t[n]=i}),e.each(n.alternate_bibcode,function(e){var n="identifier:"+e.toLowerCase();t[n]=i}),t},{});a.resolve(n)},fail:r}})).fail(r),function t(n){if("pending"===a.state()&&n<=0)return a.reject("Request Timeout");"resolved"!==a.state()&&e.delay(t,1e3,--n)}(this.adsQueryTimeout),a.promise()},isSourcedByADS:function(e){return e.getSourceName().indexOf("NASA Astrophysics Data System")>-1},_buildQuery:function(t){if(e.isEmpty(t)||!t.identifier)return null;var n=e.filter(t.identifier,function(t){return!e.isEmpty(t.trim())||"NONE"===t}).join(" OR ");return e.isEmpty(n)?null:new l({q:"identifier:("+n+")"})},updateDatabase:function(t){var i=this;if(this.dbUpdatePromise&&"pending"===this.dbUpdatePromise.state())return this.dbUpdatePromise.promise();this.dbUpdatePromise=n.Deferred();var a=function(e){var t=i.dbUpdatePromise;i.setClean(),i.db=e,t&&t.resolve(),setTimeout(function(){t&&"pending"!==t.state()&&(t=null,i.setDirty())},i.clearDBWait)},r=function(t){var r=t.getWorks(),s=[],o={};if(e.forEach(r,function(e,t){var n="identifier:";(n+=e.getIdentifier())&&(s.push(n),o[n.toLowerCase()]={sourcedByADS:i.isSourcedByADS(e),putcode:e.getPutCode(),idx:t})}),s.length&&i.maxQuerySize>0){var l=[];s=s.sort();for(var c=e.range(0,s.length,i.maxQuerySize),u=0;u<c.length;u++){for(var h={},d=c[u];d<c[u]+i.maxQuerySize&&!(d>=s.length);d++){var p=s[d].split(":");h[p[0]]||(h[p[0]]=[]),h[p[0]].push(i.queryUpdater.quoteIfNecessary(p[1]))}var f=i._buildQuery(h);f&&l.push(i._checkIdsInADS(f))}}else a(o);n.when.apply(n,l).then(function(t){e.each(o,function(e,n){var i=t[n];i?o[n].bibcode=i:o[n].idx=-1}),a(o)},function(){console.error.apply(console,["Error processing response from ADS"].concat(arguments)),a(o)})};return t?r(t):this.getUserProfile().done(r).fail(function(){i.dbUpdatePromise.reject.apply(i.dbUpdatePromise,arguments)}),i.dbUpdatePromise.promise()},getRecordInfo:function(t){var i=this,a=n.Deferred(),r=function(t){var n={isCreatedByADS:!1,isCreatedByOthers:!1,isKnownToADS:!1,provenance:null},a=function(t,a){var r=("identifier:"+t).toLowerCase(),s=i.db[r];s&&(s.sourcedByADS?n.isCreatedByADS=!0:n.isCreatedByOthers=!0,s.idx>-1&&(n.isKnownToADS=!0),n=e.extend({},n,s))},r=e.pick(t,"identifier","bibcode","doi","alternate_bibcode");return e.each(r,function(t,n){e.isArray(t)?e.each(t,a):a(t,0)}),n};return this.needsUpdate()?this.updateDatabase().done(function(){a.resolve(r(t))}).fail(e.bind(a.reject,a)):a.resolve(r(t)),a.promise()},needsUpdate:function(){return this.dirty},setDirty:function(){this.dirty=!0},setClean:function(){this.dirty=!1},hardenedInterface:{hasAccess:"boolean indicating access to ORCID Api",getUserProfile:"get user profile",getUserBio:"get user bio",signIn:"login",signOut:"logout",getADSUserData:"",setADSUserData:"",getRecordInfo:"provides info about a document",addWork:"add a new orcid work",deleteWork:"remove an entry from orcid",updateWork:"update an orcid work",getWork:"get an orcid work",getWorks:"get an array of orcid works"}});return e.extend(v.prototype,r.BeeHive),e.extend(v.prototype,u),v}),define("js/modules/orcid/module",["backbone","underscore","js/components/generic_module","./orcid_api"],function(e,t,n,i){var a=n.extend({activate:function(e){var n=e.getObject("DynamicConfig");if(!n)throw new Error("DynamicConfig is not available to Orcid module");var i=n.orcidRedirectUrlBase||location.protocol+"//"+location.host,a=n.orcidClientId,r=n.orcidApiEndpoint,s=n.orcidLoginEndpoint;if(!a||!r)throw new Error("Missing configuration for ORCID module: orcidApiEndpoint, orcidClientId");var o={redirectUrlBase:i,apiEndpoint:r,clientId:a,worksUrl:r+"/{0}/orcid-works",loginUrl:s+"?scope=/orcid-profile/read-limited%20/orcid-works/create%20/orcid-works/update&response_type=code&access_type=offline&show_login=true&client_id="+a,exchangeTokenUrl:r+"/exchangeOAuthCode"};t.extend(n,{Orcid:o}),this.activateDependencies(e)},activateDependencies:function(e){var t=e.getService("OrcidApi");t||((t=new i).activate(e),e.addService("OrcidApi",t))}});return function(){return{activate:function(e){(new a).activate(e)}}}}),define("hbs!js/page_managers/templates/results-page-layout",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div id="results-page-layout" class="s-results-page-layout">\n    <div class="row s-stable-search-bar-height">\n        <div class="s-search-bar-full-width-container">\n            <div class="col-xs-0 col-sm-12 col-md-2 s-back-button-container">\n                <a href="/" class="back-button btn btn-sm btn-default"> <i class="fa fa-arrow-left"></i> Start New Search</a>\n            </div>\n            <div class="col-xs-12 col-sm-9 col-md-7 s-search-bar-row" id="search-bar-row" data-widget="SearchWidget"></div>\n        </div>\n    </div>\n    <div class="row s-message-control-row" id="message-control-row"><span data-widget="AlertsWidgetx"></span></div>\n    <div class="row s-results-control-row" id="results-control-row">\n    </div>\n    <div class="row">\n        <div class="col-xs-12 s-dynamic-page-body" id="dynamic-page-body">\n            <div class="max-width-wrapper">\n                <div class="row">\n                    <div class="hidden-xs col-sm-3 col-md-2 s-left-column s-results-column" id="results-left-column">\n                        <h2 class="sr-only">Filters for the Current Search</h2>\n                        <div class="left-col-container s-left-col-container">\n                            <div data-widget="AuthorFacet"/>\n                            <div data-widget="DatabaseFacet"/>\n                            <div data-widget="RefereedFacet"/>\n                            <div data-widget="AffiliationFacet"/>\n                            <div data-widget="KeywordFacet"/>\n                            <div data-widget="BibstemFacet"/>\n                            <div data-widget="BibgroupFacet"/>\n                            <div data-widget="ObjectFacet"/>\n                            <div data-widget="NedObjectFacet"/>\n                            <div data-widget="DataFacet"/>\n                            <div data-widget="VizierFacet"/>\n                            <div data-widget="PubtypeFacet"/>\n                        </div>\n                    </div>\n\n                    <div class="col-sm-9 col-md-7  s-results-middle-column s-results-column" id="results-middle-column">\n                        <div class="main-content-container s-main-content-container" id="main-content" tabindex="-1" role="main" aria-label="container for search results and other main content">\n                            <div data-widget="Results"/>\n                            <div data-widget="AuthorAffiliationTool"/>\n                            <div data-widget="ExportWidget" data-origin="results-page"/>\n                            <div data-widget="AuthorNetwork"/>\n                            <div data-widget="PaperNetwork"/>\n                            <div data-widget="Metrics" data-allow-redirect="true"/>\n                            <div data-widget="BubbleChart"/>\n                            <div data-widget="ConceptCloud"/>\n                            <div data-widget="CitationHelper"/>\n                        </div>\n                    </div>\n\n                    <div class="hidden-xs col-sm-3 col-md-3 results-right-column s-right-column s-results-column" id="results-right-column">\n                        <h2 class="sr-only">Additional Functionality (Information about your query, and more search filters)</h2>\n\n                        <div data-widget="QueryInfo"/>\n                        <div data-widget="OrcidSelector"/>\n                        <div data-widget="GraphTabs"/>\n                        <div data-widget="QueryDebugInfo" data-debug="true"/>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n</div>\n'},useData:!0});return t.registerPartial("js/page_managers/templates/results-page-layout",n),n}),define("hbs!js/page_managers/templates/results-control-row",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="s-results-control-row-container">\n    <div class="col-sm-6">\n        <div data-widget="BreadcrumbsWidget" class="s-display-inline-block"/>\n    </div>\n\n\n    <div class="col-sm-6" style="padding-right:0">\n        <div class="s-results-action-buttons">\n            <div class="col-md-6 clearfix" style="margin-bottom:10px;">\n                <div data-widget="Sort" class="s-display-inline-block pull-right"/>\n            </div>\n            <div class="col-md-6">\n                <div data-widget="VisualizationDropdown" class="s-display-inline-block pull-right"/>\n                <div data-widget="ExportDropdown" class="s-display-inline-block pull-right"/>\n            </div>\n        </div>\n    </div>\n\n</div>\n'},useData:!0});return t.registerPartial("js/page_managers/templates/results-control-row",n),n}),define("js/widgets/base/base_widget",["backbone","marionette","js/components/api_query","js/components/api_request","js/mixins/widget_mixin_method","js/components/api_targets","js/mixins/dependon","js/mixins/widget_state_manager"],function(e,t,n,i,a,r,s,o){var l=t.Controller.extend({initialize:function(e){e=e||{},_.bindAll(this,"dispatchRequest","processResponse"),this._currentQuery=new n,this.defaultQueryArguments=this.defaultQueryArguments||{},e.defaultQueryArguments&&(this.defaultQueryArguments=_.extend(this.defaultQueryArguments,e.defaultQueryArguments)),e.view&&(this.view=e.view,this.collection=e.view.collection),this.view&&t.bindEntityEvents(this,this.view,t.getOption(this,"viewEvents")),this.model&&t.bindEntityEvents(this,this.model,t.getOption(this,"modelEvents"))},activate:function(e){this.setBeeHive(e);var t=e.getService("PubSub");t.subscribe(t.INVITING_REQUEST,_.bind(this.dispatchRequest,this)),t.subscribe(t.DELIVERING_RESPONSE,_.bind(this.processResponse,this))},dispatchNewQuery:function(e){_.each(this.defaultQueryArguments,function(t,n){e.unset(n)});var t=this.getPubSub();t.publish(t.NAVIGATE,"search-page",{q:e})},dispatchRequest:function(e){this._dispatchRequest(e)},_dispatchRequest:function(e){var t=this.customizeQuery(e);if(t){var n=this.composeRequest(t);if(n){var i=this.getPubSub();i.publish(i.DELIVERING_REQUEST,n)}}},customizeQuery:function(e){var t=e.clone();return t.unlock(),this.defaultQueryArguments&&(t=this.composeQuery(this.defaultQueryArguments,t)),t},processResponse:function(e){var t=e.getApiQuery();throw this.setCurrentQuery(t),new Error("you need to customize this function")},composeRequest:function(e){return new i({target:r.SEARCH,query:e})},setCurrentQuery:function(e){this._currentQuery=e},getCurrentQuery:function(){var e,t=new n({});try{if(this._currentQuery instanceof n)t=this._currentQuery;else if(_.isFunction(this.getBeeHive)&&(e=this.getBeeHive()).hasObject("AppStorage")){var i=e.getObject("AppStorage").getCurrentQuery();i instanceof n&&(t=i)}}catch(e){console.error(e.message)}finally{return t}},composeQuery:function(e,t){var n;return n=t||(n=this.getCurrentQuery()).clone(),e&&_.each(e,function(e,t){n.has(t)||n.set(t,e)}),n},onDestroy:function(){this.view.destroy()},getEl:function(){return this.view.el&&this.view.$el.children().length?this.view.el:this.view.render().el},render:function(){return this.view.render()},parseIdentifierFromQuery:function(e){if(!e.hasVal("q"))throw"no query";var t=e.get("q")[0];try{if(/^(?:identifier|bibcode):(.*)$/.test(t))return t.split(":")[1]}catch(e){throw"unable to parse bibcode"}throw"query must be in the format of identifer:foo or bibcode:foo"}},{mixin:a});return _.extend(l.prototype,s.BeeHive,o),l}),define("js/page_managers/three_column_view",["underscore","marionette","hbs!js/page_managers/templates/results-page-layout","hbs!js/page_managers/templates/results-control-row","js/widgets/base/base_widget"],function(e,t,n,i){var a=Backbone.Model.extend({defaults:function(){return{left:"open",right:"open",user_left:null,user_right:null}}});return t.ItemView.extend({initialize:function(e){e=e||{};this.widgets=e.widgets,this.model=new a},destroy:function(){t.ItemView.prototype.destroy.call(this,arguments)},template:n,modelEvents:{"change:left":"_updateColumnView","change:right":"_updateColumnView"},events:{"click .btn-expand":"onClickToggleColumns"},onRender:function(){this.$("#results-control-row").append(i()),this.displaySearchBar(this.options.displaySearchBar),this.displayControlRow(this.options.displayControlRow),this.displayLeftColumn(this.options.displayLeftColumn),this.displayRightColumn(this.options.displayRightColumn),this.displayMiddleColumn(this.options.displayMiddleColumn)},onShow:function(){this.displaySearchBar(!0)},displaySearchBar:function(e){$("#search-bar-row").toggle(void 0===e||e)},displayLeftColumn:function(e){this.$(".s-left-col-container").toggle(void 0===e||e)},displayControlRow:function(e){this.$("#results-control-row").toggle(void 0===e||e)},displayRightColumn:function(e){this.$(".s-left-col-container").toggle(void 0===e||e)},displayMiddleColumn:function(e){this.$(".s-left-col-container").toggle(void 0===e||e)},_returnBootstrapClasses:function(){var t=this.classList,n=[];return e.each(t,function(e){-1!==e.indexOf("col-")&&n.push(e)}),n.join(" ")},showCols:function(e){e=e||{left:!0,right:!0,force:!1};for(var t=["left","right"],n=0;n<t.length;n++){var i=t[n];if(i in e)null===this.model.get("user_"+i)?this.model.set(i,e[i]?"open":"closed"):e.force&&(this.model.set(i,e[i]?"open":"closed"),this.model.set("user_"+i,null))}},_updateColumnView:function(){var t,n,i,a,r;t=this.model.get("left"),n=this.model.get("right"),i=this.$("#results-left-column"),a=this.$("#results-right-column"),r=this.$("#results-middle-column"),e.each([["left",t,i],["right",n,a]],function(e){if("open"==e[1]){e[2].removeClass("hidden");var t=e[2];setTimeout(function(){t.children().show(0)},200)}else e[2].addClass("hidden")}),"open"===t&&"open"===n?r.removeClass(this._returnBootstrapClasses).addClass("col-sm-9 col-md-7"):"closed"===t&&"closed"===n&&r.removeClass(this._returnBootstrapClasses).addClass("col-md-12 col-sm-12")}})}),define("js/page_managers/view_mixin",["underscore","jquery"],function(e,t){return{getWidgetsFromTemplate:function(n,i){var a={},r=t(n).find("[data-widget]");return r.length>0&&e.each(r,function(e){var t=e.getAttribute("data-widget"),n=e.getAttribute("data-debug");n&&"true"==n&&!n||(a[t]=e)}),a}}}),define("js/page_managers/controller",["jquery","underscore","marionette","hbs!js/page_managers/templates/results-page-layout","hbs!js/page_managers/templates/results-control-row","js/widgets/base/base_widget","./three_column_view","./view_mixin","js/mixins/dependon"],function(e,t,n,i,a,r,s,o,l){var c=["ShowAbstract"],u=r.extend({initialize:function(e){this.widgets={},this.widgetDoms={},this.initialized=!1,this.widgetId=null,this.assembled=!1,t.extend(this,t.pick(e,["debug","widgetId"]))},activate:function(e){this.setBeeHive(e),this.debug=e.getDebug(),this.view=this.createView({debug:this.debug,widgets:this.widgets})},setWidgetId:function(e){this.widgetId=e},createView:function(e){return new s(e)},assemble:function(n){var i=e.Deferred();if(this.assembled)return i.resolve(this.view.el),i.promise();this.assembled=!0,this.view.render();var a,r=this;t.extend(r.widgetDoms,r.getWidgetsFromTemplate(r.view.$el));var s=[],o={};return t.each(r.widgetDoms,function(i,l){if(!n.hasWidget(l))return delete r.widgetDoms[l],void delete r.widgets[l];var u=n._getWidget(l).done(function(s){if(r.persistentWidgets&&r.persistentWidgets.indexOf(l)>-1&&n.incrRefCount("widget",l),s){var u=function(){t.assign(s,{componentParams:e(i).data()});var n=e('*[data-widget="'+l+'"]'),r=n.length>0?n.html().trim():"";window.__PRERENDERED&&s.view&&c.indexOf(l)>-1&&n.length>0&&r.length>0?("function"==typeof s.view.handlePrerenderedContent&&s.view.handlePrerenderedContent(r,n),window.__PRERENDERED=!1):(a=s.getEl?s.getEl():s.render().el,o[l]=a)};s.assemble?s.assemble(n).done(u):u(),r.widgets[l]=s}});s.push(u)},this),e.when.apply(e,s).then(function(){t.forEach(o,function(t,n){e(r.widgetDoms[n]).html(t)}),i.resolve()}).fail(function(){console.error("Generic error - we were not successul in assembling page"),arguments.length&&console.error(arguments),i.reject()}),i.promise()},disAssemble:function(n){t.each(t.keys(this.widgets),function(t){var i=this.widgets[t];i.disAssemble&&i.disAssemble(),n.returnWidget(t),n._isBarbarianAlive("widget:"+t)?e(this.widgetDoms[t]).detach():e(this.widgetDoms[t]).empty(),delete this.widgets[t],delete this.widgetDoms[t]},this),this.assembled=!1},show:function(e){var n=this;if(e){this.hideAll();var i=[].slice.apply(arguments);t.each(i,function(e){if(n.widgets[e]){var i=n.widgets[e],a=n.view.$el.find('[data-widget="'+e+'"]');if(a.length){var r=a.data("debug");if(void 0!==r&&r&&!n.debug)return;a.append(i.el?i.el:i.view.el),t.assign(i,{componentParams:a.data()});try{n.widgets[e].triggerMethod("show")}catch(t){console.error("Error when displaying widget: "+e,t.message,t.stack)}}else console.warn("Cannot insert widget: "+e+' (no selector [data-widget="'+e+'"])')}else n.debug&&console.error("Cannot show widget: "+e+"(because, frankly... there is no such widget there!)")})}else this.showAll();return this.triggerMethod("show"),this.view},hideAll:function(){return t.each(this.widgets,function(e){e.noDetach||("detach"in e&&t.isFunction(e.detach)?e.detach():e.view&&e.view.$el?e.view.$el.detach():e.$el&&e.$el.detach())}),this.view},showAll:function(){var e=this;return t.each(t.keys(e.widgets),function(n){var i=e.widgets[n],a=e.view.$el.find('[data-widget="'+n+'"]');a.append(i.el?i.el:i.view.el),t.assign(i,{componentParams:a.data()}),e.widgets[n].triggerMethod("show")}),this.view},broadcast:function(){var e=arguments;t.each(this.widgets,function(t,n){t.trigger.apply(t,e)},this)}});return t.extend(u.prototype,o,l.BeeHive,{getPubSub:function(){return this._ps&&this.hasPubSub()?this._ps:(this._ps=this.getBeeHive().getHardenedInstance().getService("PubSub"),this._ps)}}),u}),define("hbs!js/page_managers/templates/aria-announcement",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){return'<a href="#main-content" id="skip-to-main-content" class="sr-only sr-only-focusable">Skip to main content</a>\n'},3:function(e,t,n,i){return'<a href="#main-content"  id="skip-to-main-content" class="sr-only sr-only-focusable">Skip to main content</a>\n'},5:function(e,t,n,i){return"    home page\n"},7:function(e,t,n,i){return"    search results page\n"},9:function(e,t,n,i){return"    article abstract page\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a;return(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.page:e,"SearchPage",{name:"compare",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?a:"")+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.page:e,"DetailsPage",{name:"compare",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?a:"")+'\n<div id="aria-announcement-container">\n    Now on\n'+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.page:e,"LandingPage",{name:"compare",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?a:"")+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.page:e,"SearchPage",{name:"compare",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?a:"")+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.page:e,"DetailsPage",{name:"compare",hash:{},fn:this.program(9,i,0),inverse:this.noop,data:i}))?a:"")+"\n</div>\n"},useData:!0});return t.registerPartial("js/page_managers/templates/aria-announcement",n),n}),define("hbs!js/page_managers/templates/master-page-manager",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div id="navbar-container">\n  <div data-widget="NavbarWidget"/>\n</div>\n\n<div id="alerts-container">\n  <div data-widget="AlertsWidget"/>\n</div>\n\n<div id="content-container">\n  <div class="dynamic-container s-dynamic-container"></div>\n</div>\n\n<div id="footer-container">\n  <div data-widget="FooterWidget"/>\n</div>\n'},useData:!0});return t.registerPartial("js/page_managers/templates/master-page-manager",n),n}),define("js/page_managers/master",["js/widgets/base/base_widget","js/components/generic_module","js/page_managers/controller","hbs!js/page_managers/templates/aria-announcement","hbs!js/page_managers/templates/master-page-manager","marionette","js/mixins/dependon"],function(e,t,n,i,a,r,s){var o=Backbone.Model.extend({defaults:function(){return{id:void 0,isSelected:!1,object:void 0,options:void 0}}}),l=Backbone.Collection.extend({model:o,selectOne:function(e){var t=null;this.each(function(n){n.id==e?t=n:n.set("isSelected",!1,{silent:!0})}),t.set("isSelected",!0)}}),c=Backbone.Model.extend({defaults:function(){return{name:void 0,numCalled:0,numAttached:0,ariaAnnouncement:void 0}}}),u=r.ItemView.extend({className:"s-master-page-manager",constructor:function(e){(e=e||{}).collection||(e.collection=new l),e.model||(e.model=new c),e.template=a,r.ItemView.prototype.constructor.call(this,e)},changeManager:function(){var e=this.collection.findWhere({isSelected:!0}),t=e.attributes.object.show.apply(e.attributes.object,e.attributes.options);this.$(".dynamic-container").children().detach(),this.$(".dynamic-container").append(t.$el),e.attributes.numAttach+=1,document.body.scrollTop=document.documentElement.scrollTop=0,$("#app-container").scrollTop(0),$(".s-search-bar-full-width-container").removeClass("s-search-bar-motion"),$(".s-quick-add").removeClass("hidden")},changeWithinManager:function(){var e=this.collection.findWhere({isSelected:!0});e.attributes.object.show.apply(e.attributes.object,e.attributes.options),e.attributes.numAttach+=1}}),h=n.extend({initialize:function(e){e=e||{},this.view=new u(e),this.collection=this.view.collection,this.model=this.view.model,n.prototype.initialize.apply(this,arguments)},activate:function(e){this.setBeeHive(e);var t=this.getPubSub();t.subscribe(t.ARIA_ANNOUNCEMENT,this.handleAriaAnnouncement)},assemble:function(e){return this.setApp(e),n.prototype.assemble.call(this,e)},show:function(e,t,n){var i=$.Deferred(),a=this.getApp();this.collection.find({id:e})||this.collection.add({id:e});var r=this.collection.find({id:e}),s=this,o=function(a){r.get("isSelected")?(r.set({options:t,object:a}),s.view.changeWithinManager()):(r.set({options:t,object:a}),s.collection.selectOne(e),s.view.changeManager()),n&&a.provideContext&&a.provideContext.call(a,n);var o=s.currentChild;if(s.currentChild=e,o&&o!=e){var l=s.collection.find({id:o});l&&l.get("object")&&l.set("numDetach",l.get("numDetach")+1)}s.getPubSub().publish(s.getPubSub().ARIA_ANNOUNCEMENT,e),i.resolve()};return r.get("object")?(o(r.get("object")),i.promise()):(a._getWidget(e).done(function(t){r.set("object",t),t||console.error("unable to find page manager: "+e),t.assemble?t.assemble(a).done(function(){o(t)}):(console.error("eeeek, "+e+" has no assemble() method!"),i.reject())}),i.promise())},getCurrentActiveChild:function(){return this.collection.get(this.currentChild).get("object")},disAssemble:function(){_.each(this.collection.models,function(e){if(e.attributes.isSelected){var t=e.get("object");if(t.disAssemble)t.disAssemble(this.getApp());else{if(!t.destroy)throw new Error("Contract breach, no way to get ridd of the widget/page manager");t.destroy()}}e.set({isSelected:!1,object:null}),this.assembled=!1},this)},handleAriaAnnouncement:function(e){$("a#skip-to-main-content").remove(),$("div#aria-announcement-container").remove(),$("#app-container").before(i({page:e}))}});return _.extend(h.prototype,s.App),h}),define("js/page_managers/one_column_view",["marionette","js/widgets/base/base_widget"],function(e){return e.ItemView.extend({initialize:function(e){e=e||{};this.widgets=e.widgets},onRender:function(){}})}),define("js/page_managers/toc_widget",["backbone","marionette"],function(e,t){var n=e.Model.extend({defaults:function(){var e;return _defineProperty(e={id:void 0,path:void 0,title:void 0,showCount:!1,category:void 0,isActive:!1,isSelected:!1,numFound:0},"showCount",!0),_defineProperty(e,"alwaysThere",!1),e}}),i=e.Collection.extend({model:n,initialize:function(){this.on("change:isSelected",function(e){e.get("isSelected")&&this.trigger("widget-selected",e)})},selectOne:function(e){var t=null;this.each(function(n){n.id==e?t=n:n.set("isSelected",!1,{silent:!0})}),(t=t||this.first()).set("isSelected",!0)},comparator:function(e){return e.get("order")}}),a=e.Model.extend({defaults:function(){return{bibcode:void 0,query:void 0,path:void 0,idAttribute:void 0}}});return t.ItemView.extend({initialize:function(e){e=e||{},this.collection=e.collection||new i,this.model=e.model||new a,this.on("page-manager-message",this.onPageManagerMessage),this.listenTo(this.collection,"widget-selected",function(e){var t=e.get("id").split("__");this.model.set({path:e.get("path"),idAttribute:t[0],subView:t.length>1?t[1]:void 0}),this.triggerSelection()}),e.template||(this.template=function(){return""})},noDetach:!0,serializeData:function(){var e,t=this.model.toJSON(),n=this.collection.toJSON();return _.find(n,function(e){return void 0!==e.category})?(e=_.groupBy(this.collection.toJSON(),function(e){return e.category}),t=_.extend(t,e)):t=_.extend(t,{tabs:n}),t},events:{"click a":"navigateToPage"},navigateToPage:function(e){var t=$(e.currentTarget),n=t.attr("data-widget-id"),i={idAttribute:n};return!t.find("div").hasClass("s-nav-inactive")&&(n!==this.$(".s-nav-selected").attr("data-widget-id")&&(i.href=t.attr("href"),this.collection.selectOne(n),this.$el.parent(".nav-container").removeClass("show"),$("button.toggle-menu").html(' <i class="fa fa-bars"></i> Show Menu')),!1)},modelEvents:{"change:bibcode":"resetActiveStates",change:"render"},collectionEvents:{add:"render","change:isActive":"render","change:isSelected":"render","change:numFound":"render"},resetActiveStates:function(){var e=this.model.get("path");this.collection.each(function(t){t.set({isSelected:e===t.get("path"),isActive:!0,numFound:0})}),this.triggerSelection()},triggerSelection:function(){if(0===this.collection.where({isSelected:!0}).length)return this.collection.selectOne("ShowAbstract");var e=this.model.get("path")||"abstract",t=encodeURIComponent(this.model.get("bibcode")),n={idAttribute:this.model.get("idAttribute")||"showAbstract",subView:this.model.get("subView")||"",href:"abs/"+(t||"")+"/"+e,bibcode:this.model.get("bibcode")};this.trigger("page-manager-event","widget-selected",n)},selectDefaultNavItem:function(){var e=t.getOption(this,"navConfig"),n=e[0];_.each(e,function(e,t){if(e.isSelected)return n=t,!1}),this.collection.selectOne(n)},onPageManagerMessage:function(e,n){if("new-widget"==e){var i=arguments[1],a=t.getOption(this,"navConfig"),r=a[i];if(r){var s=_.extend(_.clone(r),{id:i});this.collection.add(s)}else{var o=_.pick(a,function(e,t){return t.split("__")&&t.split("__")[0]==i});_.each(o,function(e,t){var n=_.extend(_.clone(e),{id:t});this.collection.add(n)},this)}}else if("widget-ready"==e){if(n.noDocs)return this.selectDefaultNavItem();var l=this.collection.get(n.widgetId);_.defaults(n,{isActive:!!n.numFound}),l&&l.set(_.pick(n,l.keys())),n.shouldReset&&(l&&l.get("isSelected")&&this.selectDefaultNavItem(),l&&l.set("isActive",!1))}else"broadcast-payload"===e&&this.model.set("bibcode",n.bibcode)}})}),define("js/page_managers/toc_controller",["underscore","marionette","./controller","./toc_widget","analytics"],function(e,t,n,i,a){return n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments),window.__BUMBLEBEE_TESTING_MODE__||(this.onWidgetSelected=e.debounce(e.bind(this.onWidgetSelected,this),100))},createView:function(t){return this.pageConfig?new this.pageConfig.view(e.extend(t,{template:this.pageConfig.template})):n.prototype.createView.call(this,t)},assemble:function(a){var r=$.Deferred();if(!this.navConfig)return r.reject(new Error("TOC widget is being assembled without navigation configuration (navConfig)")),r.promise();if(this.assembled)return r.resolve(),r.promise();var s=this;return n.prototype.assemble.apply(this,arguments).done(function(){var n=t.getOption(s,"TOCTemplate");s.TOCEvents?s.widgets.tocWidget=new i({template:n,events:t.getOption(s,"TOCEvents"),navConfig:t.getOption(s,"navConfig")}):s.widgets.tocWidget=new i({template:n,navConfig:t.getOption(s,"navConfig")}),s.view.$(".nav-container").append(s.widgets.tocWidget.render().el),e.each(e.keys(s.widgets),function(t){s.listenTo(this.widgets[t],"page-manager-event",e.bind(this.onPageManagerEvent,this,this.widgets[t])),s.broadcast("page-manager-message","new-widget",t)},s),r.resolve()}),r.promise()},onPageManagerEvent:function(t,n,i){i=i||{};var a=null,r=null;t&&e.each(e.pairs(this.widgets),function(e){e[1]===t&&(r=e[0],a=e[1])}),"widget-ready"==n&&null!==a?(i.widgetId=r,this.broadcast("page-manager-message",n,i)):"widget-selected"==n?this.onWidgetSelected.apply(this,arguments):"broadcast-payload"==n?this.broadcast("page-manager-message",n,i):"navigate"==n?this.getPubSub().publish(this.getPubSub().NAVIGATE,i.navCommand,i.sub):"apply-function"==n&&i.func.apply(this)},onWidgetSelected:function(e,t,n){var i=e.model.get("bibcode"),r=n.idAttribute.toLowerCase().replace("show","");a("send","event","interaction","toc-link-followed",{target:r,bibcode:i}),this.broadcast("page-manager-message","widget-selected",n),this.getPubSub().publish(this.getPubSub().NAVIGATE,n.idAttribute,n)},onPageManagerMessage:e.noop,setActive:function(e,t){t&&this.widgets[e].setSubView instanceof Function&&this.widgets[e].setSubView(t),t&&(e=e+"__"+t),this.widgets.tocWidget.collection.selectOne(e)},onDestroy:function(){this.stopListening(),this.widgets={},this.view.destroy()}})}),define("js/services/api",["underscore","jquery","js/components/generic_module","js/components/api_request","js/mixins/dependon","js/components/api_response","js/components/api_query","js/components/api_feedback","js/mixins/hardened","js/mixins/api_access","moment"],function(e,t,n,i,a,r,s,o,l,c,u){var h=n.extend({url:"/api/1/",clientVersion:null,outstandingRequests:0,access_token:null,refresh_token:null,expire_in:null,defaultTimeoutInMs:6e4,activate:function(e){this.setBeeHive(e)},done:function(e,t,n){var i=new r(e);i.setApiQuery(this.request.get("query")),this.api.trigger("api-response",i)},fail:function(e,t,n){console.error("API call failed:",JSON.stringify(this.request.url()),e.status,n);var i=this.api.hasBeeHive()?this.api.getPubSub():null;if(i){var a=new o({code:o.CODES.API_REQUEST_ERROR,msg:t,request:this.request,error:e,psk:this.key||this.api.getPubSub().getCurrentPubSubKey(),errorThrown:n,text:t,beVerbose:!0});i.publish(i.FEEDBACK,a)}else this.api&&this.api.trigger("api-error",this,e,t,n)},initialize:function(){this.always=e.bind(function(){this.outstandingRequests--},this)},getNumOutstandingRequests:function(){return this.outstandingRequests},setVals:function(t){e.each(t,function(e,t){this[t]=e},this)},modifyRequestOptions:function(e){},hardenedInterface:{request:"make a request to the API",setVals:"set a value on API (such as new access token)"}});return h.prototype._request=function(n,i){var a;i=e.extend({},i,n.get("options"));var r=this,o=n.get("query");if(o&&!(o instanceof s))throw Error("Api.query must be instance of ApiQuery");o&&(a="application/json"===i.contentType?JSON.stringify(o.toJSON()):o.url());var l,c=n.get("target")||"";if(!(l=(l=c.indexOf("http")>-1?c:this.url+(c.length>0&&0==c.indexOf("/")?c:c?"/"+c:c)).substring(0,this.url.length-2)+l.substring(this.url.length-2,l.length).replace("//","/")))throw Error("Sorry, you can't use api without url");var u={type:"GET",url:l,dataType:"json",data:a,contentType:"application/x-www-form-urlencoded",context:{request:n,api:r},timeout:this.defaultTimeoutInMs,headers:{},cache:!0};if(i.timeout&&(u.timeout=i.timeout),this.clientVersion&&(u.headers["X-BB-Api-Client-Version"]=this.clientVersion),this.access_token&&(u.headers.Authorization=this.access_token,/accounts\/bootstrap/i.test(c)&&(u.headers.Authorization="")),e.extend(u.headers,i.headers),e.extend(u,e.omit(i,"headers")),this.outstandingRequests++,this.modifyRequestOptions(u,n),i.useFetch&&i.fetchOptions){var h=e.assign({credentials:"include",mode:"cors",timeout:this.defaultTimeoutInMs},i.fetchOptions);h.headers=e.assign({"Content-Type":u.contentType},u.headers,i.fetchOptions.headers);var d=window.fetch(u.url,h).then(function(t){if(r.always.call(u.context,t),e.isFunction(u.always)&&u.always.call(u.context,t),!t.ok)throw(u.fail||r.fail).call(u.context,t),Error(t.statusText);(u.done||r.done).call(u.context,t)}).catch(function(e){throw(u.fail||r.fail).call(u.context,e),Error(e)});return e.extend(d,{done:d.then,fail:d.catch})}var p=t.ajax(u).always(u.always?[this.always,u.always]:this.always).done(u.done||this.done).fail(u.fail||this.fail);return p=p.promise(p)},h.prototype.getCurrentUTCMoment=function(){return u().utc()},h.prototype.request=function(n,i){var a=this,r=3,s=function s(){var o=t.Deferred(),l=a.getApiAccess({tokenRefresh:!0,reconnect:!0});return l.done(function(){o.resolve(a._request(n,i))}),l.fail(function(){--r>0?e.delay(s,1e3):o.reject.apply(o,arguments)}),o.promise()};if(!this.expire_in)return s();var o=u.utc(this.expire_in);return this.getCurrentUTCMoment().diff(o,"minutes")>-2?s():a._request(n,i)},e.extend(h.prototype,a.BeeHive,l,c),h}),define("js/services/default_pubsub",["backbone","underscore","js/components/generic_module","js/components/pubsub_key"],function(e,t,n,i){var a=/\s+/;return n.extend({className:"PubSub",initialize:function(e){this._issuedKeys={},this.strict=!0,this.handleErrors=!0,this._errors={},this.errWarningCount=10,t.extend(this,t.pick(e,["strict","handleErrors","errWarningCount"])),this.pubSubKey=i.newInstance({creator:{}}),this._issuedKeys[this.pubSubKey.getId()]=this.pubSubKey.getCreator(),this.running=!0,this.debug=!1},start:function(){this.publish(this.pubSubKey,this.OPENING_GATES),this.publish(this.pubSubKey,this.OPEN_FOR_BUSINESS),this.running=!0},destroy:function(){this.publish(this.pubSubKey,this.CLOSING_GATES),this.off(),this.publish(this.pubSubKey,this.CLOSED_FOR_BUSINESS),this.running=!1,this._issuedKeys={}},subscribe:function(e,n,i){if(!this.isRunning())throw new Error("PubSub has been closed, ignoring futher requests");if(this._checkKey(e,n,i),t.isUndefined(n))throw new Error("You tried to subscribe to undefined event. Error between chair and keyboard?");this.on(n,i,e),-1==n.indexOf(e.getId())&&this.on(n+e.getId(),i,e)},subscribeOnce:function(e,n,i){if(this._checkKey(e,n,i),t.isUndefined(n))throw new Error("You tried to subscribe to undefined event. Error between chair and keyboard?");this.once(n,i,e),-1==n.indexOf(e.getId())&&this.once(n+e.getId(),i,e)},unsubscribe:function(e,n,i){this._checkKey(e,n,i);var a=e;if(n&&i)this.off(n,i,a),this.off(n+e.getId(),i,a);else if(n||i)this.off(n,i,a),this.off(n+e.getId(),i,a);else{var r,s,o,l,c,u,h=t.keys(this._events),d=[];for(o=0,l=h.length;o<l;o++)if(n=h[o],r=this._events[n])for(u=0,c=r.length;u<c;u++)(s=r[u]).context===a&&d.push({name:n,event:s});t.each(d,function(e){this.off(e.name,e.event.callback,e.event.context)},this)}},publish:function(){if(this.isRunning()){this._checkKey(arguments[0]);var e=Array.prototype.slice.call(arguments,1);if(0==e.length||t.isUndefined(e[0]))throw new Error("You tried to trigger undefined event. Error between chair and keyboard?");return e.push(arguments[0]),this.handleErrors?this.triggerHandleErrors.apply(this,e):this.trigger.apply(this,e)}console.error("PubSub has been closed, ignoring futher requests")},getCurrentPubSubKey:function(){return this.pubSubKey},getPubSubKey:function(){var e=i.newInstance({creator:this.pubSubKey});if(this.strict){if(this._issuedKeys[e.getId()])throw Error("The key with id",e.getId(),"has been already registered!");this._issuedKeys[e.getId()]=e.getCreator()}return e},isStrict:function(){return this.strict},_checkKey:function(e,n,a){if(this.strict){if(t.isUndefined(e))throw new Error("Every request must be accompanied by PubSubKey");if(!(e instanceof i))throw new Error("Key must be instance of PubSubKey. (If you are trying to pass context, you can't do that. Instead, wrap your callback into: _.bind(callback, context))\nPerhaps the PubSub you are using is the non-protected version?");if(!this._issuedKeys.hasOwnProperty(e.getId()))throw new Error("Your key is not known to us, sorry, you can't use this queue.");if(this._issuedKeys[e.getId()]!==e.getCreator())throw new Error("Your key has wrong identity, sorry, you can't use this queue.")}},triggerHandleErrors:function(e){if(!this._events)return this;var t=Array.prototype.slice.call(arguments,1);if(!function(e,t,n,i){if(!n)return!0;if("object"===_typeof(n)){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(a.test(n)){for(var s=n.split(a),o=0,l=s.length;o<l;o++)e[t].apply(e,[s[o]].concat(i));return!1}return!0}(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&this.triggerEvents(n,t),i&&this.triggerEvents(i,arguments),this},triggerEvents:function(e,t){var n,i=-1,a=e.length,r=t[0],s=t[1],o=t[2];switch(t.length){case 0:for(;++i<a;)try{(n=e[i]).callback.call(n.ctx)}catch(e){this.handleCallbackError(e,n,t)}return;case 1:for(;++i<a;)try{(n=e[i]).callback.call(n.ctx,r)}catch(e){this.handleCallbackError(e,n,t)}return;case 2:for(;++i<a;)try{(n=e[i]).callback.call(n.ctx,r,s)}catch(e){this.handleCallbackError(e,n,t)}return;case 3:for(;++i<a;)try{(n=e[i]).callback.call(n.ctx,r,s,o)}catch(e){this.handleCallbackError(e,n,t)}return;default:for(;++i<a;)try{(n=e[i]).callback.apply(n.ctx,t)}catch(e){this.handleCallbackError(e,n,t)}}},handleCallbackError:function(e,t,n){if(console.warn("[PubSub] Error: ",t,n,e.message,e.stack),this.debug)throw e;console.warn(e.stack);var i=t.ctx.getId(),a=this._errors[i]=(this._errors[i]||0)+1;a%this.errWarningCount==0&&this.publish(this.pubSubKey,this.BIG_FIRE,a,e,t,n)},isRunning:function(){return this.running}})}),define("js/services/pubsub",["backbone","underscore","js/mixins/hardened","pubsub_service_impl","js/components/pubsub_events"],function(e,t,n,i,a){var r=i.extend({hardenedInterface:{subscribe:"register callback",unsubscribe:"deregister callback",publish:"send data to the queue",getPubSubKey:"get secret key"}});return t.extend(r.prototype,n,{getHardenedInstance:function(e){e=t.clone(e||this.hardenedInterface);var n={key:this.getPubSubKey()},i=this;e.publish=function(){i.publish.apply(i,[n.key].concat(t.toArray(arguments)))},e.subscribe=function(){i.subscribe.apply(i,[n.key].concat(t.toArray(arguments)))},e.unsubscribe=function(){i.unsubscribe.apply(i,[n.key].concat(t.toArray(arguments)))},e.subscribeOnce=function(){i.subscribeOnce.apply(i,[n.key].concat(t.toArray(arguments)))},e.getCurrentPubSubKey=function(){return n.key};var r=this._getHardenedInstance(e,this);return t.extend(r,a),r}}),t.extend(r.prototype,a),r}),define("js/services/storage",["underscore","js/components/persistent_storage"],function(e,t){var n=t.extend({activate:function(e){},onAppBootstrapped:function(){var e=this.getBeeHive().getObject("DynamicConfig");if(!e)throw new Error("DynamicConfig is missing");var t=e.namespace;t||(console.warn("Application namespace not set; persistent storage will be created without it"),t=""),this._store=this._createStore(t)}});return function(){return new n({name:"storage-service"})}}),define("hbs!js/widgets/alerts/templates/modal_template",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){return'                    <i class="icon-danger fa-2x"></i>\n'},3:function(e,t,n,i){return'                    <i class="icon-success fa-2x"></i>\n'},5:function(e,t,n,i){return""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,r;return'\n\x3c!--html for modal alerts--\x3e\n\n<div class="modal-dialog '+this.escapeExpression("function"==typeof(r=null!=(r=t.type||(null!=e?e.type:e))?r:t.helperMissing)?r.call(e,{name:"type",hash:{},data:i}):r)+'">\n        <div class="modal-content" id="modal-alert-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n\n                <h4 class="modal-title" id="alert-modal-label">\n'+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.type:e,"danger",{name:"compare",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?a:"")+"\n"+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.type:e,"success",{name:"compare",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?a:"")+"\n"+(null!=(a=(t.compare||e&&e.compare||t.helperMissing).call(e,null!=e?e.type:e,"warning",{name:"compare",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?a:"")+"\n                    "+this.escapeExpression("function"==typeof(r=null!=(r=t.title||(null!=e?e.title:e))?r:t.helperMissing)?r.call(e,{name:"title",hash:{},data:i}):r)+'\n\n                </h4>\n            </div>\n            <div class="modal-body">\n                '+(null!=(a="function"==typeof(r=null!=(r=t.msg||(null!=e?e.msg:e))?r:t.helperMissing)?r.call(e,{name:"msg",hash:{},data:i}):r)?a:"")+'\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>\n            </div>\n        </div>\n    </div>\n'},useData:!0});return t.registerPartial("js/widgets/alerts/templates/modal_template",n),n}),define("js/widgets/alerts/modal_view",["marionette","hbs!js/widgets/alerts/templates/modal_template"],function(e,t){return e.ItemView.extend({id:"#alert-modal-content",template:t,showModal:function(){$("#alert-modal").modal("show")},closeModal:function(){$("#alert-modal").modal("hide")},modelEvents:{change:"render"},render:function(){if($("#modal-alert-content").length||($("body").append('<div class="modal fade" id="alert-modal" tabindex="-1" role="dialog" aria-labelledby="alert-modal-label" aria-hidden="true"></div>'),this.setElement($("#alert-modal")[0])),this.model.get("modal"))return"danger"===this.model.get("type")&&console.error("error feedback: ",this.model.get("title"),this.model.get("msg")),e.ItemView.prototype.render.apply(this,arguments)},onRender:function(){this.showModal()}})}),define("hbs!js/widgets/alerts/templates/page_top_alert",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var a,r;return'    <div class="alert alert-'+this.escapeExpression("function"==typeof(r=null!=(r=t.type||(null!=e?e.type:e))?r:t.helperMissing)?r.call(e,{name:"type",hash:{},data:i}):r)+'" id="page-top-alert">\n        <div>\n            '+(null!=(a="function"==typeof(r=null!=(r=t.msg||(null!=e?e.msg:e))?r:t.helperMissing)?r.call(e,{name:"msg",hash:{},data:i}):r)?a:"")+'\n        </div>\n        <div>\n            <button type="button" class="close"><span aria-hidden="true"><i class="fa fa-2x fa-times"></i></span><span class="sr-only">Close</span></button>\n        </div>\n    </div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a;return null!=(a=t.if.call(e,null!=e?e.msg:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?a:""},useData:!0});return t.registerPartial("js/widgets/alerts/templates/page_top_alert",n),n}),define("js/widgets/alerts/page_top_alert",["marionette","hbs!js/widgets/alerts/templates/page_top_alert"],function(e,t){return e.ItemView.extend({tagName:"span",className:"alert-banner",template:t,modelEvents:{change:"render"},events:{"click #page-top-alert button.close":"close"},close:function(){this.$(".alert").css("display","none")},render:function(){return this.model.get("modal")?this:this.model.get("msg")||this.model.get("title")?e.ItemView.prototype.render.apply(this,arguments):(this.$el.html(""),this)}})}),define("js/widgets/alerts/widget",["marionette","js/widgets/base/base_widget","js/components/api_query","js/components/api_feedback","js/components/alerts","./modal_view","./page_top_alert","jquery","jquery-ui","bootstrap"],function(e,t,n,i,a,r,s,o,l,c){var u=Backbone.Model.extend({defaults:{type:"info",msg:void 0,title:void 0,events:void 0,modal:!1}});function h(){var e=this,t=this.model.get("events"),n=/^(\S+)\s*(.*)$/;this.$el&&this.$el.off(".customEvents"+this.mid),t&&_.each(t,function(t,i){var a=i.match(n),r=a[1],s=a[2],o=i,l=function(e){var t=this.model.get("promise"),n=this.model.get("events");return n[o]?t.resolve(n[o]):t.resolve(o),this.model.get("modal")||this.model.set("msg",null),!1};l=_.bind(l,e),r+=".customEvents"+this.mid,""===s?e.$el.on(r,l):e.$el.on(r,s,l)})}var d=r.prototype.onRender;r.prototype.onRender=function(){h.apply(this,arguments),d&&d.apply(this,arguments)};var p=s.prototype.onRender;return s.prototype.onRender=function(){h.apply(this,arguments),p&&p.apply(this,arguments)},t.extend({initialize:function(e){this.model=new u,this.view=new s({model:this.model}),this.modalView=new r({model:this.model}),t.prototype.initialize.apply(this,arguments)},activate:function(e){this.setBeeHive(e);var t=this.getPubSub();t.subscribe(t.NAVIGATE,this.modalView.closeModal)},alert:function(e){var t=o.Deferred();return this.model.set({msg:e.msg,events:e.events,title:e.title,type:e.type||"info",modal:e.modal,promise:t}),t.promise()},closeView:function(){this.view.close(),this.modalView.closeModal()}})}),define("hbs!js/widgets/classic_form/form",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<form action="#classic-form">\n  <div class="pull-right">\n    <button\n      style="position: relative;top: -13px;"\n      class="btn btn-primary"\n      type="submit"\n    >\n      <i class="fa fa-search"></i> Search\n    </button>\n  </div>\n\n  <div data-field="database">\n    <b>Limit query to: </b>&nbsp;<label>\n      <input type="checkbox" checked="true" name="astronomy" />\n      Astronomy </label\n    >&nbsp;&nbsp;\n    <label> <input type="checkbox" name="physics" /> Physics </label\n    >&nbsp;&nbsp;\n    <label> <input type="checkbox" name="general" /> General </label>\n  </div>\n  <div class="clearfix">\n    <div class="col-sm-6" data-field="author" data-textInput="true">\n      <div class="classic-form__logic-group logic-group">\n        <label>\n          <input type="radio" name="author-logic" value="AND" checked="true" />\n          and\n        </label>\n        <label>\n          <input type="radio" name="author-logic" value="OR" /> or\n        </label>\n      </div>\n      <div>\n        <label class="classic-author-label" for="#classic-author">Author</label>\n        <textarea\n          id="classic-author"\n          name="author-names"\n          cols="30"\n          rows="2"\n          placeholder="(Last, First M) one per line"\n          aria-label="author names"\n        ></textarea>\n      </div>\n    </div>\n    <div class="col-sm-6" data-field="object" data-textInput="true">\n      <div class="pull-right-sm">\n        <div class="classic-form__logic-group logic-group">\n          <label>\n            <input\n              type="radio"\n              name="object-logic"\n              value="AND"\n              checked="true"\n            />\n            and\n          </label>\n          <label>\n            <input type="radio" name="object-logic" value="OR" /> or\n          </label>\n        </div>\n        <div>\n          <label class="classic-object-label" for="#classic-object"\n            >Object</label\n          >\n          <textarea\n            id="classic-object"\n            name="object-names"\n            cols="30"\n            rows="2"\n            placeholder="SIMBAD object search (one per line)"\n            aria-label="SIMBAD object search"\n          ></textarea>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div data-field="date">\n    <div>\n      <b>Publication date</b> between <br />\n      <input\n        class="form-control  date-control"\n        maxlength="2"\n        placeholder="MM"\n        type="text"\n        value=""\n        name="month_from"\n        style="margin-top:6px"\n        aria-label="start publication month"\n      />/\n      <input\n        class="form-control  date-control"\n        maxlength="4"\n        placeholder="YYYY"\n        type="text"\n        value=""\n        name="year_from"\n        aria-label="start publication year"\n      />and\n      <input\n        class="form-control  date-control"\n        maxlength="2"\n        placeholder="MM"\n        type="text"\n        value=""\n        name="month_to"\n        aria-label="end publication month"\n      />/\n      <input\n        class="form-control  date-control"\n        maxlength="4"\n        placeholder="YYYY"\n        type="text"\n        value=""\n        name="year_to"\n        aria-label="end publication year"\n      />\n    </div>\n  </div>\n  <div data-field="title" data-textInput="true">\n    <div class="classic-form__logic-group logic-group pull-right">\n      <label>\n        <input type="radio" name="title-logic" value="AND" checked="true" /> and\n      </label>\n      <label> <input type="radio" name="title-logic" value="OR" /> or </label>\n      <label>\n        <input type="radio" name="title-logic" value="BOOLEAN" /> boolean\n      </label>\n    </div>\n    <div>\n      <label for="#classic_title_input"> Title</label>\n      <input\n        id="classic_title_input"\n        class="form-control"\n        name="title"\n        type="text"\n        aria-label="title"\n      />\n    </div>\n  </div>\n  <div data-field="abs" data-textInput="true">\n    <div class="classic-form__logic-group logic-group pull-right">\n      <label>\n        <input type="radio" name="abstract-logic" value="AND" checked="true" />\n        and\n      </label>\n      <label>\n        <input type="radio" name="abstract-logic" value="OR" /> or\n      </label>\n      <label>\n        <input type="radio" name="abstract-logic" value="BOOLEAN" /> boolean\n      </label>\n    </div>\n    <div>\n      <label for="#classic_abstract_input"> Abstract/Keywords</label>\n      <input\n        id="clasic_abstract_input"\n        class="form-control"\n        name="abs"\n        type="text"\n        aria-label="abstract and keywords"\n      />\n    </div>\n  </div>\n  <div data-field="property">\n    <label>\n      <input type="checkbox" name="refereed" />&nbsp;Refereed only&nbsp;\n    </label>\n    &nbsp;&nbsp;&nbsp;\n    <label>\n      <input type="checkbox" name="article" />&nbsp;Articles only&nbsp;\n    </label>\n  </div>\n  <div data-field="bibstem" data-textInput="true">\n    <div class="logic-group">\n      <input type="checkbox" class="hidden" value="OR" checked="true" />\n    </div>\n    <label for="#classic-bibstem">Publication(s)</label>\n    <p class="help-block small">Press Return Key To Add Publication</p>\n    <input\n      id="classic-bibstem"\n      type="text"\n      class="form-control"\n      name="bibstem"\n      placeholder="Comma-separated bibstems of journal titles"\n      autocomplete="off"\n      aria-label="bibstems"\n    />\n  </div>\n\n  <div data-field="sort" class="clearfix">\n    <div class="col-sm-6">\n      <label for="sort-container">Sort</label>\n      <div id="sort-container"></div>\n    </div>\n  </div>\n  <div class="pull-right">\n    <button class="btn" type="reset"><i class="fa fa-times"></i> Clear</button>\n    <button class="btn btn-primary" type="submit">\n      <i class="fa fa-search"></i> Search\n    </button>\n  </div>\n</form>\n'},useData:!0});return t.registerPartial("js/widgets/classic_form/form",n),n}),define("js/widgets/paper_search_form/topterms",[],function(){return[{value:"PhRvL",label:"Physical Review Letters (PhRvL)"},{value:"ApJ",label:"The Astrophysical Journal (ApJ)"},{value:"ApJL",label:"The Astrophysical Journal Letters (ApJL)"},{value:"PhRvB",label:"Physical Review B (PhRvB)"},{value:"JChPh",label:"Journal of Chemical Physics (JChPh)"},{value:"Natur",label:"Nature (Natur)"},{value:"PhRvD",label:"Physical Review D (PhRvD)"},{value:"ApPhL",label:"Applied Physics Letters (ApPhL)"},{value:"Sci",label:"Science (Sci)"},{value:"JGR",label:"Journal of Geophysical Research (JGR)"},{value:"A&A",label:"Astronomy and Astrophysics (A&A)"},{value:"JAP",label:"Journal of Applied Physics (JAP)"},{value:"PhRv",label:"Physical Review (PhRv)"},{value:"MNRAS",label:"Monthly Notices of the Royal Astronomical Society (MNRAS)"},{value:"PhRvA",label:"Physical Review A (PhRvA)"},{value:"PhLB",label:"Physics Letters B (PhLB)"},{value:"NuPhB",label:"Nuclear Physics B (NuPhB)"},{value:"PNAS",label:"Proceedings of the National Academy of Science (PNAS)"},{value:"arXiv",label:"ArXiv e-prints (arXiv)"},{value:"GeoRL",label:"Geophysical Research Letters (GeoRL)"},{value:"PhRvE",label:"Physical Review E (PhRvE)"},{value:"PhRvC",label:"Physical Review C (PhRvC)"},{value:"JHEP",label:"Journal of High Energy Physics (JHEP)"},{value:"AJ",label:"The Astronomical Journal (AJ)"},{value:"CPL",label:"Chemical Physics Letters (CPL)"},{value:"NuPhA",label:"Nuclear Physics A (NuPhA)"},{value:"RvMP",label:"Reviews of Modern Physics (RvMP)"},{value:"OptL",label:"Optics Letters (OptL)"},{value:"E&PSL",label:"Earth and Planetary Science Letters (E&PSL)"},{value:"GeCoA",label:"Geochimica et Cosmochimica Acta (GeCoA)"},{value:"SurSc",label:"Surface Science (SurSc)"},{value:"ApOpt",label:"Applied Optics (ApOpt)"},{value:"SPIE",label:"Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series (SPIE)"},{value:"JFM",label:"Journal of Fluid Mechanics (JFM)"},{value:"ApJS",label:"The Astrophysical Journal Supplement Series (ApJS)"},{value:"OExpr",label:"Optics Express (OExpr)"},{value:"PhLA",label:"Physics Letters A (PhLA)"},{value:"JaJAP",label:"Japanese Journal of Applied Physics (JaJAP)"},{value:"JPSJ",label:"Journal of the Physical Society of Japan (JPSJ)"},{value:"SSCom",label:"Solid State Communications (SSCom)"},{value:"RSPSA",label:"Proceedings of the Royal Society of London Series A (RSPSA)"},{value:"JAtS",label:"Journal of Atmospheric Sciences (JAtS)"},{value:"JPCM",label:"Journal of Physics Condensed Matter (JPCM)"},{value:"JPhA",label:"Journal of Physics A Mathematical General (JPhA)"},{value:"PLoSO",label:"PLoS ONE (PLoSO)"},{value:"PhR",label:"Physics Reports (PhR)"},{value:"JPhB",label:"Journal of Physics B Atomic Molecular Physics (JPhB)"},{value:"RScI",label:"Review of Scientific Instruments (RScI)"},{value:"PhFl",label:"Physics of Fluids (PhFl)"},{value:"EnST",label:"Environmental Science and Technology (EnST)"},{value:"JGRD",label:"Journal of Geophysical Research (Atmospheres) (JGRD)"},{value:"MaMol",label:"Macromolecules (MaMol)"},{value:"NanoL",label:"Nano Letters (NanoL)"},{value:"JCli",label:"Journal of Climate (JCli)"},{value:"NIMPA",label:"Nuclear Instruments and Methods in Physics Research A (NIMPA)"},{value:"AtmEn",label:"Atmospheric Environment (AtmEn)"},{value:"ASAJ",label:"Acoustical Society of America Journal (ASAJ)"},{value:"WRR",label:"Water Resources Research (WRR)"},{value:"Icar",label:"Icarus (Icar)"},{value:"JCrGr",label:"Journal of Crystal Growth (JCrGr)"},{value:"JMP",label:"Journal of Mathematical Physics (JMP)"},{value:"TSF",label:"Thin Solid Films (TSF)"},{value:"Geo",label:"Geology (Geo)"},{value:"PhPl",label:"Physics of Plasmas (PhPl)"},{value:"JMMM",label:"Journal of Magnetism and Magnetic Materials (JMMM)"},{value:"OptCo",label:"Optics Communications (OptCo)"},{value:"EL",label:"EPL (Europhysics Letters) (EL)"},{value:"MWRv",label:"Monthly Weather Review (MWRv)"},{value:"JCoPh",label:"Journal of Computational Physics (JCoPh)"},{value:"AnPhy",label:"Annals of Physics (AnPhy)"},{value:"Tectp",label:"Tectonophysics (Tectp)"},{value:"JPhD",label:"Journal of Physics D Applied Physics (JPhD)"},{value:"NIMPB",label:"Nuclear Instruments and Methods in Physics Research B (NIMPB)"},{value:"ITM",label:"IEEE Transactions on Magnetics (ITM)"},{value:"CMaPh",label:"Communications in Mathematical Physics (CMaPh)"},{value:"JPhC",label:"Journal of Physics C Solid State Physics (JPhC)"},{value:"PSSBR",label:"Physica Status Solidi B Basic Research (PSSBR)"},{value:"JNCS",label:"Journal of Non Crystalline Solids (JNCS)"},{value:"CQGra",label:"Classical and Quantum Gravity (CQGra)"},{value:"SoPh",label:"Solar Physics (SoPh)"},{value:"ACP",label:"Atmospheric Chemistry & Physics (ACP)"},{value:"IJQE",label:"IEEE Journal of Quantum Electronics (IJQE)"},{value:"PhDT",label:"Ph.D. Thesis (PhDT)"},{value:"MolPh",label:"Molecular Physics (MolPh)"},{value:"NatMa",label:"Nature Materials (NatMa)"},{value:"ApSS",label:"Applied Surface Science (ApSS)"},{value:"PASP",label:"Publications of the Astronomical Society of the Pacific (PASP)"},{value:"AIPC",label:"American Institute of Physics Conference Series (AIPC)"},{value:"PhyC",label:"Physica C Superconductivity (PhyC)"},{value:"PThPh",label:"Progress of Theoretical Physics (PThPh)"},{value:"BpJ",label:"Biophysical Journal (BpJ)"},{value:"JNuM",label:"Journal of Nuclear Materials (JNuM)"},{value:"ITED",label:"IEEE Transactions on Electron Devices (ITED)"},{value:"PhyA",label:"Physica A Statistical Mechanics and its Applications (PhyA)"},{value:"JPCS",label:"Journal of Physics and Chemistry of Solids (JPCS)"},{value:"ITGRS",label:"IEEE Transactions on Geoscience and Remote Sensing (ITGRS)"},{value:"CoMP",label:"Contributions to Mineralogy and Petrology (CoMP)"},{value:"JHyd",label:"Journal of Hydrology (JHyd)"},{value:"ZPhy",label:"Zeitschrift fur Physik (ZPhy)"},{value:"CP",label:"Chemical Physics (CP)"},{value:"A&AS",label:"Astronomy and Astrophysics Supplement Series (A&AS)"},{value:"JCAP",label:"Journal of Cosmology and Astro-Particle Physics (JCAP)"},{value:"ARA&A",label:"Annual Review of Astronomy and Astrophysics (ARA&A)"},{value:"QJRMS",label:"Quarterly Journal of the Royal Meteorological Society (QJRMS)"},{value:"GeoJI",label:"Geophysical Journal International (GeoJI)"},{value:"EPJC",label:"European Physical Journal C (EPJC)"},{value:"JOSAB",label:"Journal of the Optical Society of America B Optical Physics (JOSAB)"},{value:"JVST",label:"Journal of Vacuum Science Technology (JVST)"},{value:"JMoSp",label:"Journal of Molecular Spectroscopy (JMoSp)"},{value:"JPO",label:"Journal of Physical Oceanography (JPO)"},{value:"ITAP",label:"IEEE Transactions on Antennas and Propagation (ITAP)"},{value:"NatSR",label:"Scientific Reports (NatSR)"},{value:"JGRA",label:"Journal of Geophysical Research (Space Physics) (JGRA)"},{value:"RSEnv",label:"Remote Sensing of Environment (RSEnv)"},{value:"PhyB",label:"Physica B Condensed Matter (PhyB)"},{value:"ITNS",label:"IEEE Transactions on Nuclear Science (ITNS)"},{value:"JPCA",label:"Journal of Physical Chemistry A (JPCA)"},{value:"IPTL",label:"IEEE Photonics Technology Letters (IPTL)"},{value:"NJPh",label:"New Journal of Physics (NJPh)"},{value:"PSSAR",label:"Physica Status Solidi Applied Research (PSSAR)"},{value:"NatCo",label:"Nature Communications (NatCo)"},{value:"JMatS",label:"Journal of Materials Science (JMatS)"},{value:"CoPhC",label:"Computer Physics Communications (CoPhC)"},{value:"GSAB",label:"Geological Society of America Bulletin (GSAB)"},{value:"RPPh",label:"Reports on Progress in Physics (RPPh)"},{value:"JLwT",label:"Journal of Lightwave Technology (JLwT)"},{value:"NatPh",label:"Nature Physics (NatPh)"},{value:"RSPTA",label:"Philosophical Transactions of the Royal Society of London Series A (RSPTA)"},{value:"PCCP",label:"Physical Chemistry Chemical Physics (Incorporating Faraday Transactions) (PCCP)"},{value:"P&SS",label:"Planetary and Space Science (P&SS)"},{value:"Geop",label:"Geophysics (Geop)"},{value:"ITMTT",label:"IEEE Transactions on Microwave Theory Techniques (ITMTT)"},{value:"ChGeo",label:"Chemical Geology (ChGeo)"},{value:"JPS",label:"Journal of Power Sources (JPS)"},{value:"APS",label:"APS Meeting Abstracts (APS)"},{value:"ASPC",label:"Astronomical Society of the Pacific Conference Series (ASPC)"},{value:"JOSAA",label:"Journal of the Optical Society of America A (JOSAA)"},{value:"CaJPh",label:"Canadian Journal of Physics (CaJPh)"},{value:"JSV",label:"Journal of Sound Vibration (JSV)"},{value:"JGRB",label:"Journal of Geophysical Research (Solid Earth) (JGRB)"},{value:"Nanot",label:"Nanotechnology (Nanot)"},{value:"PhyD",label:"Physica D Nonlinear Phenomena (PhyD)"},{value:"AGUFM",label:"AGU Fall Meeting Abstracts (AGUFM)"},{value:"SSRv",label:"Space Science Reviews (SSRv)"},{value:"AIAAJ",label:"AIAA Journal (AIAAJ)"},{value:"JOSA",label:"Journal of the Optical Society of America (1917-1983) (JOSA)"},{value:"JETP",label:"Soviet Journal of Experimental and Theoretical Physics (JETP)"},{value:"JSSCh",label:"Journal of Solid State Chemistry France (JSSCh)"},{value:"QSRv",label:"Quaternary Science Reviews (QSRv)"},{value:"PMag",label:"Philosophical Magazine (PMag)"},{value:"JETPL",label:"Soviet Journal of Experimental and Theoretical Physics Letters (JETPL)"},{value:"JSP",label:"Journal of Statistical Physics (JSP)"},{value:"MedPh",label:"Medical Physics (MedPh)"},{value:"NucIM",label:"Nuclear Instruments and Methods (NucIM)"},{value:"Ap&SS",label:"Astrophysics and Space Science (Ap&SS)"},{value:"IAUS",label:"IAU Symposium (IAUS)"},{value:"JQSRT",label:"Journal of Quantitative Spectroscopy and Radiative Transfer (JQSRT)"},{value:"SSEle",label:"Solid State Electronics (SSEle)"},{value:"IEDL",label:"IEEE Electron Device Letters (IEDL)"},{value:"ApPhA",label:"Applied Physics A: Materials Science & Processing (ApPhA)"},{value:"NucFu",label:"Nuclear Fusion (NucFu)"},{value:"NaPho",label:"Nature Photonics (NaPho)"},{value:"JVGR",label:"Journal of Volcanology and Geothermal Research (JVGR)"},{value:"JApMe",label:"Journal of Applied Meteorology (JApMe)"},{value:"JPhG",label:"Journal of Physics G Nuclear Physics (JPhG)"},{value:"PEPI",label:"Physics of the Earth and Planetary Interiors (PEPI)"},{value:"AdSpR",label:"Advances in Space Research (AdSpR)"},{value:"IJRS",label:"International Journal of Remote Sensing (IJRS)"},{value:"ApPhB",label:"Applied Physics B: Lasers and Optics (ApPhB)"},{value:"JMoSt",label:"Journal of Molecular Structure (JMoSt)"},{value:"BAMS",label:"Bulletin of the American Meteorological Society (BAMS)"},{value:"JMagR",label:"Journal of Magnetic Resonance (JMagR)"},{value:"NucPh",label:"Nuclear Physics (NucPh)"},{value:"AdPhy",label:"Advances in Physics (AdPhy)"},{value:"AcSpA",label:"Spectrochimica Acta Part A: Molecular Spectroscopy (AcSpA)"},{value:"ClDy",label:"Climate Dynamics (ClDy)"},{value:"NatNa",label:"Nature Nanotechnology (NatNa)"},{value:"PASJ",label:"Publications of the Astronomical Society of Japan (PASJ)"},{value:"JGRC",label:"Journal of Geophysical Research (Oceans) (JGRC)"},{value:"AmJPh",label:"American Journal of Physics (AmJPh)"},{value:"IJMPA",label:"International Journal of Modern Physics A (IJMPA)"},{value:"Phy",label:"Physica (Phy)"},{value:"CMAME",label:"Computer Methods in Applied Mechanics and Engineering (CMAME)"},{value:"JSG",label:"Journal of Structural Geology (JSG)"},{value:"JMatR",label:"Journal of Materials Research (JMatR)"},{value:"NYASA",label:"Annals of the New York Academy of Sciences (NYASA)"},{value:"PMB",label:"Physics in Medicine and Biology (PMB)"},{value:"Litho",label:"Lithos (Litho)"},{value:"GBioC",label:"Global Biogeochemical Cycles (GBioC)"},{value:"PhyS",label:"Physica Scripta (PhyS)"},{value:"AnP",label:"Annalen der Physik (AnP)"},{value:"ITSP",label:"IEEE Transactions on Signal Processing (ITSP)"},{value:"PPCF",label:"Plasma Physics and Controlled Fusion (PPCF)"},{value:"JPet",label:"Journal of Petrology (JPet)"},{value:"GeoJ",label:"Geophysical Journal (GeoJ)"},{value:"JPhCS",label:"Journal of Physics Conference Series (JPhCS)"},{value:"ZPhyB",label:"Zeitschrift fur Physik B Condensed Matter (ZPhyB)"},{value:"MPLA",label:"Modern Physics Letters A (MPLA)"},{value:"HyPr",label:"Hydrological Processes (HyPr)"},{value:"JLTP",label:"Journal of Low Temperature Physics (JLTP)"},{value:"JVSTB",label:"Journal of Vacuum Science Technology B: Microelectronics and Nanometer Structures (JVSTB)"},{value:"Tecto",label:"Tectonics (Tecto)"},{value:"JG",label:"Journal of Geology (JG)"},{value:"PreR",label:"Precambrian Research (PreR)"},{value:"EPJB",label:"European Physical Journal B (EPJB)"},{value:"NuPhS",label:"Nuclear Physics B Proceedings Supplements (NuPhS)"},{value:"ZNatA",label:"Zeitschrift Naturforschung Teil A (ZNatA)"},{value:"AcSpe",label:"Spectrochimica Acta (AcSpe)"},{value:"ITPS",label:"IEEE Transactions on Plasma Science (ITPS)"},{value:"LNP",label:"Lecture Notes in Physics, Berlin Springer Verlag (LNP)"},{value:"DSRII",label:"Deep Sea Research Part II: Topical Studies in Oceanography (DSRII)"},{value:"JATP",label:"Journal of Atmospheric and Terrestrial Physics (JATP)"},{value:"Geomo",label:"Geomorphology (Geomo)"},{value:"PalOc",label:"Paleoceanography (PalOc)"},{value:"math",label:"ArXiv Mathematics e-prints (math)"},{value:"JPhF",label:"Journal of Physics F Metal Physics (JPhF)"},{value:"BoLMe",label:"Boundary-Layer Meteorology (BoLMe)"},{value:"ZPhyC",label:"Zeitschrift fur Physik C Particles and Fields (ZPhyC)"},{value:"SuScT",label:"Superconductor Science Technology (SuScT)"},{value:"RaSc",label:"Radio Science (RaSc)"},{value:"PhL",label:"Physics Letters (PhL)"},{value:"JCIS",label:"Journal of Colloid and Interface Science (JCIS)"},{value:"OptEn",label:"Optical Engineering (OptEn)"},{value:"JPoSA",label:"Journal of Polymer Science A Polymer Chemistry (JPoSA)"},{value:"IJNME",label:"International Journal for Numerical Methods in Engineering (IJNME)"},{value:"AnGeo",label:"Annales Geophysicae (AnGeo)"},{value:"ApSpe",label:"Applied Spectroscopy (ApSpe)"},{value:"NatGe",label:"Nature Geoscience (NatGe)"},{value:"SMat",label:"Soft Matter (SMat)"},{value:"AnRFM",label:"Annual Review of Fluid Mechanics (AnRFM)"},{value:"SeScT",label:"Semiconductor Science Technology (SeScT)"},{value:"PPS",label:"Proceedings of the Physical Society (PPS)"},{value:"ZPhyA",label:"Zeitschrift fur Physik A Hadrons and Nuclei (ZPhyA)"},{value:"GReGr",label:"General Relativity and Gravitation (GReGr)"},{value:"JMPSo",label:"Journal of Mechanics Physics of Solids (JMPSo)"},{value:"RvGeo",label:"Reviews of Geophysics (RvGeo)"},{value:"ADNDT",label:"Atomic Data and Nuclear Data Tables (ADNDT)"},{value:"LimOc",label:"Limnology and Oceanography (LimOc)"},{value:"JLum",label:"Journal of Luminescence (JLum)"},{value:"ARPC",label:"Annual Review of Physical Chemistry (ARPC)"},{value:"GGG",label:"Geochemistry, Geophysics, Geosystems (GGG)"},{value:"IJCli",label:"International Journal of Climatology (IJCli)"},{value:"JAtOT",label:"Journal of Atmospheric and Oceanic Technology (JAtOT)"},{value:"JEMat",label:"Journal of Electronic Materials (JEMat)"},{value:"JGlac",label:"Journal of Glaciology (JGlac)"},{value:"DRM",label:"Diamond and Related Materials (DRM)"},{value:"CaJES",label:"Canadian Journal of Earth Sciences (CaJES)"},{value:"ECSS",label:"Estuarine Coastal and Shelf Science (ECSS)"},{value:"CSR",label:"Continental Shelf Research (CSR)"},{value:"Ana",label:"The Analyst (Ana)"},{value:"ChPhL",label:"Chinese Physics Letters (ChPhL)"},{value:"QuRes",label:"Quaternary Research (QuRes)"},{value:"NCimA",label:"Nuovo Cimento A Serie (NCimA)"},{value:"AN",label:"Astronomische Nachrichten (AN)"},{value:"ITIP",label:"IEEE Transactions on Image Processing (ITIP)"},{value:"QuEle",label:"Quantum Electronics (QuEle)"},{value:"Nanos",label:"Nanoscale (Nanos)"},{value:"AREPS",label:"Annual Review of Earth and Planetary Sciences (AREPS)"},{value:"NW",label:"Naturwissenschaften (NW)"},{value:"MeScT",label:"Measurement Science and Technology (MeScT)"},{value:"Sedim",label:"Sedimentology (Sedim)"},{value:"CSF",label:"Chaos Solitons and Fractals (CSF)"},{value:"LPI",label:"Lunar and Planetary Science Conference (LPI)"},{value:"EPJA",label:"European Physical Journal A (EPJA)"},{value:"BVol",label:"Bulletin of Volcanology (BVol)"},{value:"SoEn",label:"Solar Energy (SoEn)"},{value:"SedG",label:"Sedimentary Geology (SedG)"},{value:"EGUGA",label:"EGU General Assembly Conference Abstracts (EGUGA)"},{value:"JMOp",label:"Journal of Modern Optics (JMOp)"},{value:"APh",label:"Astroparticle Physics (APh)"},{value:"PhT",label:"Physics Today (PhT)"},{value:"JGRE",label:"Journal of Geophysical Research (Planets) (JGRE)"},{value:"AmMin",label:"American Mineralogist (AmMin)"},{value:"ARNPS",label:"Annual Review of Nuclear and Particle Science (ARNPS)"},{value:"RvGSP",label:"Reviews of Geophysics and Space Physics (RvGSP)"},{value:"ESPL",label:"Earth Surface Processes and Landforms (ESPL)"},{value:"ScTEn",label:"Science of the Total Environment (ScTEn)"},{value:"ESRv",label:"Earth Science Reviews (ESRv)"},{value:"JRSp",label:"Journal of Raman Spectroscopy (JRSp)"},{value:"ASSL",label:"Astrophysics and Space Science Library (ASSL)"},{value:"JPoSB",label:"Journal of Polymer Science B Polymer Physics (JPoSB)"},{value:"IJMSI",label:"International Journal of Mass Spectrometry and Ion Processes (IJMSI)"},{value:"PApGe",label:"Pure and Applied Geophysics (PApGe)"},{value:"EPJD",label:"European Physical Journal D (EPJD)"},{value:"JPCRD",label:"Journal of Physical and Chemical Reference Data (JPCRD)"},{value:"ITAS",label:"IEEE Transactions on Applied Superconductivity (ITAS)"},{value:"M&PS",label:"Meteoritics and Planetary Science (M&PS)"},{value:"JAM",label:"Journal of Applied Mechanics (JAM)"},{value:"PrOce",label:"Progress in Oceanography (PrOce)"},{value:"JASTP",label:"Journal of Atmospheric and Solar-Terrestrial Physics (JASTP)"},{value:"EOSTr",label:"EOS Transactions (EOSTr)"},{value:"OptMa",label:"Optical Materials (OptMa)"},{value:"ESASP",label:"ESA Special Publication (ESASP)"},{value:"PhyE",label:"Physica E Low-Dimensional Systems and Nanostructures (PhyE)"},{value:"PMagA",label:"Philosophical Magazine, Part A (PMagA)"},{value:"PSST",label:"Plasma Sources Science Technology (PSST)"},{value:"PMagB",label:"Philosophical Magazine, Part B (PMagB)"},{value:"JHyMe",label:"Journal of Hydrometeorology (JHyMe)"},{value:"GPC",label:"Global and Planetary Change (GPC)"},{value:"BGeo",label:"Biogeosciences (BGeo)"},{value:"PhFlB",label:"Physics of Fluids B (PhFlB)"},{value:"MGeol",label:"Marine Geology (MGeol)"},{value:"DSRA",label:"Deep Sea Research A (DSRA)"},{value:"HESS",label:"Hydrology and Earth System Sciences (HESS)"},{value:"IJMPB",label:"International Journal of Modern Physics B (IJMPB)"},{value:"JChEd",label:"Journal of Chemical Education (JChEd)"},{value:"QuInt",label:"Quaternary International (QuInt)"},{value:"PhST",label:"Physica Scripta Volume T (PhST)"},{value:"Chaos",label:"Chaos (Chaos)"},{value:"MEPS",label:"Marine Ecology Progress Series (MEPS)"},{value:"OptSp",label:"Optics and Spectroscopy (OptSp)"},{value:"IJMPD",label:"International Journal of Modern Physics D (IJMPD)"},{value:"AdWR",label:"Advances in Water Resources (AdWR)"},{value:"HyInt",label:"Hyperfine Interactions (HyInt)"},{value:"JAESc",label:"Journal of Asian Earth Sciences (JAESc)"},{value:"AmJS",label:"American Journal of Science (AmJS)"},{value:"IAUC",label:"International Astronomical Union Circular (IAUC)"},{value:"PrPNP",label:"Progress in Particle and Nuclear Physics (PrPNP)"},{value:"RaPC",label:"Radiation Physics and Chemistry (RaPC)"},{value:"PThPS",label:"Progress of Theoretical Physics Supplement (PThPS)"},{value:"AAS",label:"American Astronomical Society Meeting Abstracts (AAS)"},{value:"JPhE",label:"Journal of Physics E Scientific Instruments (JPhE)"},{value:"PCPS",label:"Proceedings of the Cambridge Philosophical Society (PCPS)"},{value:"Cryo",label:"Cryogenics (Cryo)"},{value:"AnGla",label:"Annals of Glaciology (AnGla)"},{value:"IJTP",label:"International Journal of Theoretical Physics (IJTP)"},{value:"ITAES",label:"IEEE Transactions on Aerospace Electronic Systems (ITAES)"},{value:"SvPhU",label:"Soviet Physics Uspekhi (SvPhU)"},{value:"JSMTE",label:"Journal of Statistical Mechanics: Theory and Experiment (JSMTE)"},{value:"GSLSP",label:"Geological Society of London Special Publications (GSLSP)"},{value:"JDE",label:"Journal of Differential Equations (JDE)"},{value:"Chmsp",label:"Chemosphere (Chmsp)"},{value:"WtFor",label:"Weather and Forecasting (WtFor)"},{value:"JRScT",label:"Journal of Research in Science Teaching (JRScT)"},{value:"ArRMA",label:"Archive for Rational Mechanics and Analysis (ArRMA)"},{value:"JPlPh",label:"Journal of Plasma Physics (JPlPh)"},{value:"NCimB",label:"Nuovo Cimento B Serie (NCimB)"},{value:"CG",label:"Computers and Geosciences (CG)"},{value:"PhFlA",label:"Physics of Fluids A (PhFlA)"},{value:"SMaS",label:"Smart Material Structures (SMaS)"},{value:"GCBio",label:"Global Change Biology (GCBio)"},{value:"JMiMi",label:"Journal of Micromechanics and Microengineering (JMiMi)"},{value:"SuMi",label:"Superlattices and Microstructures (SuMi)"},{value:"SurSR",label:"Surface Science Reports (SurSR)"},{value:"ChPhB",label:"Chinese Physics B (ChPhB)"},{value:"TellB",label:"Tellus Series B Chemical and Physical Meteorology B (TellB)"},{value:"AcCrA",label:"Acta Crystallographica Section A (AcCrA)"},{value:"Oecol",label:"Oecologia (Oecol)"},{value:"AuJPh",label:"Australian Journal of Physics (AuJPh)"},{value:"BAAS",label:"Bulletin of the American Astronomical Society (BAAS)"},{value:"AgFM",label:"Agricultural and Forest Meteorology (AgFM)"},{value:"PCM",label:"Physics and Chemistry of Minerals (PCM)"},{value:"JMS",label:"Journal of Marine Systems (JMS)"},{value:"IJNMF",label:"International Journal for Numerical Methods in Fluids (IJNMF)"},{value:"JBO",label:"Journal of Biomedical Optics (JBO)"},{value:"ExFl",label:"Experiments in Fluids (ExFl)"},{value:"APExp",label:"Applied Physics Express (APExp)"},{value:"JRheo",label:"Journal of Rheology (JRheo)"},{value:"DSRI",label:"Deep Sea Research Part I: Oceanographic Research (DSRI)"},{value:"PPSA",label:"Proceedings of the Physical Society A (PPSA)"},{value:"ICRC",label:"International Cosmic Ray Conference (ICRC)"},{value:"LanB",label:"Landolt B&ouml;rnstein (LanB)"},{value:"AcA",label:"Acta Astronomica (AcA)"},{value:"PPP",label:"Palaeogeography Palaeoclimatology Palaeoecology (PPP)"},{value:"Tell",label:"Tellus (Tell)"},{value:"SciEd",label:"Science Education (SciEd)"},{value:"JMetG",label:"Journal of Metamorphic Geology (JMetG)"},{value:"PLSCB",label:"PLoS Computational Biology (PLSCB)"},{value:"IBVS",label:"Information Bulletin on Variable Stars (IBVS)"},{value:"Metro",label:"Metrologia (Metro)"},{value:"JGCD",label:"Journal of Guidance Control Dynamics (JGCD)"},{value:"AnRMS",label:"Annual Review of Materials Science (AnRMS)"},{value:"NatCC",label:"Nature Climate Change (NatCC)"},{value:"MTA",label:"Metallurgical Transactions A (MTA)"},{value:"ThApC",label:"Theoretical and Applied Climatology (ThApC)"},{value:"CzJPh",label:"Czechoslovak Journal of Physics (CzJPh)"},{value:"IJMSp",label:"International Journal of Mass Spectrometry (IJMSp)"},{value:"JSpRo",label:"Journal of Spacecraft and Rockets (JSpRo)"},{value:"Nonli",label:"Nonlinearity (Nonli)"},{value:"LaPhL",label:"Laser Physics Letters (LaPhL)"},{value:"LMaPh",label:"Letters in Mathematical Physics (LMaPh)"},{value:"RemS",label:"Remote Sensing (RemS)"},{value:"CCM",label:"Clays and Clay Minerals (CCM)"},{value:"SSASJ",label:"Soil Science Society of America Journal (SSASJ)"},{value:"IJBC",label:"International Journal of Bifurcation and Chaos (IJBC)"},{value:"Metic",label:"Meteoritics (Metic)"},{value:"PhSS",label:"Physics of the Solid State (PhSS)"},{value:"JGRF",label:"Journal of Geophysical Research (Earth Surface) (JGRF)"},{value:"ZPhyD",label:"Zeitschrift fur Physik D Atoms Molecules Clusters (ZPhyD)"},{value:"MSSP",label:"Mechanical Systems and Signal Processing (MSSP)"},{value:"IGRSL",label:"IEEE Geoscience and Remote Sensing Letters (IGRSL)"},{value:"InMat",label:"Inventiones Mathematicae (InMat)"},{value:"gr.qc",label:"ArXiv General Relativity and Quantum Cosmology e-prints (gr.qc)"},{value:"MMTA",label:"Metallurgical and Materials Transactions A (MMTA)"},{value:"EP&S",label:"Earth, Planets, and Space (EP&S)"},{value:"GeopP",label:"Geophysical Prospecting (GeopP)"},{value:"IJSEd",label:"International Journal of Science Education (IJSEd)"},{value:"FaDi",label:"Faraday Discussions (FaDi)"},{value:"AtmRe",label:"Atmospheric Research (AtmRe)"},{value:"InvPr",label:"Inverse Problems (InvPr)"},{value:"SvA",label:"Soviet Astronomy (SvA)"},{value:"SPhD",label:"Soviet Physics Doklady (SPhD)"},{value:"AcAau",label:"Acta Astronautica (AcAau)"},{value:"JCHyd",label:"Journal of Contaminant Hydrology (JCHyd)"},{value:"ForPh",label:"Fortschritte der Physik (ForPh)"},{value:"Vacuu",label:"Vacuum (Vacuu)"},{value:"JApMC",label:"Journal of Applied Meteorology and Climatology (JApMC)"},{value:"OptLT",label:"Optics Laser Technology (OptLT)"},{value:"STIN",label:"NASA STI/Recon Technical Report N (STIN)"},{value:"GCN",label:"GRB Coordinates Network (GCN)"},{value:"ER",label:"Environmental Research (ER)"},{value:"JPRS",label:"ISPRS Journal of Photogrammetry and Remote Sensing (JPRS)"},{value:"JAWRA",label:"Journal of the American Water Resources Association (JAWRA)"},{value:"JSedR",label:"Journal of Sedimentary Research (JSedR)"},{value:"ZhPmR",label:"ZhETF Pisma Redaktsiiu (ZhPmR)"},{value:"ERL",label:"Environmental Research Letters (ERL)"},{value:"PhRvS",label:"Physical Review Accelerators and Beams (PhRvS)"},{value:"ApPhy",label:"Applied Physics (ApPhy)"},{value:"PhyU",label:"Physics Uspekhi (PhyU)"},{value:"AuJES",label:"Australian Journal of Earth Sciences (AuJES)"},{value:"ATel",label:"The Astronomer's Telegram (ATel)"},{value:"AZh",label:"Astronomicheskii Zhurnal (AZh)"},{value:"PAN",label:"Physics of Atomic Nuclei (PAN)"},{value:"GApFD",label:"Geophysical and Astrophysical Fluid Dynamics (GApFD)"},{value:"PhRvX",label:"Physical Review X (PhRvX)"},{value:"SciAm",label:"Scientific American (SciAm)"},{value:"JQS",label:"Journal of Quaternary Science (JQS)"},{value:"Prama",label:"Pramana (Prama)"},{value:"BuSSA",label:"The Bulletin of the Seismological Society of America (BuSSA)"},{value:"GeoRu",label:"Geologische Rundschau (GeoRu)"},{value:"NRL",label:"Nanoscale Research Letters (NRL)"},{value:"AerST",label:"Aerosol Science Technology (AerST)"},{value:"ZhETF",label:"Zhurnal Eksperimentalnoi i Teoreticheskoi Fiziki (ZhETF)"},{value:"JGRG",label:"Journal of Geophysical Research (Biogeosciences) (JGRG)"},{value:"ElL",label:"Electronics Letters (ElL)"},{value:"JAfES",label:"Journal of African Earth Sciences (JAfES)"},{value:"RSPSB",label:"Proceedings of the Royal Society of London Series B (RSPSB)"},{value:"JInst",label:"Journal of Instrumentation (JInst)"},{value:"FoPh",label:"Foundations of Physics (FoPh)"},{value:"NewA",label:"New Astronomy (NewA)"},{value:"PSSCR",label:"Physica Status Solidi C Current Topics (PSSCR)"},{value:"NDS",label:"Nuclear Data Sheets (NDS)"},{value:"IAWPL",label:"IEEE Antennas and Wireless Propagation Letters (IAWPL)"},{value:"LPSC",label:"Lunar and Planetary Science Conference Proceedings (LPSC)"},{value:"NCim",label:"Il Nuovo Cimento (NCim)"},{value:"RSPTB",label:"Philosophical Transactions of the Royal Society of London Series B (RSPTB)"},{value:"JCoMa",label:"Journal of Composite Materials (JCoMa)"},{value:"Optik",label:"Optik (Optik)"},{value:"CNSNS",label:"Communications in Nonlinear Science and Numerical Simulations (CNSNS)"},{value:"OcMod",label:"Ocean Modelling (OcMod)"},{value:"NIMPR",label:"Nuclear Instruments and Methods in Physics Research (NIMPR)"},{value:"JAerS",label:"Journal of Aerosol Science (JAerS)"},{value:"ZA",label:"Zeitschrift fur Astrophysik (ZA)"},{value:"CoTPh",label:"Communications in Theoretical Physics (CoTPh)"},{value:"MPLB",label:"Modern Physics Letters B (MPLB)"},{value:"TMP",label:"Theoretical and Mathematical Physics (TMP)"},{value:"AcPPB",label:"Acta Physica Polonica B (AcPPB)"},{value:"AMM",label:"Applied Mechanics and Materials (AMM)"},{value:"Obs",label:"The Observatory (Obs)"},{value:"ConPh",label:"Contemporary Physics (ConPh)"},{value:"MAP",label:"Meteorology and Atmospheric Physics (MAP)"},{value:"JFS",label:"Journal of Fluids and Structures (JFS)"},{value:"AMT",label:"Atmospheric Measurement Techniques (AMT)"},{value:"PrSS",label:"Progress In Surface Science (PrSS)"},{value:"ISPM",label:"IEEE Signal Processing Magazine (ISPM)"},{value:"PMagL",label:"Philosophical Magazine Letters (PMagL)"},{value:"GondR",label:"Gondwana Research (GondR)"},{value:"LRR",label:"Living Reviews in Relativity (LRR)"},{value:"CeMDA",label:"Celestial Mechanics and Dynamical Astronomy (CeMDA)"},{value:"KvanE",label:"Kvantovaia Elektronika Moscow (KvanE)"},{value:"PhyBC",label:"Physica B+C (PhyBC)"},{value:"NPhS",label:"Nature Physical Science (NPhS)"},{value:"NHESS",label:"Natural Hazards and Earth System Sciences (NHESS)"},{value:"PPSB",label:"Proceedings of the Physical Society B (PPSB)"},{value:"GMS",label:"Washington DC American Geophysical Union Geophysical Monograph Series (GMS)"},{value:"HydJ",label:"Hydrogeology Journal (HydJ)"},{value:"Holoc",label:"The Holocene (Holoc)"},{value:"TellA",label:"Tellus Series A (TellA)"},{value:"JOptA",label:"Journal of Optics A: Pure and Applied Optics (JOptA)"},{value:"IEEEP",label:"IEEE Proceedings (IEEEP)"},{value:"JOpt",label:"Journal of Optics (JOpt)"},{value:"IJNLM",label:"International Journal of Non Linear Mechanics (IJNLM)"},{value:"JGeod",label:"Journal of Geodesy (JGeod)"},{value:"NatCh",label:"Nature Chemistry (NatCh)"},{value:"PlPh",label:"Plasma Physics (PlPh)"},{value:"MPEC",label:"Minor Planet Electronic Circulars (MPEC)"},{value:"ISPL",label:"IEEE Signal Processing Letters (ISPL)"},{value:"GeoM",label:"Geological Magazine (GeoM)"},{value:"LaPhy",label:"Laser Physics (LaPhy)"},{value:"CAP",label:"Current Applied Physics (CAP)"},{value:"SSSci",label:"Solid State Sciences (SSSci)"},{value:"JScI",label:"Journal of Scientific Instruments (JScI)"},{value:"BJAP",label:"British Journal of Applied Physics (BJAP)"},{value:"CorRe",label:"Coral Reefs (CorRe)"},{value:"RuMaS",label:"Russian Mathematical Surveys (RuMaS)"},{value:"ZaMM",label:"Zeitschrift Angewandte Mathematik und Mechanik (ZaMM)"},{value:"Semic",label:"Semiconductors (Semic)"},{value:"IJMPE",label:"International Journal of Modern Physics E (IJMPE)"},{value:"GMD",label:"Geoscientific Model Development (GMD)"},{value:"CompM",label:"Computational Mechanics (CompM)"},{value:"IJMPC",label:"International Journal of Modern Physics C (IJMPC)"},{value:"AstL",label:"Astronomy Letters (AstL)"},{value:"AcOpt",label:"Optica Acta (AcOpt)"},{value:"JPoSc",label:"Journal of Polymer Science (JPoSc)"},{value:"A&ARv",label:"Astronomy and Astrophysics Review (A&ARv)"},{value:"JGP",label:"Journal of Geometry and Physics (JGP)"},{value:"Geode",label:"Geofisica Internacional (Geode)"},{value:"MinM",label:"Mineralogical Magazine (MinM)"},{value:"PhTea",label:"The Physics Teacher (PhTea)"},{value:"MmSAI",label:"Memorie della Societa Astronomica Italiana (MmSAI)"},{value:"TCry",label:"The Cryosphere (TCry)"},{value:"NewAR",label:"New Astronomy Reviews (NewAR)"},{value:"MT",label:"Metallurgical Transactions (MT)"},{value:"ApL",label:"Astrophysical Letters (ApL)"},{value:"PASA",label:"Publications of the Astronomical Society of Australia (PASA)"},{value:"MSMSE",label:"Modelling Simul. Mater. Sci. Eng. (MSMSE)"},{value:"IJEaS",label:"International Journal of Earth Sciences (IJEaS)"},{value:"ASIC",label:"NATO Advanced Science Institutes (ASI) Series C (ASIC)"},{value:"AdTMP",label:"Advances in Theoretical and Mathematical Physics (AdTMP)"},{value:"MPC",label:"Minor Planet Circulars (MPC)"},{value:"IJT",label:"International Journal of Thermophysics (IJT)"},{value:"MinDe",label:"Mineralium Deposita (MinDe)"},{value:"OptLE",label:"Optics and Lasers in Engineering (OptLE)"},{value:"ACPD",label:"Atmospheric Chemistry & Physics Discussions (ACPD)"},{value:"Wthr",label:"Weather (Wthr)"},{value:"ChPhy",label:"Chinese Physics (ChPhy)"},{value:"CeMec",label:"Celestial Mechanics (CeMec)"},{value:"TePhL",label:"Technical Physics Letters (TePhL)"},{value:"JOM",label:"JOM - Journal of the Minerals, Metals and Materials Society (JOM)"},{value:"JNR",label:"Journal of Nanoparticle Research (JNR)"},{value:"BAN",label:"Bulletin of the Astronomical Institutes of the Netherlands (BAN)"},{value:"AIPA",label:"AIP Advances (AIPA)"},{value:"JSAES",label:"Journal of South American Earth Sciences (JSAES)"},{value:"LTP",label:"Low Temperature Physics (LTP)"},{value:"TeNov",label:"Terra Nova (TeNov)"},{value:"CoPP",label:"Contributions to Plasma Physics (CoPP)"},{value:"JAG",label:"Journal of Applied Geophysics (JAG)"},{value:"SIAMR",label:"SIAM Review (SIAMR)"},{value:"AsBio",label:"Astrobiology (AsBio)"},{value:"Ge&Ae",label:"Geomagnetism and Aeronomy (Ge&Ae)"},{value:"SJNA",label:"SIAM Journal on Numerical Analysis (SJNA)"},{value:"MiMic",label:"Microscopy and Microanalysis (MiMic)"},{value:"LPB",label:"Laser and Particle Beams (LPB)"},{value:"ChSBu",label:"Chinese Science Bulletin (ChSBu)"},{value:"EPJE",label:"European Physical Journal E (EPJE)"},{value:"NHTA",label:"Numerical Heat Transfer Part A - Applications (NHTA)"},{value:"MS&E",label:"Materials Science and Engineering Conference Series (MS&E)"},{value:"JKPS",label:"Journal of Korean Physical Society (JKPS)"},{value:"ZK",label:"Zeitschrift fur Kristallographie (ZK)"},{value:"AdAtS",label:"Advances in Atmospheric Sciences (AdAtS)"},{value:"JGG",label:"Journal of Geomagnetism and Geoelectricity (JGG)"},{value:"ChPhC",label:"Chinese Physics C (ChPhC)"},{value:"SvAL",label:"Soviet Astronomy Letters (SvAL)"},{value:"ZaMP",label:"Zeitschrift Angewandte Mathematik und Physik (ZaMP)"},{value:"AnAp",label:"Annales d'Astrophysique (AnAp)"},{value:"EPJST",label:"European Physical Journal Special Topics (EPJST)"},{value:"RpMP",label:"Reports on Mathematical Physics (RpMP)"},{value:"JOptB",label:"Journal of Optics B: Quantum and Semiclassical Optics (JOptB)"},{value:"GML",label:"Geo-Marine Letters (GML)"},{value:"Msngr",label:"The Messenger (Msngr)"},{value:"CliPa",label:"Climate of the Past (CliPa)"},{value:"InfPh",label:"Infrared Physics (InfPh)"},{value:"SPIE1",label:"Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series (SPIE1)"},{value:"JGeo",label:"Journal of Geodynamics (JGeo)"},{value:"RMxAA",label:"Revista Mexicana de Astronomia y Astrofisica (RMxAA)"},{value:"R&QE",label:"Radiophysics and Quantum Electronics (R&QE)"},{value:"IJAEO",label:"International Journal of Applied Earth Observation and Geoinformation (IJAEO)"},{value:"RadR",label:"Radiation Research (RadR)"},{value:"JTST",label:"Journal of Thermal Spray Technology (JTST)"},{value:"PlPhR",label:"Plasma Physics Reports (PlPhR)"},{value:"yCat",label:"VizieR Online Data Catalog (yCat)"},{value:"Mate",label:"Materials (Mate)"},{value:"ITNan",label:"IEEE Transactions on Nanotechnology (ITNan)"},{value:"IJBm",label:"International Journal of Biometeorology (IJBm)"},{value:"WASP",label:"Water Air and Soil Pollution (WASP)"},{value:"EM&P",label:"Earth Moon and Planets (EM&P)"},{value:"S&T",label:"Sky and Telescope (S&T)"},{value:"IJSSC",label:"IEEE Journal of Solid-State Circuits (IJSSC)"},{value:"ApMRv",label:"Applied Mechanics Reviews (ApMRv)"},{value:"ARep",label:"Astronomy Reports (ARep)"},{value:"DPS",label:"AAS/Division for Planetary Sciences Meeting Abstracts (DPS)"},{value:"InPhT",label:"Infrared Physics and Technology (InPhT)"},{value:"NPGeo",label:"Nonlinear Processes in Geophysics (NPGeo)"},{value:"IJIMW",label:"International Journal of Infrared and Millimeter Waves (IJIMW)"},{value:"SGeo",label:"Surveys in Geophysics (SGeo)"},{value:"EPJWC",label:"European Physical Journal Web of Conferences (EPJWC)"},{value:"FBS",label:"Few-Body Systems (FBS)"},{value:"PCE",label:"Physics and Chemistry of the Earth (PCE)"},{value:"MinPe",label:"Mineralogy and Petrology (MinPe)"},{value:"IJQC",label:"International Journal of Quantum Chemistry (IJQC)"},{value:"CaJRS",label:"Canadian Journal of Remote Sensing (CaJRS)"},{value:"CRPhy",label:"Comptes Rendus Physique (CRPhy)"},{value:"JRASC",label:"Journal of the Royal Astronomical Society of Canada (JRASC)"},{value:"JTePh",label:"Journal of Technical Physics (JTePh)"},{value:"IGRv",label:"International Geology Review (IGRv)"},{value:"OcDyn",label:"Ocean Dynamics (OcDyn)"},{value:"DyAtO",label:"Dynamics of Atmospheres and Oceans (DyAtO)"},{value:"JCoAM",label:"Journal of Computational and Applied Mathematics (JCoAM)"},{value:"JSR",label:"Journal of Sea Research (JSR)"},{value:"TrAGU",label:"Transactions, American Geophysical Union (TrAGU)"},{value:"RuCRv",label:"Russian Chemical Reviews (RuCRv)"},{value:"RadM",label:"Radiation Measurements (RadM)"},{value:"JMolE",label:"Journal of Molecular Evolution (JMolE)"},{value:"AdAMP",label:"Advances in Atomic and Molecular Physics (AdAMP)"},{value:"LPICo",label:"LPI Contributions (LPICo)"},{value:"Afz",label:"Astrofizika (Afz)"},{value:"BAICz",label:"Bulletin of the Astronomical Institutes of Czechoslovakia (BAICz)"},{value:"IAPM",label:"IEEE Antennas and Propagation Magazine (IAPM)"},{value:"EJPh",label:"European Journal of Physics (EJPh)"},{value:"JPhy1",label:"Journal de Physique I (JPhy1)"},{value:"PhPro",label:"Physics Procedia (PhPro)"},{value:"PQE",label:"Progress in Quantum Electronics (PQE)"},{value:"Entrp",label:"Entropy (Entrp)"},{value:"SoilS",label:"Soil Science (SoilS)"},{value:"EPJAP",label:"European Physical Journal Applied Physics (EPJAP)"},{value:"BrJPh",label:"Brazilian Journal of Physics (BrJPh)"},{value:"HPR",label:"High Pressure Research (HPR)"},{value:"SbMat",label:"Sbornik: Mathematics (SbMat)"},{value:"JApSp",label:"Journal of Applied Spectroscopy (JApSp)"},{value:"AGUSM",label:"AGU Spring Meeting Abstracts (AGUSM)"},{value:"EnGeo",label:"Environmental Geology (EnGeo)"},{value:"MmRAS",label:"Memoirs of the Royal Astronomical Society (MmRAS)"},{value:"EnMan",label:"Environmental Management (EnMan)"},{value:"COSSM",label:"Current Opinion in Solid State and Materials Science (COSSM)"},{value:"CRGeo",label:"Comptes Rendus Geoscience (CRGeo)"},{value:"IAM",label:"International Applied Mechanics (IAM)"},{value:"AdQC",label:"Advances in Quantum Chemistry (AdQC)"},{value:"RvMG",label:"Reviews in Mineralogy and Geochemistry (RvMG)"},{value:"AAMOP",label:"Advances in Atomic Molecular and Optical Physics (AAMOP)"},{value:"RCMS",label:"Rapid Communications in Mass Spectrometry (RCMS)"},{value:"EJMin",label:"European Journal of Mineralogy (EJMin)"},{value:"QJRAS",label:"Quarterly Journal of the Royal Astronomical Society (QJRAS)"},{value:"SciA",label:"Science Advances (SciA)"},{value:"JMEP",label:"Journal of Materials Engineering and Performance (JMEP)"},{value:"JSup",label:"Journal of Superconductivity (JSup)"},{value:"MTB",label:"Metallurgical Transactions B (MTB)"},{value:"NCimC",label:"Nuovo Cimento C Geophysics Space Physics C (NCimC)"},{value:"NASSP",label:"NASA Special Publication (NASSP)"},{value:"NHTB",label:"Numerical Heat Transfer Part B - Fundamentals (NHTB)"},{value:"JAMTP",label:"Journal of Applied Mechanics and Technical Physics (JAMTP)"},{value:"ITPE",label:"IEEE Transactions on Power Electronics (ITPE)"},{value:"ClMin",label:"Clay Minerals (ClMin)"},{value:"SpecL",label:"Spectroscopy Letters (SpecL)"},{value:"JAtC",label:"Journal of Atmospheric Chemistry (JAtC)"},{value:"PrAeS",label:"Progress in Aerospace Sciences (PrAeS)"},{value:"MMAS",label:"Mathematical Methods in the Applied Sciences (MMAS)"},{value:"DoSSR",label:"Akademiia Nauk SSSR Doklady (DoSSR)"},{value:"JBAA",label:"Journal of the British Astronomical Association (JBAA)"},{value:"VA",label:"Vistas in Astronomy (VA)"},{value:"MarMP",label:"Marine Micropaleontology (MarMP)"},{value:"IJNAM",label:"International Journal for Numerical and Analytical Methods in Geomechanics (IJNAM)"},{value:"PhyEd",label:"Physics Education (PhyEd)"},{value:"OLEB",label:"Origins of Life and Evolution of the Biosphere (OLEB)"},{value:"RAA",label:"Research in Astronomy and Astrophysics (RAA)"},{value:"STAdM",label:"Science and Technology of Advanced Materials (STAdM)"},{value:"QuIP",label:"Quantum Information Processing (QuIP)"},{value:"MMTB",label:"Metallurgical and Materials Transactions B (MMTB)"},{value:"BasR",label:"Basin Research (BasR)"},{value:"PSSRR",label:"Physica Status Solidi Rapid Research Letters (PSSRR)"},{value:"SpWea",label:"Space Weather (SpWea)"},{value:"SCPMA",label:"Science China Physics, Mechanics, and Astronomy (SCPMA)"},{value:"ARCMP",label:"Annual Review of Condensed Matter Physics (ARCMP)"},{value:"JCAMD",label:"Journal of Computer-Aided Molecular Design (JCAMD)"},{value:"FlDyR",label:"Fluid Dynamics Research (FlDyR)"},{value:"ITPSy",label:"IEEE Transactions on Power Systems (ITPSy)"},{value:"DokES",label:"Doklady Earth Sciences (DokES)"},{value:"OptFT",label:"Optical Fiber Technology (OptFT)"},{value:"EJMF",label:"European Journal of Mechanics B Fluids (EJMF)"},{value:"CryRp",label:"Crystallography Reports (CryRp)"},{value:"IJCA",label:"International Journal of Computer Applications (IJCA)"},{value:"JPhy2",label:"Journal de Physique II (JPhy2)"},{value:"MeApp",label:"Meteorological Applications (MeApp)"},{value:"ISTSP",label:"IEEE Journal of Selected Topics in Signal Processing (ISTSP)"},{value:"JMSp",label:"Journal of Mass Spectrometry (JMSp)"},{value:"REDS",label:"Radiation Effects and Defects in Solids (REDS)"},{value:"JGSoc",label:"Journal of the Geological Society (JGSoc)"},{value:"PASAu",label:"Proceedings of the Astronomical Society of Australia (PASAu)"},{value:"IJSTQ",label:"IEEE Journal of Selected Topics in Quantum Electronics (IJSTQ)"},{value:"JApMM",label:"Journal of Applied Mathematics and Mechanics (JApMM)"},{value:"AdGeo",label:"Advances in Geophysics (AdGeo)"},{value:"MaCom",label:"Mathematics of Computation (MaCom)"},{value:"JDisT",label:"Journal of Display Technology (JDisT)"},{value:"ApGC",label:"Applied Geochemistry (ApGC)"},{value:"ClRes",label:"Climate Research (ClRes)"},{value:"E&ES",label:"IOP Conference Series: Earth and Environmental Science (E&ES)"},{value:"JApA",label:"Journal of Astrophysics and Astronomy (JApA)"},{value:"NCimD",label:"Nuovo Cimento D Serie (NCimD)"},{value:"JArEn",label:"Journal of Arid Environments (JArEn)"},{value:"GeCAS",label:"Geochimica et Cosmochimica Acta Supplement (GeCAS)"},{value:"ExA",label:"Experimental Astronomy (ExA)"},{value:"AnHP",label:"Annales Henri Poincar&eacute; (AnHP)"},{value:"FlDy",label:"Fluid Dynamics (FlDy)"},{value:"JJAPS",label:"Japanese Journal of Applied Physics Supplement (JJAPS)"},{value:"DSR",label:"Deep Sea Research (DSR)"},{value:"IRPC",label:"International Reviews in Physical Chemistry (IRPC)"},{value:"EJMS",label:"European Journal of Mechanics Solids (EJMS)"},{value:"HMT",label:"Heat and Mass Transfer (HMT)"},{value:"PA",label:"Popular Astronomy (PA)"},{value:"SPTP",label:"Soviet Physics Technical Physics (SPTP)"},{value:"CBET",label:"Central Bureau Electronic Telegrams (CBET)"},{value:"C&T",label:"Ciel et Terre (C&T)"},{value:"MPCPS",label:"Mathematical Proceedings of the Cambridge Philosophical Society (MPCPS)"},{value:"CRSSM",label:"Critical Reviews in Solid State & Materials Sciences (CRSSM)"},{value:"JMSB",label:"Journal of Macromolecular Science, Part B (JMSB)"},{value:"RvMaP",label:"Reviews in Mathematical Physics (RvMaP)"},{value:"NJSR",label:"Netherlands Journal of Sea Research (NJSR)"},{value:"JNEng",label:"Journal of Neural Engineering (JNEng)"},{value:"JAMES",label:"Journal of Advances in Modeling Earth Systems (JAMES)"},{value:"JPoSL",label:"Journal of Polymer Science: Polymer Letters Edition (JPoSL)"},{value:"WiEn",label:"Wind Energy (WiEn)"},{value:"RuPhJ",label:"Russian Physics Journal (RuPhJ)"},{value:"MetZe",label:"Meteorologische Zeitschrift (MetZe)"},{value:"JCP",label:"Journal de Chimie Physique (JCP)"},{value:"ThCFD",label:"Theoretical and Computational Fluid Dynamics (ThCFD)"},{value:"PhRvP",label:"Physical Review Applied (PhRvP)"},{value:"ESOC",label:"European Southern Observatory Conference and Workshop Proceedings (ESOC)"},{value:"ShWav",label:"Shock Waves (ShWav)"},{value:"EAEJA",label:"EGS - AGU - EUG Joint Assembly (EAEJA)"},{value:"PKM",label:"Physik der Kondensierten Materie (PKM)"},{value:"PAZh",label:"Pisma v Astronomicheskii Zhurnal (PAZh)"},{value:"OcSci",label:"Ocean Science (OcSci)"},{value:"JASMS",label:"Journal of The American Society for Mass Spectrometry (JASMS)"},{value:"StGG",label:"Studia Geophysica et Geodaetica (StGG)"},{value:"RScEd",label:"Research in Science Education (RScEd)"},{value:"IzMat",label:"Izvestiya: Mathematics (IzMat)"},{value:"PhyM",label:"Physiological Measurement (PhyM)"},{value:"RSPT",label:"Philosophical Transactions of the Royal Society of London Series I (RSPT)"},{value:"BaltA",label:"Baltic Astronomy (BaltA)"},{value:"MSHT",label:"Metal Science and Heat Treatment (MSHT)"},{value:"Moon",label:"Moon (Moon)"},{value:"EPJP",label:"European Physical Journal Plus (EPJP)"},{value:"BASI",label:"Bulletin of the Astronomical Society of India (BASI)"},{value:"RMxAC",label:"Revista Mexicana de Astronomia y Astrofisica Conference Series (RMxAC)"},{value:"BGD",label:"Biogeosciences Discussions (BGD)"},{value:"ITEdu",label:"IEEE Transactions on Education (ITEdu)"},{value:"OptRv",label:"Optical Review (OptRv)"},{value:"SRL",label:"Surface Review and Letters (SRL)"},{value:"JNS",label:"Journal of NonLinear Science (JNS)"},{value:"LAstr",label:"L'Astronomie (LAstr)"},{value:"SvPhJ",label:"Soviet Physics Journal (SvPhJ)"},{value:"PlST",label:"Plasma Science and Technology (PlST)"},{value:"Geosp",label:"Geosphere (Geosp)"},{value:"Ap",label:"Astrophysics (Ap)"},{value:"JElS",label:"Journal of the Electrochemical Society (JElS)"},{value:"DokPh",label:"Physics - Doklady (DokPh)"},{value:"FCPh",label:"Fundamentals of Cosmic Physics (FCPh)"},{value:"MSRv",label:"Mass Spectrometry Reviews (MSRv)"},{value:"MarGR",label:"Marine Geophysical Research (MarGR)"},{value:"NDT",label:"Nuclear Data Tables (NDT)"},{value:"NASCP",label:"NASA Conference Publication (NASCP)"},{value:"SurSL",label:"Surface Science Letters (SurSL)"},{value:"ISenJ",label:"IEEE Sensors Journal (ISenJ)"},{value:"JEnMa",label:"Journal of Engineering Mathematics (JEnMa)"},{value:"RMRE",label:"Rock Mechanics and Rock Engineering (RMRE)"},{value:"HDP",label:"Handbuch der Physik (HDP)"},{value:"LRSP",label:"Living Reviews in Solar Physics (LRSP)"},{value:"PTEP",label:"Progress of Theoretical and Experimental Physics (PTEP)"},{value:"PhBio",label:"Physical Biology (PhBio)"},{value:"AmSci",label:"American Scientist (AmSci)"},{value:"JSeis",label:"Journal of Seismology (JSeis)"},{value:"AcMSn",label:"Acta Mechanica Sinica (AcMSn)"},{value:"Palai",label:"PALAIOS (Palai)"},{value:"OptPN",label:"Optics & Photonics News (OptPN)"},{value:"LNCS",label:"Lecture Notes in Computer Science (LNCS)"},{value:"GrCo",label:"Gravitation and Cosmology (GrCo)"},{value:"UsFiN",label:"Uspekhi Fizicheskikh Nauk (UsFiN)"},{value:"RJPCA",label:"Russian Journal of Physical Chemistry A (RJPCA)"},{value:"IJTPE",label:"IEEJ Transactions on Power and Energy (IJTPE)"},{value:"ARMS",label:"Annual Review of Marine Science (ARMS)"},{value:"SIGMA",label:"SIGMA (SIGMA)"},{value:"CoPhR",label:"Computer Physics Reports (CoPhR)"},{value:"ECMS",label:"Estuarine and Coastal Marine Science (ECMS)"},{value:"CMT",label:"Continuum Mechanics and Thermodynamics (CMT)"},{value:"APhy",label:"Acoustical Physics (APhy)"},{value:"ApSRv",label:"Applied Spectroscopy Reviews (ApSRv)"},{value:"Sc&Ed",label:"Science & Education (Sc&Ed)"},{value:"ChOpL",label:"Chinese Optics Letters (ChOpL)"},{value:"PDiff",label:"Powder Diffraction (PDiff)"},{value:"AnPh",label:"Annales de Physique (AnPh)"},{value:"HEDP",label:"High Energy Density Physics (HEDP)"},{value:"SoSyR",label:"Solar System Research (SoSyR)"},{value:"ITPAS",label:"IEEE Transactions on Power Apparatus Systems (ITPAS)"},{value:"prpl.conf",label:"Protostars and Planets (prpl.conf)"},{value:"NCimR",label:"Nuovo Cimento Rivista Serie (NCimR)"},{value:"AAM",label:"Archive of Applied Mechanics (AAM)"},{value:"PDAO",label:"Publications of the Dominion Astrophysical Observatory Victoria (PDAO)"},{value:"JPall",label:"Journal of Palaeolimnology (JPall)"},{value:"RaF",label:"Radiofizika (RaF)"},{value:"EJASP",label:"EURASIP Journal on Applied Signal Processing (EJASP)"},{value:"RuGG",label:"Russian Geology and Geophysics (RuGG)"},{value:"JEI",label:"Journal of Electronic Imaging (JEI)"},{value:"TSICE",label:"Transactions of the Society of Instrument and Control Engineers (TSICE)"},{value:"HTrEn",label:"Heat Transfer Engineering (HTrEn)"},{value:"ATsir",label:"Astronomicheskij Tsirkulyar (ATsir)"},{value:"ClCh",label:"Climatic Change (ClCh)"},{value:"SciMo",label:"The Scientific Monthly (SciMo)"},{value:"InJPh",label:"Indian Journal of Physics (InJPh)"},{value:"HESSD",label:"Hydrology and Earth System Sciences Discussions (HESSD)"},{value:"SAOSR",label:"SAO Special Report (SAOSR)"},{value:"JEP",label:"Journal of Engineering Physics (JEP)"},{value:"IJTFM",label:"IEEJ Transactions on Fundamentals and Materials (IJTFM)"},{value:"AD",label:"Atomic Data (AD)"},{value:"ITEIS",label:"IEEJ Transactions on Electronics, Information and Systems (ITEIS)"},{value:"WRM",label:"Waves in Random Media (WRM)"},{value:"PZETF",label:"Pisma v Zhurnal Eksperimentalnoi i Teoreticheskoi Fiziki (PZETF)"},{value:"HiA",label:"Highlights of Astronomy (HiA)"},{value:"CRASM",label:"Academie des Sciences Paris Comptes Rendus Serie Sciences Mathematiques (CRASM)"},{value:"AIHPC",label:"Annales de L'Institut Henri Poincare Section (C) Non Linear Analysis (AIHPC)"},{value:"CosRe",label:"Cosmic Research (CosRe)"},{value:"MsT",label:"Masters Thesis (MsT)"},{value:"NCimL",label:"Nuovo Cimento Lettere (NCimL)"},{value:"FizPl",label:"Fizika Plazmy (FizPl)"},{value:"ISPAr",label:"ISPRS - International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences (ISPAr)"},{value:"AcO",label:"Acta Oecologica (AcO)"},{value:"JESS",label:"Journal of Earth System Science (JESS)"},{value:"JTurb",label:"Journal of Turbulence (JTurb)"},{value:"APLM",label:"APL Materials (APLM)"},{value:"IJTIA",label:"IEEJ Transactions on Industry Applications (IJTIA)"},{value:"JMAA",label:"Journal of Mathematical Analysis and Applications (JMAA)"},{value:"JNOPM",label:"Journal of Nonlinear Optical Physics and Materials (JNOPM)"},{value:"JNET",label:"Journal of Non Equilibrium Thermodynamics (JNET)"},{value:"SScEd",label:"Studies in Science Education (SScEd)"},{value:"MRE",label:"Materials Research Express (MRE)"},{value:"TDM",label:"2D Materials (TDM)"},{value:"ComPh",label:"Computers in Physics (ComPh)"},{value:"IEITE",label:"IEICE Transactions on Electronics (IEITE)"},{value:"JApSc",label:"Journal of Applied Sciences (JApSc)"},{value:"M&PSA",label:"Meteoritics and Planetary Science Supplement (M&PSA)"},{value:"PFR",label:"Plasma and Fusion Research (PFR)"},{value:"RaEl",label:"Radiotekhnika i Elektronika (RaEl)"},{value:"AcASn",label:"Acta Astronomica Sinica (AcASn)"},{value:"ChJAA",label:"Chinese Journal of Astronomy and Astrophysics (ChJAA)"},{value:"TTSP",label:"Transport Theory and Statistical Physics (TTSP)"},{value:"JSemi",label:"Journal of Semiconductors (JSemi)"},{value:"RSPS",label:"Proceedings of the Royal Society of London Series I (RSPS)"},{value:"XRS",label:"X-ray Spectrometry (XRS)"},{value:"CEJPh",label:"Central European Journal of Physics (CEJPh)"},{value:"AtScL",label:"Atmospheric Science Letters (AtScL)"},{value:"JPhy4",label:"Journal de Physique IV (JPhy4)"},{value:"KosIs",label:"Kosmicheskie Issledovaniia (KosIs)"},{value:"BRASP",label:"Bulletin of the Russian Academy of Sciences, Physics (BRASP)"},{value:"PolRe",label:"National Institute Polar Research Memoirs (PolRe)"},{value:"JNIS",label:"Journal of Near Infrared Spectroscopy (JNIS)"},{value:"PMM",label:"Physics of Metals and Metallography (PMM)"},{value:"PDU",label:"Physics of the Dark Universe (PDU)"},{value:"SvApM",label:"Soviet Applied Mechanics (SvApM)"},{value:"CRMec",label:"Comptes Rendus Mecanique (CRMec)"},{value:"MNSSA",label:"Monthly Notes of the Astronomical Society of South Africa (MNSSA)"},{value:"OrLi",label:"Origins of Life (OrLi)"},{value:"ScChA",label:"Science in China A: Mathematics (ScChA)"},{value:"PRPER",label:"Physical Review Physics Education Research (PRPER)"},{value:"IEITC",label:"IEICE Transactions on Communications (IEITC)"},{value:"JVSJ",label:"Journal of the Vacuum Society of Japan (JVSJ)"},{value:"EurSS",label:"Eurasian Soil Science (EurSS)"},{value:"IPhoJ",label:"IEEE Photonics Journal (IPhoJ)"},{value:"PhNan",label:"Photonics and Nanostructures (PhNan)"},{value:"ITTST",label:"IEEE Transactions on Terahertz Science and Technology (ITTST)"},{value:"ChJOL",label:"Chinese Journal of Oceanology and Limnology (ChJOL)"},{value:"CRASB",label:"Academie des Sciences Paris Comptes Rendus Serie B Sciences Physiques (CRASB)"},{value:"JFuE",label:"Journal of Funsion Energy (JFuE)"},{value:"DSROA",label:"Deep Sea Research and Oceanographic Abstracts (DSROA)"},{value:"RadEf",label:"Radiation Effects (RadEf)"},{value:"JSTEd",label:"Journal of Science Teacher Education (JSTEd)"},{value:"M&P",label:"Moon and Planets (M&P)"},{value:"JRPC",label:"Journal of Reinforced Plastics and Composites (JRPC)"},{value:"STMP",label:"Springer Tracts in Modern Physics (STMP)"},{value:"AntSc",label:"Antarctic Science (AntSc)"},{value:"RvPP",label:"Reviews of Plasma Physics (RvPP)"},{value:"JAVSO",label:"Journal of the American Association of Variable Star Observers (JAAVSO) (JAVSO)"},{value:"JBIS",label:"Journal of the British Interplanetary Society (JBIS)"},{value:"ASSP",label:"Astrophysics and Space Science Proceedings (ASSP)"},{value:"QJMat",label:"The Quarterly Journal of Mathematics (QJMat)"},{value:"MitAG",label:"Mitteilungen der Astronomischen Gesellschaft Hamburg (MitAG)"},{value:"PhyOJ",label:"Physics Online Journal (PhyOJ)"},{value:"JKAS",label:"Journal of Korean Astronomical Society (JKAS)"},{value:"JNMP",label:"Journal of Nonlinear Mathematical Physics (JNMP)"},{value:"IJHMT",label:"International Journal of Heat and Mass Transfer (IJHMT)"},{value:"GeoPA",label:"Geofisica Pura e Applicata (GeoPA)"},{value:"TeMAE",label:"Terrestrial Magnetism and Atmospheric Electricity (Journal of Geophysical Research) (TeMAE)"},{value:"ITEnC",label:"IEEE Transactions on Energy Conversion (ITEnC)"},{value:"BGeod",label:"Bulletin Geodesique (BGeod)"},{value:"PhRvI",label:"Physical Review Series I (PhRvI)"},{value:"JAChS",label:"Journal of the American Chemical Society (JAChS)"},{value:"ESSD",label:"Earth System Science Data (ESSD)"},{value:"IEITF",label:"IEICE Transactions on Fundamentals of Electronics Communications and Computer Sciences (IEITF)"},{value:"PApOp",label:"Pure Applied Optics (PApOp)"},{value:"TrGeo",label:"Treatise on Geochemistry (TrGeo)"},{value:"CTM",label:"Combustion Theory and Modelling (CTM)"},{value:"Lsphe",label:"Lithoshere (Lsphe)"},{value:"ChA&A",label:"Chinese Astronomy and Astrophysics (ChA&A)"},{value:"JDDE",label:"Journal of Dynamics and Differential Equations (JDDE)"},{value:"A&AT",label:"Astronomical and Astrophysical Transactions (A&AT)"},{value:"JSEdT",label:"Journal of Science Education and Technology (JSEdT)"},{value:"LIACo",label:"Liege International Astrophysical Colloquia (LIACo)"},{value:"PPN",label:"Physics of Particles and Nuclei (PPN)"},{value:"JARS",label:"Journal of Applied Remote Sensing (JARS)"},{value:"AnMat",label:"Annals of Mathematics (AnMat)"},{value:"SoEnM",label:"Solar Energy Materials (SoEnM)"},{value:"AcPPA",label:"Acta Physica Polonica A (AcPPA)"},{value:"CoAst",label:"Communications in Asteroseismology (CoAst)"},{value:"ScChG",label:"Science in China: Physics, Mechanics and Astronomy (ScChG)"},{value:"AcGeo",label:"Acta Geophysica (AcGeo)"},{value:"JNuE",label:"Journal of Nuclear Energy (JNuE)"},{value:"JEPT",label:"Journal of Engineering Physics and Thermophysics (JEPT)"},{value:"IzAOP",label:"Izvestiya Atmospheric and Oceanic Physics (IzAOP)"},{value:"EGSGA",label:"E&amp;G Quaternary Science Journal (EGSGA)"},{value:"ComAp",label:"Comments on Astrophysics (ComAp)"},{value:"ChEG",label:"Chemie der Erde / Geochemistry (ChEG)"},{value:"JLasA",label:"Journal of Laser Applications (JLasA)"},{value:"IJGMM",label:"International Journal of Geometric Methods in Modern Physics (IJGMM)"},{value:"MMI",label:"Metals and Materials International (MMI)"},{value:"IzKry",label:"Izvestiya Ordena Trudovogo Krasnogo Znameni Krymskoj Astrofizicheskoj Observatorii (IzKry)"},{value:"EaInt",label:"Earth Interactions (EaInt)"},{value:"Freq",label:"Frequenz (Freq)"},{value:"LicOB",label:"Lick Observatory Bulletin (LicOB)"},{value:"IJSTA",label:"IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing (IJSTA)"},{value:"PCEA",label:"Physics and Chemistry of the Earth A (PCEA)"},{value:"CoSka",label:"Contributions of the Astronomical Observatory Skalnate Pleso (CoSka)"},{value:"BiBi",label:"Bioinspiration and Biomimetics (BiBi)"},{value:"AeoRe",label:"Aeolian Research (AeoRe)"},{value:"AdAst",label:"Advances in Astronomy (AdAst)"},{value:"DeHyZ",label:"Deutsche Hydrographische Zeitschrift (DeHyZ)"},{value:"SvJPP",label:"Soviet Journal of Plasma Physics (SvJPP)"},{value:"IEITI",label:"IEICE Transactions on Information and Systems (IEITI)"},{value:"FrPhy",label:"Frontiers of Physics (FrPhy)"},{value:"EAS",label:"EAS Publications Series (EAS)"},{value:"Physi",label:"Physics (Physi)"},{value:"ITAC",label:"IEEE Transactions on Automatic Control (ITAC)"},{value:"AnHar",label:"Annals of Harvard College Observatory (AnHar)"},{value:"RCD",label:"Regular and Chaotic Dynamics (RCD)"},{value:"GescJ",label:"Geosciences Journal (GescJ)"},{value:"JMPh",label:"Journal of Modern Physics (JMPh)"},{value:"AuJPA",label:"Australian Journal of Physics Astrophysical Supplement (AuJPA)"},{value:"SSI",label:"Space Science Instrumentation (SSI)"},{value:"JPhys",label:"Journal de Physique (JPhys)"},{value:"SJADS",label:"SIAM Journal on Applied Dynamical Systems (SJADS)"},{value:"PhLRv",label:"Physics of Life Reviews (PhLRv)"},{value:"IJMPS",label:"International Journal of Modern Physics Conference Series (IJMPS)"},{value:"JGeEd",label:"Journal of Geoscience Education (JGeEd)"},{value:"JBR",label:"Journal of Breath Research (JBR)"},{value:"PhuZ",label:"Physik in unserer Zeit (PhuZ)"},{value:"EML",label:"Electronic Materials Letters (EML)"},{value:"KFNT",label:"Kinematika i Fizika Nebesnykh Tel (KFNT)"},{value:"ApL&C",label:"Astrophysical Letters and Communications (ApL&C)"},{value:"IJAsB",label:"International Journal of Astrobiology (IJAsB)"},{value:"HWM",label:"Helgol&auml;nder Wissenschaftliche Meeresuntersuchungen (HWM)"},{value:"AMTD",label:"Atmospheric Measurement Techniques Discussions (AMTD)"},{value:"JRadR",label:"Journal of Radiation Research (JRadR)"},{value:"HEAD",label:"AAS/High Energy Astrophysics Division (HEAD)"},{value:"HMR",label:"Helgoland Marine Research (HMR)"},{value:"ChJPh",label:"Chinese Journal of Physics (ChJPh)"},{value:"IJOE",label:"IEEE Journal of Oceanic Engineering (IJOE)"},{value:"JRP",label:"Journal of Radiological Protection (JRP)"},{value:"JOptT",label:"Journal of Optical Technology (JOptT)"},{value:"PZ",label:"Peremennye Zvezdy (PZ)"},{value:"CMMPh",label:"Computational Mathematics and Mathematical Physics (CMMPh)"},{value:"MCM",label:"Mechanics of Composite Materials (MCM)"},{value:"PPNL",label:"Physics of Particles and Nuclei Letters (PPNL)"},{value:"IrAJ",label:"Irish Astronomical Journal (IrAJ)"},{value:"ARAC",label:"Annual Review of Analytical Chemistry (ARAC)"},{value:"IJCFD",label:"International Journal of Computational Fluid Dynamics (IJCFD)"},{value:"AcSSn",label:"Acta Seismologica Sinica (AcSSn)"},{value:"CoASP",label:"Comments on Astrophysics and Space Physics (CoASP)"},{value:"NewSc",label:"New Scientist (NewSc)"},{value:"IzSSR",label:"Akademiia Nauk SSSR Izvestiia Seriia Fizicheskaia (IzSSR)"},{value:"NuAlg",label:"Numerical Algorithms (NuAlg)"},{value:"ResPh",label:"Results in Physics (ResPh)"},{value:"JIMO",label:"WGN, Journal of the International Meteor Organization (JIMO)"},{value:"FNCN",label:"Fullerene Nanotubes and Carbon Nanostructures (FNCN)"},{value:"JO",label:"Journal des Observateurs (JO)"},{value:"CzJPS",label:"Czechoslovak Journal of Physics Supplement (CzJPS)"},{value:"JGE",label:"Journal of Geophysics and Engineering (JGE)"},{value:"JIEEJ",label:"Journal of The Institute of Electrical Engineers of Japan (JIEEJ)"},{value:"SolE",label:"Solid Earth (SolE)"},{value:"IJDE",label:"International Journal of Digital Earth (IJDE)"},{value:"JIPM",label:"Journal of Information Processing and Management (JIPM)"},{value:"BAAA",label:"Boletin de la Asociacion Argentina de Astronomia La Plata Argentina (BAAA)"},{value:"JHA",label:"Journal for the History of Astronomy (JHA)"},{value:"QuOpt",label:"Quantum Optics (QuOpt)"},{value:"CoLPL",label:"Communications of the Lunar and Planetary Laboratory (CoLPL)"},{value:"IzPSE",label:"Izvestiya Physics of the Solid Earth (IzPSE)"},{value:"cosp",label:"COSPAR Scientific Assembly (cosp)"},{value:"OMExp",label:"Optical Materials Express (OMExp)"},{value:"AstBu",label:"Astrophysical Bulletin (AstBu)"},{value:"SCoA",label:"Smithsonian Contributions to Astrophysics (SCoA)"},{value:"ITGE",label:"IEEE Transactions on Geoscience Electronics (ITGE)"},{value:"GeoSu",label:"Geophysical Surveys (GeoSu)"},{value:"RSTEd",label:"Research in Science and Technological Education (RSTEd)"},{value:"JSMEB",label:"JSME International Journal Series B (JSMEB)"},{value:"PCEB",label:"Physics and Chemistry of the Earth B (PCEB)"},{value:"ASIB",label:"NATO Advanced Science Institutes (ASI) Series B (ASIB)"},{value:"LPRv",label:"Laser & Photonics Review (LPRv)"},{value:"PhyEs",label:"Physics Essays (PhyEs)"},{value:"InEPS",label:"Indian Academy of Sciences Proceedings: Earth and Planetary Sciences (InEPS)"},{value:"ApPRv",label:"Applied Physics Reviews (ApPRv)"},{value:"JAnSc",label:"Journal of the Astronautical Sciences (JAnSc)"},{value:"OptEL",label:"Optoelectronics Letters (OptEL)"},{value:"MPBu",label:"Minor Planet Bulletin (MPBu)"},{value:"AnaCh",label:"Analytical Chemistry (AnaCh)"},{value:"CosEl",label:"Cosmic Electrodynamics (CosEl)"},{value:"RvMA",label:"Reviews in Modern Astronomy (RvMA)"}]}),define("babel",{}),define("es6",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("js/widgets/sort/redux/modules/sort-app",["underscore"],function(e){var t={options:[{id:"author_count",text:"Author Count",desc:"sort by number of authors"},{id:"bibcode",text:"Bibcode",desc:"sort by bibcode"},{id:"citation_count",text:"Citation Count",desc:"sort by number of citations"},{id:"citation_count_norm",text:"Normalized Citation Count",desc:"sort by number of normalized citations"},{id:"classic_factor",text:"Classic Factor",desc:"sort using classical score"},{id:"first_author",text:"First Author",desc:"sort by first author"},{id:"date",text:"Date",desc:"sort by publication date"},{id:"entry_date",text:"Entry Date",desc:"sort by date work entered the database"},{id:"read_count",text:"Read Count",desc:"sort by number of reads"},{id:"score",text:"Score",desc:"sort by the relative score"}],sort:{id:"date",text:"Date"},direction:"desc",query:null,locked:!1,lockTimer:null};return{setSort:function(t,n){return function(i,a,r){if(e.isString(t)){var s=a().options;t=s.find(function(e){return e.id===t})||s[0]}i({type:"SET_SORT",value:t}),!n&&r.onSortChange()}},setDirection:function(t,n){return function(i,a,r){if(e.isUndefined(t)){var s=a().direction;t="asc"===s?"desc":"asc"}i({type:"SET_DIRECTION",value:t}),!n&&r.onSortChange()}},setQuery:function(e){return{type:"SET_QUERY",value:e}},setLocked:function(e){return function(t,n){var i=n().lockTimer;i&&clearTimeout(i);var a=setTimeout(function(){return t({type:"SET_LOCKED",value:!1})},3e4);t({type:"SET_LOCKED",value:e,timer:a})}},initialState:t,reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_SORT":return _objectSpread({},e,{sort:n.value});case"SET_DIRECTION":return _objectSpread({},e,{direction:n.value});case"SET_QUERY":return _objectSpread({},e,{query:n.value});case"SET_LOCKED":return _objectSpread({},e,{locked:n.value,lockTimer:n.timer});default:return t}}}}),define("js/widgets/sort/redux/configure-store",["redux","redux-thunk","./modules/sort-app"],function(e,t,n){var i=e.createStore,a=e.applyMiddleware;return function(r){var s=a(t.default.withExtraArgument(r)),o=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||e.compose;return i(n.reducer,o(s))}}),define("js/widgets/sort/components/sort-app.jsx",["react","react-prop-types"],function(e,t){var n=function(t){var n=t.setSort,i=t.setDirection,a=t.app,r=a.options,s=a.sort,o=a.direction;return e.createElement("div",{className:"btn-group"},e.createElement("button",{type:"button",className:"btn btn-default",onClick:i,title:"asc"===o?"Change sort direction to descending":"Change sort direction to ascending"},e.createElement("i",{className:"fa fa-sort-amount-".concat(o),"aria-hidden":"true"})),e.createElement("button",{style:{minWidth:100},type:"button",className:"btn btn-default dropdown-toggle","data-toggle":"dropdown",title:"Select a sort option"},s.text," ",e.createElement("span",{className:"caret","aria-hidden":"true"})),e.createElement("ul",{className:"dropdown-menu",role:"menu"},r.map(function(t){return e.createElement("li",{key:t.id},e.createElement("a",{href:"javascript:void(0)",title:t.desc,onClick:function(e){return function(e,t){t.preventDefault(),t.stopPropagation&&t.stopPropagation(),n(e)}(t,e)}},t.text))})))};return n.propTypes={app:t.object.isRequired,setSort:t.func.isRequired,setDirection:t.func.isRequired},n}),define("js/widgets/sort/containers/sort-container",["react-redux","../redux/modules/sort-app","../components/sort-app.jsx"],function(e,t,n){var i=t.setSort,a=t.setDirection;return e.connect(function(e){return{app:e}},function(e){return{setSort:function(t){return e(i(t))},setDirection:function(){return e(a())}}})(n)}),define("js/widgets/sort/widget.jsx",["underscore","backbone","analytics","react","react-redux","react-dom","./redux/configure-store","./redux/modules/sort-app","js/components/api_query","js/widgets/base/base_widget","js/components/api_feedback","./containers/sort-container"],function(e,t,n,i,a,r,s,o,l,c,u,h){var d=t.View.extend({initialize:function(t){e.assign(this,t)},render:function(){return r.render(i.createElement(a.Provider,{store:this.store},i.createElement(h,null)),this.el),this},destroy:function(){r.unmountComponentAtNode(this.el)}});return c.extend({initialize:function(){this.store=s(this),this.view=new d({store:this.store}),this.onSortChange=e.debounce(this.onSortChange,500),this.handleFeedback=e.bind(this.handleFeedback,this)},activate:function(e){this.setBeeHive(e),this.activateWidget();var t=this.getPubSub();t.subscribe(t.FEEDBACK,this.handleFeedback)},onSortChange:function(){var t=this.getPubSub(),i=this.store.getState(),a=i.sort.id,r=i.direction,s=i.query,o=a+" "+r;if(e.isNull(s)&&(s=this.getBeeHive().getObject("AppStorage").getCurrentQuery()),!e.isUndefined(s.sort)&&!e.isEmpty(s.sort)){var c=s.sort[0].split(/,\s?/).slice(1);c.unshift(o),o=c.join(", ")}s&&(s.sort=[o],t.publish(t.NAVIGATE,"search-page",{q:new l(s)}),n("send","event","interaction","sort-applied",o))},handleFeedback:function(e){var t=this.store.dispatch,n=o.setQuery,i=o.setSort,a=o.setDirection,r=o.setLocked;switch(e.code){case u.CODES.SEARCH_CYCLE_STARTED:var s=e&&e.query&&e.query.toJSON();if(s){var l=this.extractSort(s.sort[0]);t(n(s)),t(i(l.sort,!0)),t(a(l.direction,!0)),t(r(!0))}break;case u.CODES.SEARCH_CYCLE_PROGRESS:t(r(!0));break;case u.CODES.SEARCH_CYCLE_FAILED_TO_START:case u.CODES.SEARCH_CYCLE_FINISHED:t(r(!1))}},extractSort:function(e){var t=e.split(/,\s?/)[0]||"date desc";return{sort:(t=t.split(" "))[0],direction:t[1]}}})}),define("js/widgets/classic_form/widget",["js/widgets/base/base_widget","js/components/api_query","js/components/api_query_updater","hbs!js/widgets/classic_form/form","js/widgets/paper_search_form/topterms","analytics","js/widgets/sort/widget.jsx","js/widgets/sort/redux/modules/sort-app"],function(e,t,n,i,a,r,s,o){var l={AND:" ",OR:" OR ",BOOLEAN:" "},c=Backbone.Model.extend({initialize:function(){this.listenTo(this,"change",_.bind(this.serialize,this)),this.updater=new n(" "),this.serialize()},defaults:{"author-logic":"AND","object-logic":"AND","title-logic":"AND","abstract-logic":"AND","author-names":[],"object-names":[],collections:{astronomy:!0,physics:!1,general:!1},property:{refereed:!1,article:!1},pubdate:{month_from:"01",year_from:"0000",month_to:"12",year_to:"9999"},title:"",abs:"",bibstem:"",query:null,sort:"date desc"},_makeFqStr:function(e,t){var n=_.keys(e),i=_(e).pick(_.identity).keys().value();return i.length>1?t&&n.length===i.length?"("+n.join(" AND ")+")":"("+n.join(" OR ")+")":i[0]},_movePrefix:function(e){var t=this.updater;return _.map(e,function(e){var n="";return/^[=\-+]/.test(e)&&(n=e.substr(0,1),e=e.substr(1)),n+t.quoteIfNecessary(e)})},serialize:_.debounce(function(){var e,t=this.updater,n=this.toJSON(),i={q:[],fq:[],sort:n.sort};(e=this._makeFqStr(n.collections))&&(i.__fq_database=["AND",e],i.fq.push("{!type=aqp v=$fq_database}"),i.fq_database="database: "+e),(e=this._makeFqStr(n.property,!0))&&(i.__fq_property=["AND",e],i.fq.push("{!type=aqp v=$fq_property}"),i.fq_property="property: "+e);var a=n.pubdate,r=["[",a.year_from,"-",a.month_from," TO ",a.year_to,"-",a.month_to,"]"].join("");_.isEqual(a,this.defaults.pubdate)||i.q.push("pubdate:"+r);var s=l[n["author-logic"]],o=!1,c=_.map(n["author-names"],function(e){var t="";return/^[=\-+]/.test(e)&&(t=e.substr(0,1),e=e.substr(1)),/[\$]$/.test(e)&&(o=!0,e=e.substr(0,e.length-1)),t+'"'+e+'"'}),u="author:("+c.join(s)+")";o&&(u+=" author_count:1"),c.length&&i.q.push(u);var h=l[n["object-logic"]],d=this._movePrefix(n["object-names"]);u="object:("+d.join(h)+")";d.length&&i.q.push(u);var p=l[n["title-logic"]],f=n.title.split(/\s+/);f.length>0&&""!==f[0]&&i.q.push("title:("+f.join(p)+")");var g=l[n["abstract-logic"]],b=n.abs.split(/\s+/);u="abs:("+b.join(g)+")";b.length&&""!==b[0]&&i.q.push(u);var v=_.reduce(n.bibstem.match(/[^,^\s]+/g),function(e,n){return/^\-/.test(n)?e.neg.push(t.quoteIfNecessary(n.replace(/^\-/,""))):e.pos.push(t.quoteIfNecessary(n)),e},{neg:[],pos:[]});v.neg.length&&i.q.push("-bibstem:("+v.neg.join(" OR ")+")"),v.pos.length&&i.q.push("bibstem:("+v.pos.join(" OR ")+")"),_.isEmpty(i.q)&&i.q.push("*"),this.set("query",_.reduce(i,function(e,t,n){return _.isEmpty(t)?e:(e[n]=_.isArray(t)?t:[t],e)},{}))},50)}),u=Marionette.ItemView.extend({initialize:function(){var e=this;this.sortWidget=new s,this.sortWidget.onSortChange=_.bind(this.onSortChange,this),this.model.on("change:sort",function(){var t=_slicedToArray(e.model.get("sort").split(" "),2),n=t[0],i=t[1],a=e.sortWidget.store.getState(),r=a.sort,s=a.direction;n===r.id&&i===s||(e.sortWidget.store.dispatch(o.setQuery(null)),e.sortWidget.store.dispatch(o.setSort(n,!0)),e.sortWidget.store.dispatch(o.setDirection(i,!0)))})},template:i,className:"classic-form",events:{"submit form":"submitForm","reset form":"onReset",'change input[name$="-logic"]':"updateLogic","input textarea":"textareaUpdate",'change div[data-field="database"] input':"updateCollection",'change div[data-field="property"] input':"updateProperty",'input input[name="title"],input[name="abs"],input[name="bibstem"]':"inputUpdate",'input input[name^="month"],input[name^="year"]':"dateUpdate"},onChangeToCollections:function(e){var t=this;Object.keys(e).forEach(function(n){var i=$('div[data-field="database"] input[name='.concat(n,"]"),t.$el);i.length>0&&i.prop("checked",e[n])})},updateLogic:function(e){var t=this.$(e.currentTarget);this.model.set(t.attr("name"),t.val().trim())},onSortChange:function(){var e=this.sortWidget.store.getState(),t=e.sort,n=e.direction,i=t.id+" "+n;this.model.set("sort",i)},textareaUpdate:function(e){var t=this.$(e.currentTarget),n=_.filter(t.val().split(/[\n;]\s*/),function(e){return!_.isEmpty(e)});n=n.map(Function.prototype.call,String.prototype.trim),this.model.set(t.attr("name"),n)},updateCollection:function(e){var t=this.$(e.currentTarget),n={};n[t.attr("name")]=t.prop("checked"),this.model.set("collections",_.extend({},this.model.get("collections"),n))},updateProperty:function(e){var t=this.$(e.currentTarget),n={};n[t.attr("name")]=t.prop("checked"),this.model.set("property",_.extend({},this.model.get("property"),n))},inputUpdate:function(e){var t=this.$(e.currentTarget);this.model.set(t.attr("name"),t.val().trim())},dateUpdate:function(e){var t=this.$(e.currentTarget),n=t.attr("name"),i=t.val().trim(),a={};i=""===i?this.model.defaults.pubdate[n]:i,a[n]=i,this.model.set("pubdate",_.extend({},this.model.get("pubdate"),a))},submitForm:function(e){return e.preventDefault(),this.trigger("submit",this.model.get("query")),this.$("button[type=submit]").each(function(){var e=$(this),t=e.html();e.html('<i class="icon-loading"/>  Loading...'),setTimeout(function(){e.html(t)},3e3)}),!1},onReset:function(){this.model.set(this.model.defaults),this.render()},onRender:function(){var e=this;this.$("#sort-container").html(this.sortWidget.render().el);var t=function(e){return _.last(e.split(/(,\s|;\s|[,;])/)).replace(/^\-/,"")},n=this.$("input[name=bibstem]");n.data("ui-autocomplete")||(n.autocomplete({minLength:1,autoFocus:!0,source:function(e,n){return n($.map(a,function(n){if(_.isString(e.term)){var i=t(e.term).toUpperCase(),a=n.value.toUpperCase(),r=n.label.toUpperCase();if(0===a.indexOf(i)||0===r.indexOf(i)||0===r.replace(/^THE\s/,"").indexOf(i))return n}}))},focus:function(){return!1},select:function(t,n){var i=this.value.split(/,\s*/),a=i.pop();return i.push((a.startsWith("-")?"-":"")+n.item.value),i.push(""),this.value=i.join(", "),e.model.set("bibstem",this.value),t.preventDefault(),!1}}).data("ui-autocomplete")._renderItem=function(e,n){var i=t(this.term).toUpperCase().trim(),a=new RegExp("("+i+")","i"),r=n.label;i.length>0&&(r=r.replace(a,'<span class="ui-state-highlight">$1</span>'));var s=$("<li/>").appendTo(e);return $("<a/>").attr("href","javascript:void(0)").html(r).appendTo(s).on("click",function(e){e.preventDefault()}),s})}});return e.extend({initialize:function(e){e=e||{},this.model=new c,this.view=new u({model:this.model}),this.listenTo(this.view,"submit",this.submitForm)},activate:function(e){var t=this;this.setBeeHive(e),this.view.sortWidget.activate(e);var n=this.getPubSub(),i=this;n.subscribe(n.CUSTOM_EVENT,function(e){"start-new-search"===e&&i.onNewSearch()}),n.subscribe(n.USER_ANNOUNCEMENT,function(e,n){if("user_info_change"===e&&n.defaultDatabase){var i=t.getDbSelectionFromUserData();t.model.set("collections",i||t.model.defaults.collections),t.view.triggerMethod("changeToCollections",i||t.model.defaults.collections)}})},onNewSearch:function(){this.model.set(this.model.defaults),this.view.triggerMethod("reset")},setFocus:function(e){var t=_.bind(this.view.$,this.view);!function n(i){var a=t(e);if(a.is(":visible")||i<=0)return a.focus();setTimeout(n,100,--i)}(10)},onShow:function(){this.view.$("button[type=submit]").each(function(){$(this).html('<i class="fa fa-search"></i> Search')}),this.setFocus("#classic-author");var e=this.getDbSelectionFromUserData();this.model.set("collections",e||this.model.defaults.collections),this.view.triggerMethod("changeToCollections",e||this.model.defaults.collections)},getDbSelectionFromUserData:function(){try{var e=this.getBeeHive().getObject("User").getUserData(),t=!1,n=e.defaultDatabase.reduce(function(e,n){return n.value&&(t=!0),e[n.name.toLowerCase()]=n.value,e},{});return t?n:null}catch(e){return null}},submitForm:function(e){var n=_.assign({},e,{q:e.q.join(" ")});n=new t(n);var i=this.getPubSub(),a={q:n,context:{referrer:"ClassicSearchForm"}};i.publish(i.NAVIGATE,"search-page",a),r("send","event","interaction","classic-form-submit",JSON.stringify(e))},dontKillMe:!0})}),define("js/widgets/facet/actions",["underscore"],function(e){var t={data_requested:function(e){return{type:"DATA_REQUESTED",id:e}},reset_visible:function(e){return{type:"RESET_VISIBLE",id:e}},increase_visible:function(e){return function(n,i){(e?i().facets[e].children.length:i().children.length)-((e?i().facets[e].state.visible:i().state.visible)+5)<=5&&n(this.fetch_data(e)),n({type:"INCREASE_VISIBLE",id:e,num:5}),i().state.selected.indexOf(e)>-1&&n(t.select_facet(e))}.bind(this)},data_received:function(e,t){return{type:"DATA_RECEIVED",data:e,id:t}},toggle_facet:function(t,n){return function(i,a){var r=t?a().facets[t].state.open:a().state.open;n=e.isBoolean(n)?n:!r;var s=t?a().facets[t].children.length:a().children.length;n&&!s&&i(this.fetch_data(t)),i({type:"FACET_TOGGLED",open:n,id:t})}.bind(this)},fetch_data:function(e,t){throw new Error("this was supposed to be overridden!")},select_facet:function(e){return{type:"FACET_SELECTED",id:e}},unselect_facet:function(e){return{type:"FACET_UNSELECTED",id:e}},submit_filter:function(e){throw new Error("this was supposed to be overridden!")},reset_state:function(){return{type:"RESET_STATE"}}};return function(){return Object.create(t)}}),define("js/widgets/facet/reducers",["underscore"],function(e){function t(e,n){switch(e||(e=t.getDefaultState()),n.type){case"DATA_REQUESTED":return t.dataRequested(e,n.id);case"DATA_RECEIVED":return t.dataReceived(e,n.data,n.id);case"INCREASE_VISIBLE":return t.increaseVisible(e,n.num,n.id);case"RESET_VISIBLE":return t.resetVisible(e,n.id);case"FACET_SELECTED":return t.facetSelected(e,n.id);case"FACET_UNSELECTED":return t.facetUnselected(e,n.id);case"FACET_TOGGLED":return t.facetToggled(e,n.open,n.id);case"SUBMIT_FILTER":return t.submitFilter(e,n.logicOption);case"RESET_STATE":return t.getDefaultState(e);default:return e}}function n(e){var t=e.split("/");if(t.length>2){var n=t[t.length-2];return n=parseInt(e[0])-1+"/"+n}}function i(t,n,i,a){if(a=a||"state",!n){var r=e.assign({},t);return r[a]=e.assign({},t[a],i),r}var s={};return s[n]=e.assign({},t.facets[n]),s[n][a]=e.assign({},t.facets[n][a],i),e.assign({},t,{facets:e.assign({},t.facets,s)})}return t.getActiveFacets=function(e,t){return t.map(function(e){return!(t.indexOf(n(e))>-1)&&e}).filter(function(e){if(e)return e})},t.facetSelected=function(t,n){var i=t.facets[n].state.visible,a=e.unique(t.state.selected.concat(t.facets[n].children.slice(0,i).concat([n]))),r=e.filter(e.pairs(t.facets),function(e){return e[1].children.indexOf(n)>-1});if(r.length){r=r[0][0];var s=t.facets[r],o=s.children.slice(0,s.state.visible);e.intersection(a,o).length===o.length&&(a=a.concat([r]))}return e.assign({},t,{state:e.assign({},t.state,{selected:a})})},t.facetUnselected=function(t,i){var a=e.without(t.state.selected,i),r=n(i);return r&&(a=e.without(a,r)),a=e.without.apply(void 0,[a].concat(t.facets[i].children)),e.assign({},t,{state:e.assign({},t.state,{selected:a})})},t.resetVisible=function(e,t){return i(e,t,{visible:5})},t.increaseVisible=function(e,t,n){return i(e,n,n?{visible:e.facets[n].state.visible+t}:{visible:e.state.visible+t})},t.facetToggled=function(e,t,n){return i(e,n,{open:t})},t.dataRequested=function(t,n){if(n)a=e.assign({},t.facets[n].pagination,{state:"loading"});else var a=e.assign({},t.pagination,{state:"loading"});return i(t,n,a,"pagination")},t.processData=function(n,i){i=i||[],e.isFunction(i)&&(i=[i]);n=n.map(function(i,a){if(a%2==0)return{name:i.split("/")[i.split("/").length-1],value:i,count:n[a+1],pagination:e.assign({},e.cloneDeep(t.defaultState.pagination)),children:[],state:e.assign({},e.cloneDeep(t.defaultState.state))}}).filter(function(e){if(e)return e});return e.compose.apply(e,i)(n)},t.dataReceived=function(n,i,a){var r=i.facet_counts.facet_fields[Object.keys(i.facet_counts.facet_fields)[0]],s=r.length/2!=parseInt(i.responseHeader.params["facet.limit"]),o=(r=t.processData(r,n.config.preprocessors)).map(function(e){return e.value});if(r=e.object(o,r),!a)return e.assign({},n,{pagination:e.assign({},n.pagination,{state:"success",finished:s}),facets:e.assign({},n.facets,r),children:n.children.concat(o)});var l=e.assign({},n.facets[a],{children:n.facets[a].children.concat(o),pagination:e.assign({},n.facets[a].pagination,{state:"success",finished:s})}),c=e.assign({},n.facets,r);if(c[a]=l,n.state.selected.indexOf(a)>-1)var u=e.uniq(n.state.selected.concat(o.slice(0,n.facets[a].state.visible)));else u=n.state.selected;return e.assign({},n,{facets:c,state:e.assign({},n.state,{selected:u})})},t.submitFilter=function(e){throw new Error("this should be overridden by the widget")},t.defaultState={config:{preprocessors:[],hierMaxLevels:1,facetField:void 0,openByDefault:!1},state:{open:!1,visible:5,selected:[]},pagination:{state:void 0,finished:!1},children:[],facets:{}},t.getDefaultState=function(t){return e.assign({},this.defaultState,{config:t.config})},t}),define("js/widgets/facet/create_store",["underscore","redux","redux-thunk","js/widgets/facet/reducers"],function(e,t,n,i){return function(a){a={config:e.assign({},i.defaultState.config,a)};var r=e.assign({},e.cloneDeep(i.defaultState),a);return t.createStore(i,r,t.applyMiddleware(n.default))}}),define("js/widgets/facet/toggle_list.jsx",["react","underscore","d3","react-prop-types","create-react-class"],function(e,t,n,i,a){var r=a({displayName:"FacetCheckbox",format:function(e){return n.format("s")(e).replace(/\.\d{2,}/,function(e){return e.slice(0,2)}).replace(".0","")},updateFacetSelect:function(e){e.target.checked?(this.props.selectFacet(this.props.id),this.props.reduxState&&2===this.props.reduxState.config.hierMaxLevels&&this.props.toggleFacet(this.props.id,!0)):this.props.unselectFacet(this.props.id)},render:function(){var t="";this.props.reduxState&&(t="facet-label__title_".concat(this.props.reduxState.config.facetField,"_").concat(this.props.label));var n=e.createElement("label",{className:"facet-label"},e.createElement("input",{type:"checkbox",onChange:this.updateFacetSelect,checked:this.props.isChecked,"aria-describedby":t})," ",e.createElement("span",null,e.createElement("span",{className:"facet-label__title",id:t},this.props.name),e.createElement("span",{className:"facet-label__amount",title:this.props.count},this.format(this.props.count))));return this.props.hierarchical?e.createElement(s,{id:this.props.value,reduxState:this.props.reduxState,currentLevel:this.props.currentLevel+1,showMoreFacets:this.props.showMoreFacets,resetVisibleFacets:this.props.resetVisibleFacets,toggleFacet:this.props.toggleFacet,selectFacet:this.props.selectFacet,unselectFacet:this.props.unselectFacet},n):n},propTypes:{isChecked:i.bool.isRequired,name:i.string.isRequired,count:i.number.isRequired,reduxState:i.object,currentLevel:i.number,showMoreFacets:i.func,resetVisibleFacets:i.func,toggleFacet:i.func,selectFacet:i.func,unselectFacet:i.func}}),s=a({displayName:"ToggleList",render:function(){var n=1===this.props.currentLevel?this.props.reduxState:this.props.reduxState.facets[this.props.id],i=n.state.open,a=n.state.visible,s=n.pagination.finished||!1,o=t.values(t.pick(this.props.reduxState.facets,n.children)),l="";if("loading"===n.pagination.state?l=e.createElement("span",null,"loading..."):"failure"===n.pagination.state?l=e.createElement("span",null,e.createElement("i",{className:"icon-danger"}),"request failed"):"success"!==n.pagination.state||o.length||(l=e.createElement("span",null,"no data retrieved")),o.length)c=o.slice(0,a).map(function(n,i){var a={isChecked:this.props.reduxState.state.selected.indexOf(n.value)>-1,name:n.name,count:n.count,hierarchical:this.props.reduxState.config.hierMaxLevels>this.props.currentLevel,value:n.value,id:n.value,selectFacet:this.props.selectFacet,unselectFacet:this.props.unselectFacet,label:i};return a.hierarchical&&t.extend(a,t.pick(this.props,["showMoreFacets","resetVisibleFacets","toggleFacet","reduxState","currentLevel"])),e.createElement("li",{key:n.value},e.createElement(r,a))},this);else var c=e.createElement("li",null);var u,h=!s||o.length>a?"btn btn-default btn-xs facet__pagination-button":" hidden",d=a>5?"btn btn-default btn-xs facet__pagination-button":"hidden",p=this.props.currentLevel>1?"facet__list-container facet__list-container--child":"facet__list-container";return i&&(u=e.createElement("div",{className:p},e.createElement("ul",{className:"facet__list"},c),e.createElement("div",{className:"facet__state-message"},l),e.createElement("div",{className:"facet__pagination-container"},e.createElement("button",{className:d,onClick:t.partial(this.props.resetVisibleFacets,this.props.id)},"less"),e.createElement("button",{className:h,onClick:t.partial(this.props.showMoreFacets,this.props.id)},"more")))),e.createElement("div",null,e.createElement("div",{className:"facet__toggle"},e.createElement("i",{className:i?"facet__icon facet__icon--open":"facet__icon facet__icon--closed",onClick:t.partial(this.props.toggleFacet,this.props.id,!i)})," ",this.props.children),u)},propTypes:{reduxState:i.object.isRequired,currentLevel:i.number.isRequired,showMoreFacets:i.func.isRequired,resetVisibleFacets:i.func.isRequired,toggleFacet:i.func.isRequired,selectFacet:i.func.isRequired,unselectFacet:i.func.isRequired}});return s}),define("js/widgets/facet/facet-container.jsx",["react","react-redux","underscore","./toggle_list.jsx","./reducers","create-react-class"],function(e,t,n,i,a,r){var s=r({displayName:"ContainerComponent",createDropdown:function(){return 0===this.props.activeFacets.length?"":this.props.activeFacets.length>25?e.createElement("div",{className:"facet__dropdown"},"select no more than 25 facets at a time"):"invalid choice"==(t=1===this.props.activeFacets.length?this.props.reduxState.config.logicOptions.single:this.props.reduxState.config.logicOptions.multiple)[0]?e.createElement("div",{className:"facet__dropdown"},"invalid choice!"):e.createElement("div",{className:"facet__dropdown"},e.createElement("div",{className:"facet__dropdown__title"},e.createElement("b",null,this.props.activeFacets.length)," selected"),t.map(function(t){return e.createElement("label",{key:t},e.createElement("input",{type:"radio",onChange:n.partial(this.props.submitFilter,t)})," ",t)},this));var t},render:function(){var t=e.createElement("h3",{className:"facet__header",onClick:n.partial(this.props.toggleFacet,void 0)},this.props.reduxState.config.facetTitle);return e.createElement("div",{className:"facet__container"},e.createElement(e.addons.CSSTransitionGroup,{transitionName:"swoop",transitionEnterTimeout:300,transitionLeaveTimeout:300},this.createDropdown()),e.createElement(i,{reduxState:this.props.reduxState,currentLevel:1,showMoreFacets:this.props.showMoreFacets,resetVisibleFacets:this.props.resetVisibleFacets,toggleFacet:this.props.toggleFacet,selectFacet:this.props.selectFacet,unselectFacet:this.props.unselectFacet},t))}});return t.connect(function(e,t){return{reduxState:e,activeFacets:a.getActiveFacets(e,e.state.selected)}},function(e,t){return{selectFacet:function(n){e(t.actions.select_facet(n))},unselectFacet:function(n){e(t.actions.unselect_facet(n))},toggleFacet:function(n,i){e(t.actions.toggle_facet(n,i))},showMoreFacets:function(n){e(t.actions.increase_visible(n))},resetVisibleFacets:function(n){e(t.actions.reset_visible(n))},submitFilter:function(n){e(t.actions.submit_filter(n))}}})(s)}),define("js/widgets/facet/widget",["backbone","js/components/api_query","js/components/api_request","js/widgets/base/base_widget","js/components/api_query_updater","analytics","react","react-dom","react-redux","./facet-container.jsx","./actions","./reducers","./create_store","utils"],function(e,t,n,i,a,r,s,o,l,c,u,h,d,p){var f=e.View.extend({render:function(e,t){return o.render(s.createElement(l.Provider,{store:e},s.createElement(c,{actions:t})),this.el),this},destroy:function(){o.unmountComponentAtNode(this.el)}});return i.extend({initialize:function(e){e=e||{};var t=_.pick(e,["facetTitle","facetField","preprocessors","hierMaxLevels","logicOptions","openByDefault"]);this.defaultQueryArguments=_.extend({},this.defaultQueryArguments,e.defaultQueryArguments,{"facet.field":e.facetField}),this.store=d(t),this.actions=u(),this.queryUpdater=new a(t.facetField),this.actions.fetch_data=function(e){return this._dispatchRequest.bind(this,e)}.bind(this),this.actions.submit_filter=function(e){return this.submitFilter.bind(this,e)}.bind(this),this.view=new f,this.view.render=_.partial(this.view.render,this.store,this.actions),e.debug||(this._dispatchRequest=_.debounce(_.bind(this._dispatchRequest,this),300))},defaultQueryArguments:{facet:"true","facet.mincount":"1","facet.limit":20,fl:"id"},activate:function(e){this.setBeeHive(e),_.bindAll(this,"dispatchRequest","processResponse"),this.getPubSub().subscribe(this.getPubSub().INVITING_REQUEST,this.dispatchRequest),this.activateWidget(),this.attachGeneralHandler(this.onApiFeedback),window.store?window.store.push(this.store):window.store=[this.store]},onApiFeedback:function(){var e=this.store.dispatch;setTimeout(function(){e({type:"FACET_TOGGLED",open:!1})},300),this.updateState(this.STATES.ERRORED)},dispatchRequest:function(e){this._sortChanged(e)||(this.setCurrentQuery(e),this.store.dispatch(this.actions.reset_state()),this.store.getState().config.openByDefault&&this.store.dispatch(this.actions.toggle_facet(void 0,!0)))},_sortChanged:function(e){try{var t=p.difference(e.toJSON(),this.getCurrentQuery().toJSON())}catch(e){}return t&&t.sort&&1===_.keys(t).length},_dispatchRequest:function(e){var t=this.getPubSub(),n=this,i=this.getCurrentQuery();this.store.dispatch(this.actions.data_requested(e)),t.subscribeOnce(t.DELIVERING_RESPONSE,function(t){n.store.dispatch(n.actions.data_received(t.toJSON(),e)),n.updateState(n.STATES.IDLE)});var a=this.customizeQuery(i),r=(e?this.store.getState().facets[e].children:this.store.getState().children).length||0;a.set("facet.offset",r),a.set("rows",1),e&&a.set("facet.prefix",e.replace("0/","1/"));var s=this.composeRequest(a);t.publish(t.DELIVERING_REQUEST,s),this.updateState(this.STATES.LOADING)},submitFilter:function(e){if(-1===["and","or","limit to","expand","exclude"].indexOf(e))throw new Error("we don't recognize this operator you're trying to filter on");var t=this.getCurrentQuery().clone();t.unlock();var n=this.store.getState().config.facetField,i="fq_"+n.replace("_facet_hier",""),a=h.getActiveFacets(this.store.getState(),this.store.getState().state.selected).map(function(e){return n+':"'+e+'"'});"and"==e||"limit to"==e?this.queryUpdater.updateQuery(t,i,"limit",a,{prefix:"filter_"}):"or"==e?this.queryUpdater.updateQuery(t,i,"expand",a,{prefix:"filter_"}):"exclude"!=e&&"not"!=e||(t.get(i)?this.queryUpdater.updateQuery(t,i,"exclude",a,{prefix:"filter_"}):(a.unshift("*:*"),this.queryUpdater.updateQuery(t,i,"exclude",a,{prefix:"filter_"}))),_.forEach(t.toJSON(),function(e,n){/^filter_/.test(n)&&e.length>3&&(t.unset(n),t.set("__"+n,e))});var s="{!type=aqp v=$"+i+"}",o=t.get("fq")||[];o.push(s),t.set("fq",_.unique(o)),t.unset("facet.prefix"),t.unset("facet"),t.unset("start"),t.unset("rows"),this.dispatchNewQuery(t),r("send","event","interaction","facet-applied",JSON.stringify({name:n,logic:e,conditions:a}))}})}),define("js/widgets/facet/graph-facet/widget",["underscore","utils","js/widgets/base/base_widget","js/components/api_query_updater"],function(e,t,n,i){return n.extend({initialize:function(t){t=t||{},this.processResponse=t.processResponse,this.model=new Backbone.Model,this.view=new t.graphView(e.extend(t.graphViewOptions,{model:this.model})),this.isActive=!1,this.isDone=!1,this.listenTo(this.view,"all",this.onAllInternalEvents),this.facetField=t.facetField,this.queryUpdater=new i(this.facetField),n.prototype.initialize.apply(this,arguments),this.listenTo(this.view,"facet-applied",this.handleConditionApplied),this.on("active",this.onActive),this.on("hidden",this.onHidden),this.dispatchRequest=e.debounce(e.bind(this.dispatchRequest,this),300)},activate:function(t){this.setBeeHive(t),e.bindAll(this,"dispatchRequest","processResponse","onInvitingRequest");var n=this.getPubSub();n.subscribe(n.INVITING_REQUEST,this.onInvitingRequest),n.subscribe(n.DELIVERING_RESPONSE,this.processResponse),this.activateWidget(),this.attachGeneralHandler(this.onFeedback)},onInvitingRequest:function(e){this._sortChanged.call(this,e)||(this.isDone=!1,this.setCurrentQuery(e),this.dispatchRequest(e),this.updateState(this.STATES.LOADING))},_sortChanged:function(n){try{var i=t.difference(n.toJSON(),this.getCurrentQuery().toJSON())}catch(e){}return i&&i.sort&&1===e.keys(i).length},dispatchRequest:function(e){if(this.isActive&&!this.isDone&&e.has("q")){this.model.unset("graphData"),this.model.unset("statsCount");var t=this.customizeQuery(e),n=this.composeRequest(t),i=this.getPubSub();i.publish(i.DELIVERING_REQUEST,n),this.isDone=!0}},removeAnyOldConditions:function(t,n){var i=t.clone(),a=i.get("__"+this.facetField+"_"+n);if(a&&a.length>0){var r=e.last(a);i.get(n)[0].indexOf(r)>-1&&this.queryUpdater.updateQuery(i,n,"remove",r)}return i},handleConditionApplied:function(e){var t=this.getCurrentQuery();t.set("q",/^\(.*\)/.test(t.get("q")[0])?t.get("q")[0]:"("+t.get("q")[0]+")"),e=this.facetField+":"+e,t=t.clone(),t=this.removeAnyOldConditions(t,"q"),this.queryUpdater.updateQuery(t,"q","limit",e),this.dispatchNewQuery(t)},onActive:function(){!this.isActive&&this.isDone&&this.model.get("error")&&(this.isDone=!1,this.model.set("error",!1)),this.isActive=!0,this.dispatchRequest(this.getCurrentQuery())},onHidden:function(){this.isActive=!1},onFeedback:function(){this.model.set("error",!0),this.updateState(this.STATES.ERRORED)}})}),define("js/widgets/facet/factory",["js/widgets/facet/widget","js/widgets/facet/graph-facet/widget"],function(e,t){return{makeBasicCheckboxFacet:function(t){var n={facetTitle:t.facetTitle,displayNum:5,maxDisplayNum:100,facetField:t.facetField,openByDefault:!1,showOptions:!0,hierMaxLevels:1};return new e(_.extend(n,t))},makeHierarchicalCheckboxFacet:function(e){return e.hierMaxLevels=2,e.defaultQueryArguments=e.defaultQueryArguments||{},e.defaultQueryArguments["facet.prefix"]="0/",this.makeBasicCheckboxFacet.apply(this,arguments)},makeGraphFacet:function(e){return e=_.extend({openByDefault:!0},e),new t(e)}}}),define("hbs!js/widgets/footer/footer",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<footer>\n  <div class="__footer_wrapper">\n    <div class="__footer_brand">\n      &copy; The SAO/NASA Astrophysics Data System\n      <div class="__footer_brand_extra">\n        <p><i class="fa fa-envelope" aria-hidden="true"></i> adshelp[at]cfa.harvard.edu</p>\n        <p>\n          The ADS is operated by the Smithsonian Astrophysical Observatory under\n          NASA Cooperative Agreement <em>NNX16AC86A</em>\n        </p>\n      </div>\n      <div class="__footer_brand_logos">\n        <a href="http://www.nasa.gov" target="_blank" rel="noopener">\n          <img src="/styles/img/nasa.svg" alt="NASA logo" id="nasa-logo" />\n        </a>\n        <a href="http://www.si.edu" target="_blank" rel="noopener">\n          <img\n            id="smithsonian-logo"\n            src="/styles/img/smithsonian.svg"\n            alt="Smithsonian logo"\n          />\n        </a>\n        <a href="https://www.cfa.harvard.edu/" target="_blank" rel="noopener">\n          <img\n            src="/styles/img/cfa.png"\n            alt="Harvard Center for Astrophysics logo"\n            id="cfa-logo"\n          />\n        </a>\n      </div>\n    </div>\n    <div class="__footer_list">\n      <div class="__footer_list_title">\n        Resources\n      </div>\n      <ul class="__footer_links">\n        <li>\n          <a\n            href="//ui.adsabs.harvard.edu/about/"\n            target="_blank"\n            rel="noopener"\n          >\n            <i class="fa fa-question-circle" aria-hidden="true"></i> About ADS\n          </a>\n        </li>\n        <li>\n          <a href="//adsabs.github.io/help/" target="_blank" rel="noopener">\n            <i class="fa fa-info-circle" aria-hidden="true"></i> ADS Help\n          </a>\n        </li>\n        <li>\n          <a\n            href="//adsabs.github.io/help/whats_new/"\n            target="_blank"\n            rel="noopener"\n          >\n            <i class="fa fa-bullhorn" aria-hidden="true"></i> What\'s New\n          </a>\n        </li>\n        <li>\n          <a\n            href="//ui.adsabs.harvard.edu/about/careers/"\n            target="_blank"\n            rel="noopener"\n          >\n            <i class="fa fa-group" aria-hidden="true"></i> Careers@ADS\n          </a>\n        </li>\n        <li>\n          <a\n            href="//adsabs.github.io/help/accessibility/"\n            target="_blank"\n            rel="noopener"\n          >\n            <i class="fa fa-universal-access" aria-hidden="true"></i>\n            Accessibility\n          </a>\n        </li>\n      </ul>\n    </div>\n    <div class="__footer_list">\n      <div class="__footer_list_title">\n        Social\n      </div>\n      <ul class="__footer_links">\n        <li>\n          <a href="//twitter.com/adsabs" target="_blank" rel="noopener">\n            <i class="fa fa-twitter" aria-hidden="true"></i> @adsabs\n          </a>\n        </li>\n        <li>\n          <a href="//adsabs.github.io/blog/" target="_blank" rel="noopener">\n            <i class="fa fa-newspaper-o" aria-hidden="true"></i> ADS Blog\n          </a>\n        </li>\n      </ul>\n    </div>\n    <div class="__footer_list">\n      <div class="__footer_list_title">\n        Project\n      </div>\n      <ul class="__footer_links">\n        <li>\n          <a href="https://ui.adsabs.harvard.edu/core">Switch to basic HTML</a>\n        </li>\n        <li>\n          <a href="https://adsabs.github.io/help/privacy/" target="_blank" rel="noopener"\n          >Privacy Policy</a\n          >\n        </li>\n        <li>\n          <a href="https://adsabs.github.io/help/terms" target="_blank" rel="noopener"\n          >Terms of Use</a\n          >\n        </li>\n        <li>\n          <a\n          href="http://www.cfa.harvard.edu/sao"\n          target="_blank"\n          rel="noopener"\n          >Smithsonian Astrophysical Observatory</a\n          >\n        </li>\n        <li>\n          <a href="http://www.si.edu" target="_blank" rel="noopener"\n            >Smithsonian Institution</a\n          >\n        </li>\n        <li>\n          <a href="http://www.nasa.gov" target="_blank" rel="noopener">NASA</a>\n        </li>\n      </ul>\n    </div>\n  </div>\n</footer>\n'},useData:!0});return t.registerPartial("js/widgets/footer/footer",n),n}),define("js/widgets/footer/widget",["marionette","hbs!js/widgets/footer/footer"],function(e,t){return e.ItemView.extend({template:t,className:"footer s-footer"})}),define("hbs!js/widgets/navbar/template/navbar",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){return'            <a class="navbar-brand s-navbar-brand" href="#"><img class="s-ads-icon" src="/styles/img/transparent_logo.svg" alt="ads icon"/>\n                <h1> <b>ads</b></h1>\n            </a>\n'},3:function(e,t,n,i){return'            <div class="s-hourly-warning">\n                <a class="navbar-brand s-navbar-brand" href="#"><i class="icon-danger fa-2x"></i> ADS TEST</a>\n                <span> Nothing you do here will be saved!  <a href="https://ui.adsabs.harvard.edu/">I want the real ADS <i class="fa fa-arrow-right"></i></a>\n                </span>\n            </div>\n'},5:function(e,t,n,i){var a;return"\n"+(null!=(a=t.if.call(e,null!=e?e.orcidModeOn:e,{name:"if",hash:{},fn:this.program(6,i,0),inverse:this.program(11,i,0),data:i}))?a:"")+'                \x3c!--end "if/else orcidModeOn"--\x3e\n\n'},6:function(e,t,n,i){var a;return'\n                <li class="dropdown orcid-dropdown s-orcid-dropdown">\n                    <button class="btn btn-link" data-toggle="dropdown" aria-expanded="false">\n                        <span class="s-orcid-title">\n                         <img src="../../styles/img/orcid-active.svg" alt="orcid symbol"/>\n                            ORCID\n                            <span class="caret"></span></button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li class="no-hover-style">\n                            '+(null!=(a=t.if.call(e,null!=e?e.orcidLastName:e,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?a:"")+'\n                            <div class="s-orcid-mode-label"><b>ORCID Mode</b></div>\n                            <div class="s-orcid-label-container">\n                                off\n                                <div class="switch">\n                                    <input id="cmn-toggle-1" class="cmn-toggle cmn-toggle-round orcid-mode" type="checkbox" checked="checked">\n                                    <label for="cmn-toggle-1"></label>\n                                </div>\n                                on\n                            </div>\n                        </li>\n\n                        <li class="divider"></li>\n                        <li>\n                            <a class="orcid-link" href="#user/orcid" >View my ORCID papers in ADS </a>\n                        </li>\n'+(null!=(a=t.if.call(e,null!=e?e.orcidURI:e,{name:"if",hash:{},fn:this.program(9,i,0),inverse:this.noop,data:i}))?a:"")+'                        <li>\n                            <a href="#orcid-instructions"> <i class="fa fa-info-circle"></i> Learn how to make ORCID claims using ADS</a>\n                        </li>\n                        <li class="divider"></li>\n                        <li>\n                            <a href="javascript:void(0)" class="orcid-logout" >Log out from ORCID in ADS</a>\n                        <li>\n\n                    </ul>\n                </li>\n\n'},7:function(e,t,n,i){var a;return" <h4> Signed in to ORCID as <br/> <strong>"+this.escapeExpression("function"==typeof(a=null!=(a=t.orcidFirstName||(null!=e?e.orcidFirstName:e))?a:t.helperMissing)?a.call(e,{name:"orcidFirstName",hash:{},data:i}):a)+" "+this.escapeExpression("function"==typeof(a=null!=(a=t.orcidLastName||(null!=e?e.orcidLastName:e))?a:t.helperMissing)?a.call(e,{name:"orcidLastName",hash:{},data:i}):a)+"</strong></h4> "},9:function(e,t,n,i){return'                        <li>\n                            <a href="https://orcid.org/my-orcid" target="_blank" rel="noopener" >View my ORCID profile on orcid.org </a>\n                        </li>\n'},11:function(e,t,n,i){var a;return'\n                <li class="dropdown orcid-dropdown s-orcid-dropdown">\n                    <button class="btn-link" data-toggle="dropdown" aria-expanded="false">\n                        <span class="s-orcid-title"> <img src="../../styles/img/orcid_inactive.png"\n                                                          alt="orcid symbol"/> ORCID  <span class="caret"></span></button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li class="no-hover-style">\n                            '+(null!=(a=t.if.call(e,null!=e?e.orcidLastName:e,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?a:"")+'\n                            <div class="s-orcid-mode-label"><b>ORCID Mode</b></div>\n                            <div class="s-orcid-label-container">\n                                off\n                                <div class="switch clearfix">\n                                    <input id="cmn-toggle-1" class="cmn-toggle cmn-toggle-round orcid-mode" type="checkbox">\n                                    <label for="cmn-toggle-1"></label>\n                                </div>\n                                on\n                            </div>\n                        </li>\n                        <li style="clear:both" class="no-hover-style">You have turned off the ORCID view for the ADS search results page, but are still logged in.</li>\n                        <li class="divider"></li>\n                        <li>\n                            <a class="orcid-link" href="#user/orcid" > View my ORCID papers in ADS</a>\n                        </li>\n'+(null!=(a=t.if.call(e,null!=e?e.orcidURI:e,{name:"if",hash:{},fn:this.program(9,i,0),inverse:this.noop,data:i}))?a:"")+'                        <li>\n                            <a href="#orcid-instructions"> <i class="fa fa-info-circle"></i> Learn how to claim ORCID papers</a>\n                        </li>\n                        <li class="divider"></li>\n                        <li>\n                            <a class="orcid-logout" >Log out from ORCID</a>\n                        </li>\n                    </ul>\n                </li>\n\n'},13:function(e,t,n,i){return'\n                <li class="dropdown orcid-dropdown s-orcid-dropdown">\n                    <button class="dropdown-toggle btn-link" data-toggle="dropdown" aria-expanded="false">\n                        <span class="s-orcid-title"> <img src="../../styles/img/orcid_inactive.png"\n                                                          alt="orcid symbol"/>  ORCID  <span class="caret"></span></button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li class="no-hover-style" >\n                            <button class="btn-link orcid-sign-in"> Sign in to ORCID to claim papers in the ADS. </button>\n                        </li>\n                    </ul>\n                </li>\n\n                \x3c!--end "if/else orcidLoggedIn"--\x3e\n\n'},15:function(e,t,n,i){var a;return'\n                \x3c!-- Single button --\x3e\n                <li class="dropdown account-dropdown">\n                    <button type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false">\n                     <i class="fa fa-user"></i> Account <span class="caret"></span>\n                    </button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li class="no-hover-style" style="padding:15px 10px;">You are signed in as <br/> <b>'+this.escapeExpression("function"==typeof(a=null!=(a=t.currentUser||(null!=e?e.currentUser:e))?a:t.helperMissing)?a.call(e,{name:"currentUser",hash:{},data:i}):a)+'</b></li>\n                        <li ><a href="#user/home"> <i class="fa fa-user"></i> My Home Page</a></li>\n                        <li><a href="#user/libraries"> <i class="fa fa-book"></i> ADS Libraries</a></li>\n                        <li><a href="#user/settings/librarylink"> <i class="fa fa-cog"></i> Customize Settings</a></li>\n                        <li class="divider"></li>\n                        <li><a href="javascript:void(0)" class="logout">Log Out</a></li>\n                    </ul>\n                </li>\n\n'},17:function(e,t,n,i){return'                <li class="register"><a href="#user/account/register">Sign Up</a></li>\n                <li class="login"><a href="#user/account/login">Log In</a></li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a;return'<nav class="navbar fluid navbar-inverse" aria-label="main navigation">\n        \x3c!-- Brand and toggle get grouped for better mobile display --\x3e\n        <div class="navbar-header">\n            <button type="button" class="navbar-toggle" data-toggle="collapse"\n                    data-target="#bs-example-navbar-collapse-1">\n                <span class="sr-only">Toggle navigation</span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n            </button>\n'+(null!=(a=t.unless.call(e,null!=e?e.hourly:e,{name:"unless",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?a:"")+'        </div>\n\n        \x3c!-- Collect the nav links, forms, and other content for toggling --\x3e\n        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n\n            <ul class="nav navbar-nav navbar-right">\n\n                <li class="dropdown">\n                  <button type="button" class="btn btn-primary-faded feedback-button open-feedback-button" data-toggle="dropdown" aria-expanded="false">\n                    Feedback <span class="caret"></span>\n                  </button>\n                  <ul class="dropdown-menu" role="menu">\n                    <li>\n                      <a href="javascript:void(0);" data-target="#feedback-modal" data-toggle="modal" data-feedback-view="list">\n                        <i class="fa fa-pencil"></i> Submit Updates\n                      </a>\n                    </li>\n                    <li>\n                      <a href="javascript:void(0);" data-target="#feedback-modal" data-toggle="modal" data-feedback-view="general">\n                        <i class="fa fa-envelope"></i> General Feedback\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n'+(null!=(a=t.if.call(e,null!=e?e.orcidLoggedIn:e,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.program(13,i,0),data:i}))?a:"")+'\n                <li class="dropdown">\n                    <button type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false">\n                      <i class="fa fa-question-circle about-page-icon"></i> About <span class="caret"></span>\n                    </button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li> <a href="//ui.adsabs.harvard.edu/about/" target="_blank" rel="noopener"> <i class="fa fa-question-circle"></i> About ADS </a></li>\n                        <li> <a href="//adsabs.github.io/help/whats_new/" target="_blank" rel="noopener"> <i class="fa fa-bullhorn"></i> What\'s New </a></li>\n                        <li> <a href="//adsabs.github.io/blog/" target="_blank" rel="noopener"> <i class="fa fa-newspaper-o"></i> ADS Blog </a></li>\n                        <li> <a href="//adsabs.github.io/help/" target="_blank" rel="noopener"> <i class="fa fa-info-circle"></i> ADS Help Pages </a></li>\n                        <li> <a href="//ui.adsabs.harvard.edu/about/careers/" target="_blank" rel="noopener"> <i class="fa fa-group"></i> Careers@ADS </a></li>\n                    </ul>\n                </li>\n\n\n'+(null!=(a=t.if.call(e,null!=e?e.currentUser:e,{name:"if",hash:{},fn:this.program(15,i,0),inverse:this.program(17,i,0),data:i}))?a:"")+"\n            </ul>\n\n        </div>\n        \x3c!-- /.navbar-collapse --\x3e\n    </div>\n</nav>\n\x3c!-- /.container-fluid --\x3e\n"},useData:!0});return t.registerPartial("js/widgets/navbar/template/navbar",n),n}),define("hbs!js/widgets/navbar/template/feedback",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="modal fade" id="feedback-modal">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <p class="modal-title">\n                  <span class="btn-group" id="feedback-back-btn" style="display: none">\n                    <button class="btn btn-sm btn-default">\n                      <i class="fa fa-chevron-left"></i> Back\n                    </button>\n                  </span>\n                  <span id="feedback-modal-title">How may we help you?</span>\n                </p>\n            </div>\n            <div class="modal-body">\n\n              <div class="list-group" id="feedback-select-group">\n                <a href="http://adsabs.harvard.edu/adsfeedback/submit_abstract.php" id="feedback_submit_abstract_link" class="list-group-item" target="_blank" rel="noopener">\n                  <h4>Missing/Incorrect Record</h4>\n                  <p>Submit a missing record or correct an existing record.</p>\n                </a>\n                <a href="http://adsabs.harvard.edu/adsfeedback/submit_missing_references.php" class="list-group-item" target="_blank" rel="noopener">\n                  <h4>Missing References</h4>\n                  <p>Submit missing references to an existing ADS record.</p>\n                </a>\n                <a href="http://adsabs.harvard.edu/adsfeedback/submit_associated_references.php" class="list-group-item" target="_blank" rel="noopener">\n                  <h4>Associated Articles</h4>\n                  <p>Submit associated articles to an existing record (e.g. arXiv / published paper).</p>\n                </a>\n                <a href="javascript:void(0);" class="list-group-item" id="open-general-feedback">\n                  <h4>General Feedback</h4>\n                  <p>Send your comments and suggestions for improvements.</p>\n                </a>\n              </div>\n              <form id="feedback-general-form" class="feedback-form" style="display: none">\n                <input type="hidden" name="_subject" value="Bumblebee Feedback" />\n                <input type="hidden" name="feedback-type" value="feedback" />\n\n                <input type="text" name="_gotcha" style="display:none" />\n\n                <div class="form-group half-width">\n                  <label> Name\n                      <input class="form-control" type="text" name="name" required autofocus>\n                  </label>\n                </div>\n                <div class="form-group half-width">\n                  <label> Email\n                    <input class="form-control" type="email" name="_replyto" required>\n                  </label>\n                </div>\n\n                <div class="form-group">\n                  <label>Feedback <br/>\n                    <textarea rows="8" cols="50" name="comments" required style="min-width: 500px; min-height: 180px"/>\n                  </label>\n                </div>\n                <div class="form-group">\n                    <button class="btn btn-success" type="submit" value="Send">Submit</button>\n                </div>\n\n                <div class="form-group">\n                    <div class="g-recaptcha"></div>\n                </div>\n                <div class="form-group">\n                  <p class="alert alert-info text-center">You can also reach us at <b>adshelp [at] cfa.harvard.edu</b></p>\n                </div>\n              </form>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close without submitting</button>\n            </div>\n        </div>\x3c!-- /.modal-content --\x3e\n    </div>\x3c!-- /.modal-dialog --\x3e\n</div>\x3c!-- /.modal --\x3e\n'},useData:!0});return t.registerPartial("js/widgets/navbar/template/feedback",n),n}),define("js/widgets/navbar/widget",["underscore","marionette","js/widgets/base/base_widget","hbs!js/widgets/navbar/template/navbar","hbs!js/widgets/navbar/template/feedback","js/components/api_query_updater","js/components/api_query","js/components/api_request","js/components/api_targets","utils","bootstrap"],function(e,t,n,i,a,r,s,o,l,c){var u,h;return h=Backbone.Model.extend({defaults:function(){return{orcidModeOn:!1,orcidLoggedIn:!1,currentUser:void 0,orcidFirstName:void 0,orcidLastName:void 0,hourly:!1,timeout:6e5}}}),u=t.ItemView.extend({initialize:function(){window.__BUMBLEBEE_TESTING_MODE__||(this.onRender=e.debounce(this.onRender,500))},template:i,modelEvents:{change:"render"},events:{"click .orcid-dropdown ul":"stopPropagation","click button.orcid-sign-in":"orcidSignIn","change .orcid-mode":"changeOrcidMode","click .orcid-link":function(){this.trigger("navigate-to-orcid-link")},"click .orcid-logout":function(e){return this.trigger("logout-only-orcid"),!1},"click .logout":function(e){return this.trigger("logout"),!1},"click .login":function(){this.trigger("navigate-login")},"click .register":function(){this.trigger("navigate-register")},"click button.search-author-name":function(e){this.trigger("search-author")}},stopPropagation:function(e){if("button"==e.target.tagName.toLowerCase()||"a"==e.target.tagName.toLowerCase()||"code"==e.target.tagName.toLowerCase())return!0;e&&e.stopPropagation&&e.stopPropagation()},orcidSignIn:function(){this.model.set("orcidModeOn",!0),this.trigger("user-change-orcid-mode")},changeOrcidMode:function(t){var n=e.isBoolean(t)?t:t&&t.currentTarget&&t.currentTarget.checked;this.model.set("orcidModeOn",n),this.trigger("user-change-orcid-mode"),this.render()},_hiddenTmpl:e.template('<input type="hidden" name="<%= name %>" value="<%= value %>" />'),appendToForm:function(t,n){if(!e.isUndefined(n)){var i=$("#feedback-general-form","#feedback-modal"),a=$('input[type=hidden][name="'.concat(t,'"]'),i);a.length>0?a.attr("value",n):i.append(this._hiddenTmpl({name:t,value:n}))}},onRender:function(){var e=this;0===$("#feedback-modal").length&&$("body").append(a());var t=$("#feedback-modal"),n=$("#feedback-modal-title",t),i=$("#feedback-select-group",t),r=$("#feedback-general-form",t),s=$("#feedback-back-btn",t),o=$("a#feedback_submit_abstract_link",i),l=function(){i.show(),r.hide(),s.hide(),n.text("How may we help you today?")},c=function(){i.hide(),r.show(),n.text("General Feedback"),s.show(),s.off().click(function(){return l()}),t.one("shown.bs.modal",function(){$("input[name=name]",r).focus()})};t.on("hidden.bs.modal",function(){$("input, textarea",t).val(""),$("button[type=submit]",t).closest(".form-group").html('<button class="btn btn-success" type="submit" value="Send">Submit</button>'),l()}),t.on("show.bs.modal",function(e){"general"===$(e.relatedTarget).data("feedbackView")&&c()}),t.on("shown.bs.modal",function(){if(e.trigger("activate-recaptcha"),r.off().submit(function(n){return n.preventDefault(),e.trigger("feedback-form-submit",$(n.target),t),!1}),$("#open-general-feedback").off().click(function(){return c(),$("input[name=name]",r).focus(),!1}),e.model.has("currentUser")){var n=e.model.get("currentUser");$("input[name=_replyto]",r).val(n),e.appendToForm("currentuser",n)}else e.appendToForm("currentuser","anonymous");if(e.model.has("browser")){var i=e.model.get("browser"),a=i.browser,s=i.platform,l=i.engine,u=i.os;e.appendToForm("browser.name",a.name),e.appendToForm("browser.version",a.version),e.appendToForm("engine",l.name),e.appendToForm("platform",s.type),e.appendToForm("os",u.name)}e.model.has("page")&&e.appendToForm("current_page",e.model.get("page")),e.appendToForm("url",window.location.href),e.model.has("currentQuery")&&e.appendToForm("current_query",e.model.get("currentQuery")),"ShowAbstract"===e.model.get("page")&&e.model.has("bibcode")?o.attr("href",function(t,n){return n.indexOf("?")>-1?n:n+"?bibcode="+e.model.get("bibcode")}):o.attr("href",function(e,t){return t.replace(/\?.*$/,"")})}),setTimeout(function(){$("a",".account-dropdown").click(function(){$(".dropdown-toggle",".account-dropdown").dropdown("toggle")})},300)}}),n.extend({initialize:function(e){var t=this;e=e||{},this.model=new h,this.view=new u({model:this.model}),n.prototype.initialize.apply(this,arguments),this.qUpdater=new r("NavBar"),c.getBrowserInfo().then(function(e){t.model.set("browser",e)}).fail(function(){t.model.set("browser",null)})},activate:function(t){this.setBeeHive(t),e.bindAll(this,["handleUserAnnouncement","getOrcidUserInfo","storeLatestPage","onCustomEvent","onStartSearch"]);var n=this.getPubSub();n.subscribe(n.USER_ANNOUNCEMENT,this.handleUserAnnouncement),n.subscribe(n.APP_STARTED,this.getOrcidUserInfo),n.subscribe(n.NAVIGATE,this.storeLatestPage),n.subscribe(n.CUSTOM_EVENT,this.onCustomEvent),n.subscribe(n.START_SEARCH,this.onStartSearch),this.setInitialVals(),this.model.get("timer")||this.resetOrcidTimer()},onStartSearch:function(e){this.model.set("currentQuery",e.url())},onCustomEvent:function(e,t){"orcid-action"===e?this.resetOrcidTimer():"latest-abstract-data"===e&&this.onNewAbstractData(t)},storeLatestPage:function(e){this._latestPage=e,this.model.set("page",e)},onNewAbstractData:e.debounce(function(e){this.model.set("bibcode",e.bibcode)},500),resetOrcidTimer:function(){var t=this.model.get("timer"),n=this.model.get("timeout");t&&clearTimeout(t),this.model.get("orcidModeOn")&&(t=setTimeout(e.bind(this.toggleOrcidMode,this,!1),n),this.model.set("timer",t))},viewEvents:{"navigate-login":function(){this._navigate("authentication-page",{subView:"login"})},"navigate-register":function(){this._navigate("authentication-page",{subView:"register"})},"navigate-settings":function(){this._navigate("UserPreferences")},logout:function(){this.getBeeHive().getObject("Session").logout(),this.orcidLogout()},"feedback-form-submit":"submitForm","navigate-to-orcid-link":"navigateToOrcidLink","user-change-orcid-mode":"toggleOrcidMode","logout-only-orcid":"orcidLogout","search-author":"searchAuthor","activate-recaptcha":"activateRecaptcha"},submitForm:function(t,n){var i,a,r=this,s=function(){var e=t.serialize();e+="&user-agent-string="+encodeURIComponent(navigator.userAgent);var i=new o({target:l.FEEDBACK,options:{method:"POST",data:e,dataType:"json",done:function(e){t.find("button[type=submit]").html('<i class="icon-success"></i> Message sent!'),setTimeout(function(){n.modal("hide")},500)},fail:function(e){t.find("button[type=submit]").addClass("btn-danger").html('<i class="icon-danger"></i> There was an error!')},beforeSend:function(){t.find("button[type=submit]").html('<i class="icon-loading"></i> Sending form...')}}});r.getBeeHive().getService("Api").request(i)};i="g-recaptcha-response",a=!1,t.serializeArray().forEach(function(t){if(t.name===i&&!e.isEmpty(t.value))return a=!0}),a?s():this.getBeeHive().getObject("RecaptchaManager").execute().then(s)},navigateToOrcidLink:function(){this._navigate("orcid-page")},_navigate:function(e,t){var n=this.getPubSub();n.publish(n.NAVIGATE,e,t)},setInitialVals:function(){var e=this.getBeeHive().getObject("User"),t=this.getBeeHive().getService("OrcidApi").hasAccess();this.model.set({orcidModeOn:e.isOrcidModeOn()&&t,orcidLoggedIn:t}),this.model.set("currentUser",e.getUserName())},getOrcidUserInfo:function(){var e=this.getBeeHive().getService("OrcidApi");if(this.model.get("orcidLoggedIn")){var t=this;e.getUserBio().done(function(e){var n=e.getFirstName(),i=e.getLastName();t.model.set("orcidFirstName",n),t.model.set("orcidLastName",i),t.model.set("orcidQueryName",i+", "+n),t.model.set("orcidURI",e.getOrcid())})}var n=this.getBeeHive().getObject("AppStorage").getConfigCopy().hourly;this.model.set("hourly",n)},handleUserAnnouncement:function(t,n){var i=this.getBeeHive().getService("OrcidApi"),a=this.getBeeHive().getObject("User");t==a.USER_SIGNED_IN?this.model.set("currentUser",n):t==a.USER_SIGNED_OUT?this.model.set("currentUser",void 0):t==a.USER_INFO_CHANGE&&e.has(n,"isOrcidModeOn")&&(this.model.set({orcidModeOn:n.isOrcidModeOn,orcidLoggedIn:i.hasAccess()}),this.model.get("orcidLoggedIn")&&this.getOrcidUserInfo())},toggleOrcidMode:function(t){var n=this.getBeeHive().getObject("User"),i=this.getBeeHive().getService("OrcidApi"),a=e.isBoolean(t)?t:this.model.get("orcidModeOn");if(this.resetOrcidTimer(),a&&!i.hasAccess())return i.signIn();n.setOrcidMode(a),this.model.set("orcidModeOn",a)},searchAuthor:function(){var e=this.getPubSub();e.publish(e.START_SEARCH,new s({q:"author:"+this.qUpdater.quote(this.model.get("orcidQueryName"))}))},signOut:function(){var e=this.getBeeHive().getObject("User"),t=this.getBeeHive().getService("OrcidApi");t&&t.signOut(),e.setOrcidMode(!1)},orcidLogout:function(){var e=this.getPubSub();this.getBeeHive().getService("OrcidApi").signOut(),this.model.set("orcidLoggedIn",!1),this.getBeeHive().getObject("User").setOrcidMode(!1),"orcid-page"===this._latestPage&&e.publish(e.NAVIGATE,"index-page")},activateRecaptcha:function(){if(!this._activated){this._activated=!0;var e=new t.ItemView({el:"#feedback-modal"});this.getBeeHive().getObject("RecaptchaManager").activateRecaptcha(e)}}})}),define("hbs!js/widgets/paper_search_form/form",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="row" style="margin-bottom: 15px">\n  <div class="col-sm-12 well well-default">\n    <form class="form-horizontal" role="form" data-form-type="journal">\n      <legend>Journal Search</legend>\n      <div class="col-sm-12">\n        <div class="form-group help-block">\n          A bibstem is an abbreviation that the ADS uses to identify a journal.\n          <a\n            href="http://adsabs.harvard.edu/abs_doc/journal_abbr.html"\n            tabindex="-1"\n            >A full list is available here.</a\n          >\n          The input field below will autocomplete on the 1,000 most popular\n          journal names, allowing you to type "Astrophysical Journal", for\n          instance, to find the bibstem "ApJ".\n        </div>\n      </div>\n      <div class="col-sm-3">\n        <div class="form-group">\n          <label for="bibstem">Publication</label>\n          <input\n            type="text"\n            name="bibstem"\n            id="bibstem"\n            class="form-control"\n            autofocus\n          />\n        </div>\n      </div>\n      <div class="col-sm-2 col-sm-offset-1">\n        <div class="form-group">\n          <label for="year">Year</label>\n          <input\n            type="text"\n            name="year"\n            id="year"\n            class="form-control"\n            maxlength="4"\n          />\n        </div>\n      </div>\n      <div class="col-sm-2 col-sm-offset-1">\n        <div class="form-group">\n          <label for="volume">Volume</label>\n          <input type="text" name="volume" id="volume" class="form-control" />\n        </div>\n      </div>\n      <div class="col-sm-2 col-sm-offset-1">\n        <div class="form-group">\n          <label for="page">Page/ID</label>\n          <input type="text" name="page" id="page" class="form-control" />\n        </div>\n      </div>\n      <button type="submit" class="btn btn-primary">\n        <i class="fa fa-search" aria-hidden="true"></i> Search\n      </button>\n      <button type="reset" class="btn">\n        <i class="fa fa-times" aria-hidden="true"></i> Clear\n      </button>\n    </form>\n  </div>\n</div>\n\n<div class="row" style="margin-bottom: 15px">\n  <div class="well well-default col-sm-12">\n    <form class="form-horizontal" role="form" data-form-type="reference">\n      <legend>Reference Query</legend>\n      <div class="col-sm-12">\n        <div class="form-group">\n          <label for="reference">Reference</label>\n          <input\n            type="text"\n            name="reference"\n            id="reference"\n            class="form-control"\n            aria-describedby="reference_helper"\n            required\n          />\n          <span id="reference_helper" class="help-block"\n            >Enter a full reference string (eg Smith et al 2000, A&A 362, pp.\n            333-341)</span\n          >\n        </div>\n      </div>\n      <button type="submit" class="btn btn-primary">\n        <i class="fa fa-search" aria-hidden="true"></i> Search\n      </button>\n      <button type="reset" class="btn">\n        <i class="fa fa-times" aria-hidden="true"></i> Clear\n      </button>\n    </form>\n  </div>\n</div>\n\n<div class="row" style="margin-bottom: 15px">\n  <div class="well well-default col-sm-12">\n    <form class="form-horizontal" role="form" data-form-type="bibcodes">\n      <legend>Bibliographic Code Query</legend>\n      <div class="col-sm-12">\n        <div class="form-group">\n          <label for="bibcodes">List of Bibcodes</label>\n          <textarea\n            name="bibcodes"\n            id="bibcodes"\n            cols="30"\n            rows="5"\n            class="form-control"\n            aria-describedby="bibcodes_helper"\n            style="min-width: 100%; max-width: 100%"\n            required\n          ></textarea>\n          <span class="help-block" id="bibcodes_helper"\n            >Enter list of Bibcodes (e.g. 1989ApJ...342L..71R), one per\n            line.</span\n          >\n        </div>\n      </div>\n      <button type="submit" class="btn btn-primary">\n        <i class="fa fa-search" aria-hidden="true"></i> Search\n      </button>\n      <button type="reset" class="btn">\n        <i class="fa fa-times" aria-hidden="true"></i> Clear\n      </button>\n    </form>\n  </div>\n</div>\n'},useData:!0});return t.registerPartial("js/widgets/paper_search_form/form",n),n}),define("js/widgets/paper_search_form/widget",["underscore","jquery","js/widgets/base/base_widget","js/components/api_query","js/components/api_request","js/components/api_targets","hbs!js/widgets/paper_search_form/form","./topterms"],function(e,t,n,i,a,r,s,o){var l=function(e,n){var i=new RegExp("("+this.term+")","i"),a=n.label.replace(i,'<span class="ui-state-highlight">$1</span>'),r=t("<li/>").appendTo(e);return t("<a/>").html(a).appendTo(r),r},c=function(n,i){return i(t.map(o,function(t){if(e.isString(n.term)){var i=n.term.toUpperCase(),a=t.value.toUpperCase(),r=t.label.toUpperCase();if(0===a.indexOf(i)||0===r.indexOf(i)||0===r.replace(/^THE\s/,"").indexOf(i))return t}}))},u=Marionette.ItemView.extend({template:s,className:"paper-search-form",onRender:function(){var e,n,i=this;e=this.el,(n=t("input#bibstem",e)).data("ui-autocomplete")||(n.on("keyup",function(e){13===e.keyCode&&n.trigger("enter")}),n.autocomplete({minLength:1,autoFocus:!0,source:c}),n.data("ui-autocomplete")._renderItem=l),setTimeout(function(){t("input",i.el).get(0).focus()},100)},events:{"submit form":"submit"},_submit:e.debounce(function(e){var n=t(e.target).addClass("submitted").data("formType"),i=t("input, textarea",e.target).toArray().reduce(function(e,t){return e[t.name]=t.value,e},{});this.setFormDisabled(!0),t('button[type="submit"]',e.target).html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i> Submitting...'),this.trigger("submit",n,i)},1e3,{leading:!0,trailing:!1}),submit:function(e){e.preventDefault(),this._submit(e)},setFormDisabled:function(e){t("input, textarea, button",this.el).prop("disabled",e).toggleClass("disabled",e),t('button[type="submit"]',this.el).html('\n        <i class="fa fa-search" aria-hidden="true"></i> Search\n      ')},onDone:function(){this.setFormDisabled(!1)},onFail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Error",n=t(this.el),i=t("form.submitted",n).closest(".row");t('\n        <div class="alert alert-danger" id="error-message">\n          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>  <strong>'.concat(e,"</strong>\n        </div>\n      ")).insertAfter(i),this.setFormDisabled(!1),t("input, textarea, button",n).one("focus",function(){t("#error-message",n).remove(),t("form.submitted",n).removeClass("submitted")})},onReset:function(){this.render()},onShow:function(){this.setFormDisabled(!1),t("input",this.el).get(0).focus()}});return n.extend({initialize:function(){this.view=new u,this.view.on("submit",this.onSubmit.bind(this))},activate:function(e){var t=this;n.prototype.activate.call(this,e);var i=this.getPubSub();i.subscribe(i.CUSTOM_EVENT,function(e,n){"start-new-search"===e?t.onNewSearch():"second-order-search/error"===e&&t.view.triggerMethod("fail",n.message)})},onNewSearch:function(){this.view.triggerMethod("reset")},processResponse:function(){},onSubmit:function(e,t){var n=this;switch(e){case"reference":this.sendReferenceQuery(t).done(function(e){var t,i,a,r=e.resolved,s=(i=(t=r).score,a=t.bibcode,"0.0"!==i&&a?a:null);if(s)return n.doSearch("bibcode:".concat(s));n.view.triggerMethod("fail","No bibcodes matching reference string")}).fail(function(e){if(e.responseJSON&&e.responseJSON.error)return n.view.triggerMethod("fail",e.responseJSON.error);n.view.triggerMethod("fail","Error occurred sending reference request")});break;case"journal":try{var i=Object.keys(t).filter(function(e){return t[e].trim()}).map(function(e){return"".concat(e,":").concat(t[e])}).join(" ");this.doSearch(i)}catch(e){this.view.triggerMethod("fail","Error parsing journals")}break;case"bibcodes":try{var a=t.bibcodes.split(/\s+/).filter(function(e){return!!e});if(0===a.length)return this.view.triggerMethod("done");this.doBigSearch(a)}catch(e){this.view.triggerMethod("fail","Error parsing bibcodes")}}},doBigSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getPubSub();t.publish(t.CUSTOM_EVENT,"second-order-search/limit",{ids:e})},doSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new i({q:e,sort:["date desc"]}),n=this.getPubSub();n.publish(n.NAVIGATE,"search-page",{q:t,context:{referrer:"PaperSearchForm"}})},sendReferenceQuery:function(e){var n=t.Deferred(),s=this.getPubSub(),o=new a({target:r.REFERENCE+"/"+encodeURIComponent(e.reference),query:new i({}),options:{type:"GET",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},done:function(e){return n.resolve(e)},fail:function(){return n.reject.apply(n,arguments)},always:function(){return n.always()}}});return s.publish(s.EXECUTE_REQUEST,o),n.promise()},onShow:function(){this.view.triggerMethod("show")}})}),define("js/widgets/search_bar/autocomplete",[],function(){return[{value:'author:""',label:"Author",match:'author:"'},{value:'author:"^"',label:"First Author",match:'author:"'},{value:'author:"^"',label:"First Author",match:"first author"},{value:'author:"^"',label:"First Author",match:"^author"},{value:'author:"^"',label:"First Author",match:'author:"^'},{value:'bibstem:""',label:"Publication (must use bibstem)",desc:"e.g. bibstem:ApJ",match:'bibstem:"'},{value:'bibstem:""',label:"Publication (must use bibstem)",desc:"e.g. bibstem:ApJ",match:"publication (bibstem)"},{value:"arXiv:",label:"arXiv ID",match:"arxiv:"},{value:"doi:",label:"DOI",match:"doi:"},{value:'full:""',label:"Full text search",desc:"title, abstract, and body",match:"full:"},{value:'full:""',label:"Full text search",desc:"itle, abstract, and body",match:"fulltext"},{value:'full:""',label:"Full text search",desc:"title, abstract, and body",match:"text"},{value:"year:",label:"Year",match:"year"},{value:"year:",label:"Year Range",desc:"e.g. 1999-2005",match:"year range"},{value:'aff:""',label:"Affiliation",match:"affiliation"},{value:'aff:""',label:"Affiliation",match:"aff:"},{value:'abs:""',label:"Search abstract + title + keywords",match:"abs:"},{value:"collection:astronomy",label:"Limit to papers in the astronomy database",match:"database:astronomy"},{value:"collection:physics",label:"Limit to papers in the physics database",match:"database:physics"},{value:"collection:astronomy",label:"Limit to papers in the astronomy database",match:"collection:astronomy"},{value:"collection:physics",label:"Limit to papers in the physics database",match:"collection:physics"},{value:'title:""',label:"Title",match:"title:("},{value:"orcid:",label:"ORCiD identifier",match:"orcid:"},{value:"object:",label:"SIMBAD object (e.g. object:LMC)",match:"object:"},{value:"citations()",label:"Citations",desc:"Get papers citing your search result set",match:"citations("},{value:"references()",label:"References",desc:"Get papers referenced by your search result set",match:"references("},{value:"trending()",label:"Trending",desc:"the list of documents most read by users who read recent papers on the topic being researched",match:"trending("},{value:"reviews()",label:"Review Articles",desc:"review articles citing most relevant papers",match:"reviews("},{value:"useful()",label:"Useful",desc:"documents frequently cited by the most relevant papers on the topic being researched",match:"useful("},{value:"property:refereed",label:"Limit to refereed",desc:"(property:refereed)",match:"refereed"},{value:"property:refereed",label:"Limit to refereed",desc:"(property:refereed)",match:"property:refereed"},{value:"property:notrefereed",label:"Limit to non-refereed",desc:"(property:notrefereed)",match:"non-refereed"},{value:"property:notrefereed",label:"Limit to non-refereed",desc:"(property:notrefereed)",match:"property:notrefereed"},{value:"property:notrefereed",label:"Limit to non-refereed",desc:"(property:notrefereed)",match:"notrefereed"},{value:"doctype:eprint",label:"Limit to eprints",desc:"(doctype:eprint)",match:"eprint"},{value:"doctype:eprint",label:"Limit to eprints",desc:"(doctype:eprint)",match:"doctype:eprint"},{value:"doctype:eprint",label:"Limit to eprints",desc:"(doctype:eprint)",match:"property:eprint"},{value:"property:openaccess",label:"Limit to open access",desc:"(property:openaccess)",match:"open access"},{value:"property:openaccess",label:"Limit to open access",desc:"(property:openaccess)",match:"property:openaccess"},{value:"property:openaccess",label:"Limit to open access",desc:"(property:openaccess)",match:"openaccess"},{value:"doctype:software",label:"Limit to software",desc:"(doctype:software)",match:"software"},{value:"doctype:software",label:"Limit to software",desc:"(doctype:software)",match:"doctype:software"},{value:"doctype:inproceedings",label:"Limit to papers in conference proceedings",desc:"(doctype:inproceedings)",match:"conference proceedings"},{value:"doctype:inproceedings",label:"Limit to papers in conference proceedings",desc:"(doctype:inproceedings)",match:"doctype:inproceedings"},{value:"doctype:inproceedings",label:"Limit to papers in conference proceedings",desc:"(doctype:inproceedings)",match:"property:inproceedings"}]}),define("hbs!js/widgets/search_bar/templates/search_bar_template",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var a,r;return" "+(null!=(a=t.if.call(e,null!=e?e.libraryName:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.program(4,i,0),data:i}))?a:"")+'            <input type="text" class="form-control q hasbigquery" name="q" autofocus aria-label="Start typing a query here to begin an ADS Search" autocomplete="off" value='+this.escapeExpression("function"==typeof(r=null!=(r=t.currentQueryVal||(null!=e?e.currentQueryVal:e))?r:t.helperMissing)?r.call(e,{name:"currentQueryVal",hash:{},data:i}):r)+'>\n            <i class="icon-clear s-clear-control"></i> '},2:function(e,t,n,i){var a;return'\n            <div class="btn btn-xs btn-info bigquery-tag"><i class="fa fa-book" />&nbsp;<span>'+this.escapeExpression("function"==typeof(a=null!=(a=t.libraryName||(null!=e?e.libraryName:e))?a:t.helperMissing)?a.call(e,{name:"libraryName",hash:{},data:i}):a)+'</span>&nbsp;<i class="fa fa-close fa-lg bigquery-close" title="click to remove" /></div>\n'},4:function(e,t,n,i){return'            <div class="btn btn-xs btn-info bigquery-tag"><i class="fa fa-list-ul" />&nbsp;&nbsp;Bulk query&nbsp;&nbsp;<i class="fa fa-close fa-lg bigquery-close" title="click to remove" /></div>\n'},6:function(e,t,n,i){var a;return'\n            <input type="text" class="form-control q" name="q" autofocus aria-label="Start typing a query here to begin an ADS Search" autocomplete="off" value='+this.escapeExpression("function"==typeof(a=null!=(a=t.currentQueryVal||(null!=e?e.currentQueryVal:e))?a:t.helperMissing)?a.call(e,{name:"currentQueryVal",hash:{},data:i}):a)+'>\n            <i class="icon-clear s-clear-control"></i> '},8:function(e,t,n,i){var a;return'      <span class="search-bar__citation-count"> with <b><span class="citation-count-container">'+this.escapeExpression("function"==typeof(a=null!=(a=t.citationCount||(null!=e?e.citationCount:e))?a:t.helperMissing)?a.call(e,{name:"citationCount",hash:{},data:i}):a)+'</span></b>\n        <span class="s-light-font description">total '+this.escapeExpression("function"==typeof(a=null!=(a=t.citationLabel||(null!=e?e.citationLabel:e))?a:t.helperMissing)?a.call(e,{name:"citationLabel",hash:{},data:i}):a)+" </span>\n      </span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,r;return'<div role="search">\n  <div class="row">\n    <h2 class="sr-only">Search Bar to Enter New Query</h2>\n    <div class="col-sm-12 s-quick-add" aria-label="quick add fields">\n      <div id="expanded-search-form" class="unselectable">\n        <div id="field-options">\n          <span class="s-field-options">quick field:</span>\n\n          <span class="visible-sm-inline visible-md-inline visible-lg-inline">\n            <button class="btn btn-link btn-sm" title=\'search for an author, e.g. author:"Kurtz,M"\' data-toggle="tooltip" data-field="author" data-punc=\'"\'>Author</button>\n            <button class="btn btn-link btn-sm" title=\'search for a first author, e.g. author:"^Kurtz,M"\' data-toggle="tooltip" data-field="first-author" data-punc=\'"\'>First Author</button>\n            <button class="btn btn-link btn-sm" title="limit search to abstract, title and keyword fields" data-toggle="tooltip" data-field="abs" data-punc=\'"\'>Abstract</button>\n          </span>\n\n          <span class="visible-lg-inline">\n            <button class="btn btn-link btn-sm" title="e.g. year:1999 or year:1999-2016" data-toggle="tooltip" data-field="year">Year</button>\n            <button class="btn btn-link btn-sm" title="search titles, abstract, text, keywords and acknowledgements of the articles" data-toggle="tooltip" data-field="full" data-punc=\'"\'>Fulltext</button>\n          </span>\n\n          \x3c!--container for additional fields/operators--\x3e\n          <span id="option-dropdown-container"></span>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="row"></div>\n  <div class="row">\n    <div class="col-sm-12 search-bar-input-row s-search-bar-input-row">\n      <form name="main-query" action="/search/q=%s">\n        <div class="form-group has-feedback">\n          <div class="input-group">\n            '+(null!=(a=t.if.call(e,null!=e?e.bigquery:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(6,i,0),data:i}))?a:"")+'\n            <span class="input-group-btn">\n                      <button type="submit" class="btn btn-primary search-submit s-search-submit" aria-label="submit">\n                          <i class="fa fa-search"></i></button>\n                  </span>\n\n          </div>\n          \x3c!-- /input-group --\x3e\n        </div>\n        \x3c!-- /form-group--\x3e\n      </form>\n    </div>\n  </div>\n</div>\n<div class="row">\n  <div class="only-show-on-landing search-quick-links">\n    <div class="quick-reference">\n      <div class="col-sm-6">\n        <dl class="dl-horizontal">\n          <dt>author</dt>\n          <dd>\n            <button class="text-link">author:"huchra, john"</button>\n          </dd>\n          <dt>first author</dt>\n          <dd>\n            <button class="text-link">author:"^huchra, john"</button>\n          </dd>\n          <dt>abstract + title</dt>\n          <dd>\n            <button class="text-link">abs:"dark energy"</button>\n          </dd>\n          <dt>year</dt>\n          <dd>\n            <button class="text-link">year:2000</button>\n          </dd>\n          <dt>year range</dt>\n          <dd>\n            <button class="text-link">year:2000-2005</button>\n          </dd>\n          <dt>full text</dt>\n          <dd>\n            <button class="text-link">full:"gravity waves"</button>\n          </dd>\n          <dt>publication</dt>\n          <dd>\n            <button class="text-link">bibstem:ApJ</button>\n            <i class="icon-help" data-toggle="tooltip" title="this field requires the bibstem, or journal abbreviation--try going to the \'Paper\' tab above for an easy-to-use form version"></i>\n          </dd>\n        </dl>\n      </div>\n      <div class="col-sm-6  quick-reference">\n        <dl class="dl-horizontal">\n          <dt>citations</dt>\n          <dd>\n            <button class="text-link">citations(author:"huchra, j")</button>\n            <i class="icon-help" data-toggle="tooltip" title="finds all papers that cite a given set of papers"></i>\n          </dd>\n          <dt>references</dt>\n          <dd>\n            <button class="text-link">references(author:"huchra, j")</button>\n            <i class="icon-help" data-toggle="tooltip" title="finds all papers referenced by a given set of papers"></i>\n          </dd>\n          <dt>reviews</dt>\n          <dd>\n            <button class="text-link">reviews("gamma-ray bursts")</button>\n            <i class="icon-help" data-toggle="tooltip" title="finds articles citing the most relevant papers on the topic being researched"></i>\n          </dd>\n          <dt style="padding-top: 0.6em;">refereed</dt>\n          <dd style="border-top: solid 1px #e8e8e8; padding-top: 0.5em;">\n            <button class="text-link">property:refereed</button>\n            <i class="icon-help" data-toggle="tooltip" title="limit to non-refereed papers by searching property:notrefereed"></i>\n          </dd>\n          <dt>astronomy</dt>\n          <dd>\n            <button class="text-link">database:astronomy</button>\n            <i class="icon-help" data-toggle="tooltip" title="limit to physics papers by searching database:physics"></i>\n          </dd>\n          <dt>OR</dt>\n          <dd>\n            <button class="text-link">abs:(planet OR star)</button>\n            <i class="icon-help" data-toggle="tooltip" title="default logic is AND, e.g. abs:(planet star) would be interpreted as abs:(planet AND star)"></i>\n          </dd>\n        </dl>\n      </div>\n    </div>\n\n  </div>\n\n  <div class="s-num-found">\n    <span class="s-light-font description">Your search returned</span>\n      <b><span class="num-found-container">'+this.escapeExpression("function"==typeof(r=null!=(r=t.numFound||(null!=e?e.numFound:e))?r:t.helperMissing)?r.call(e,{name:"numFound",hash:{},data:i}):r)+'</span></b>\n      <span class="s-light-font"> results </span>\n'+(null!=(a=t.if.call(e,null!=e?e.citationCount:e,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?a:"")+"  </div>\n</div>\n</div>\n"},useData:!0});return t.registerPartial("js/widgets/search_bar/templates/search_bar_template",n),n}),define("hbs!js/widgets/search_bar/templates/search_form_template",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div id="search-gui"><span style="text-align:right;font-size:small;float:right;">This tool is still experimental.</span>\n</div>\n\n\n\n'},useData:!0});return t.registerPartial("js/widgets/search_bar/templates/search_form_template",n),n}),define("hbs!js/widgets/search_bar/templates/option-dropdown",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<select class="quick-add-dropdown">\n<optgroup label="fields">\n  <option value="abs" data-field="abs">abstract</option>\n  <option value="abstract">abstract only</option>\n  <option value="ack">acknowledgements</option>\n  <option value="aff">affiliation</option>\n  <option value="arxiv_class">arXiv category</option>\n  <option value="author_count">author count</option>\n  <option value="author" data-field="author">author</option>\n  <option value="bibcode">bibcode</option>\n  <option value="bibgroup">bibliographic group</option>\n  <option value="bibstem">bib abbrev, e.g. ApJ</option>\n  <option value="body">body of article</option>\n  <option value="data">data archive</option>\n  <option value="collection">collection</option>\n  <option value="citation_count">citation count</option>\n  <option value="doctype">doctype</option>\n  <option value="doi">doi</option>\n  <option value="entdate" data-default-value="[2000-01-01 TO 2010-01-01]">entdate</option>\n  <option value="first-author" data-field="first-author">first author</option>\n  <option value="full" data-field="full">fulltext</option>\n  <option value="identifier">identifier</option>\n  <option value="keyword">keyword</option>\n  <option value="object">object</option>\n  <option value="orcid">orcid</option>\n  <option value="page">page</option>\n  <option value="property">property</option>\n  <option value="pub">publication full name</option>\n  <option value="pubdate" data-default-value="[2000-01 TO 2010-01]">date published</option>\n  <option value="title">title</option>\n  <option value="volume">volume</option>\n  <option value="year" data-field="year">year</option>\n</optgroup>\n<optgroup label="operators">\n  <option value="citations">citations()</option>\n  <option value="pos">pos()</option>\n  <option value="references">references()</option>\n  <option value="reviews">reviews()</option>\n  <option value="similar">similar()</option>\n  <option value="topn">topn()</option>\n  <option value="trending">trending()</option>\n  <option value="useful">useful()</option>\n</optgroup>\n<optgroup label="special characters">\n  <option value="?">single wildcard: ?</option>\n  <option value="*">wildcard: *</option>\n  <option value="=">exact match: =</option>\n</optgroup>\n</select>\n'},useData:!0});return t.registerPartial("js/widgets/search_bar/templates/option-dropdown",n),n}),define("libs/select2/matcher",["jquery"],function(e){return function(t){return function(n,i){var a=e.extend(!0,{},i);if(null==n.term||""===e.trim(n.term))return a;if(i.children){for(var r=i.children.length-1;r>=0;r--){var s=i.children[r];t(n.term,s.text,s)||a.children.splice(r,1)}if(a.children.length>0)return a}return t(n.term,i.text,i)?a:null}}}),define("js/widgets/search_bar/search_bar_widget",["underscore","marionette","js/components/api_query","js/widgets/base/base_widget","hbs!js/widgets/search_bar/templates/search_bar_template","hbs!js/widgets/search_bar/templates/search_form_template","hbs!js/widgets/search_bar/templates/option-dropdown","js/components/api_request","js/components/api_targets","js/components/api_feedback","js/mixins/formatter","./autocomplete","bootstrap","jquery-ui","js/mixins/dependon","analytics","js/components/query_validator","select2","libs/select2/matcher"],function(e,t,n,i,a,r,s,o,l,c,u,h,d,p,f,g,b,v,m){var y;function S(e){var t="";return window.getSelection?t=e.value.substring(e.selectionStart,e.selectionEnd):document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t}function A(t){var n=e.filter(t.split(/\s+/),function(e){if(e)return!0}),i={active:n[n.length-1]};return n.length>1?(n.pop(),i.inactive=n.join(" ")):i.inactive="",i}$.fn.getCursorPosition=function(){var e=this.get(0);if(e){if("selectionStart"in e)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange(),n=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-n}}},$.fn.selectRange=function(e,t){return t||(t=e),this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(e,t);else if(this.createTextRange){var n=this.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select()}})};var _=Backbone.Model.extend({defaults:function(){return{citationCount:void 0,numFound:void 0,bigquery:!1,bigquerySource:void 0}}}),P=t.ItemView.extend({template:a,className:"s-search-bar-widget",initialize:function(t){e.bindAll(this,"fieldInsert"),this.queryValidator=new b,this.defaultDatabases=[]},activate:function(e){this.setBeeHive(e)},modelEvents:{change:"render"},onRender:function(){var t=this,n=this;this.$("#option-dropdown-container").append(s);var i=this.$(".quick-add-dropdown");i.select2({placeholder:"All Search Terms",matcher:m(function(e,t){return 0==t.toUpperCase().indexOf(e.toUpperCase())})}).on("change",function(e){var t=e.target.value;if(t){var a=$(this).find('option[value="'+e.target.value+'"]'),r=a.data("defaultValue"),s=a.closest("optgroup").attr("label");i.val(null).trigger("change"),setTimeout(function(){n.selectFieldInsert(t,s,r)},100)}}).val(null).trigger("change");var a=this.$("input.q");this.$input=a;var r=!0;a.autocomplete({minLength:1,autoFocus:!0,delay:0,source:function(t,n){var i,s,o;r&&a.getCursorPosition()===a.val().length?(i=A(t.term).active)&&(s=new RegExp("^"+$.ui.autocomplete.escapeRegex(i),"i"),o=$.grep(h,function(e){return s.test(e.match)}),n(o=e.uniq(o,!1,function(e){return e.label}))):a.autocomplete("close")},focus:function(e,t){var n,i,r,s,o,l,c=a.val().replace(/^\s+/,""),u=t.item.value,h=S(a[0]);(i=(s=A(n=h?c.slice(0,c.length-h.length):c)).active,r=s.inactive,a.data("ui-autocomplete").suggestedQ=r?r+" "+t.item.value:t.item.value,0==u.indexOf(i))?(l=(o=r?r+" "+i:i)+u.slice(i.length),a.val(l),a.selectRange(o.length,l.length)):a.val(n);return!1},select:function(e,t){a.val(a.data("ui-autocomplete").suggestedQ);var n=t.item.value.split("").reverse()[0];return'"'==n||")"==n?a.selectRange(a.val().length-1):a.selectRange(a.val().length),g("send","event","interaction","autocomplete-used",t.item.value),!1}}),a.data("ui-autocomplete")._renderItem=function(e,t){return t.desc?$("<li>").append("<a>"+t.label+'<span class="s-auto-description">&nbsp;&nbsp;'+t.desc+"</span></a>").appendTo(e):$("<li>").append("<a>"+t.label+"</a>").appendTo(e)},a.bind({keydown:function(e){r=8!=e.keyCode&&32!=e.keyCode},paste:function(){r=!1}}),a.popover({placement:"bottom",title:"Empty Search!",content:"Please enter a query to search.",animation:!0,trigger:"manual"}),this.$('[data-toggle="tooltip"]').tooltip(),this.$(".search-quick-links button").on("click",function(e){var n=e.currentTarget.innerText.trim();n&&t.setFormVal(n)})},events:(y={"click #field-options button":"fieldInsert","keyup .q":"toggleClear","click .show-form":"onShowForm","submit form[name=main-query]":"submitQuery","click .icon-clear":"clearInput"},_defineProperty(y,"keyup .q","storeCursorInfo"),_defineProperty(y,"select .q","storeCursorInfo"),_defineProperty(y,"click .q","storeCursorInfo"),_defineProperty(y,"click .bigquery-close","clearBigquery"),y),toggleClear:function(){this.$(".icon-clear").toggleClass("hidden",!this.$input.val())},clearInput:function(){this.$input.val("").focus(),this.toggleClear()},getFormVal:function(){return this.$input.val()},setFormVal:function(e){this.model.get("bigquery")&&"*:*"===e?this.$(".q").val(""):this.$(".q").val(e),this.toggleClear()},serializeData:function(){var e=this.model.toJSON();return e.numFound=e.numFound?this.formatNum(e.numFound):0,e.citationCount=!!e.citationCount&&this.formatNum(e.citationCount),this.model.get("bigquerySource")&&this.model.get("bigquerySource").match(/library/i)&&this.model.set({libraryName:this.model.get("bigquerySource").match(/library:(.*)/i)[1]}),e},onShowForm:function(){this.specifyFormWidth()},toggleFormSection:function(e){var t=$(e.target).parent();t.next().toggleClass("hide"),t.toggleClass("search-form-header-active")},_cursorInfo:{selected:"",startIndex:0},storeCursorInfo:function(e){var t=S(e.currentTarget),n=this.$input.getCursorPosition();this._cursorInfo={selected:t,startIndex:n},this.toggleClear()},selectFieldInsert:function(e,t,n){var i,a,r=this._cursorInfo.selected,s=this._cursorInfo.startIndex,o=this.getFormVal(),l='"'+r+'"';switch(0===r.length&&n&&(l=n),t){case"fields":"first-author"===e?(e="author",l=l.replace(/"/,'"^')):"year"===e&&(l=l.replace(/"/g,"")),i=e+":"+l;break;case"operators":i=e+"("+('""'===l?"":l)+")";break;case"special characters":i="="===e?e+l:l+e,a=!0}if(r.length)this.setFormVal(o.substr(0,s)+i+o.substr(s+l.length));else{var c=o?o+" "+i:i;this.setFormVal(c),a?this.$input.selectRange(c.length):this.$input.selectRange(c.length-1)}g("send","event","interaction","field-insert-dropdown-selected",e)},fieldInsert:function(e){var t,n,i=this.getFormVal(),a=$(e.target),r=a.attr("data-field"),s=a.attr("data-punc"),o=this._cursorInfo.startIndex,l=this._cursorInfo.selected;if(r.indexOf("operator-")>-1){if(n=r.split("-").reverse()[0],s="(",!l)return t=n+"("+i+")",i="",void this.setFormVal(t);t=n+"("+l+")"}else"first-author"==r?t=' author:"^'+l+'"':'"'==s?t=r+':"'+l+'"':"("==s?t=r+":("+l+")":s||(t=r+":"+l);if(l)this.setFormVal(i.substr(0,o)+t+i.substr(o+l.length));else{var c=i+" "+t;this.setFormVal(c),s?this.$input.selectRange(c.length-1):this.$input.selectRange(c.length)}return g("send","event","interaction","field-insert-button-pressed",r),!1},submitQuery:function(t){var i,a,r;r=this.getFormVal();var s=$("input",t.currentTarget);if(e.isString(r)&&e.isEmpty(r)&&!this.model.get("bigquery"))return s.popover("show"),s.on("input change blur",function(){$(this).popover("hide")}),!1;s.popover("hide"),r=r.replace(/([A-Z])\w+:/g,function(e){return e.toLowerCase()}),this.original_query=r,!r&&this.model.get("bigquery")&&(r="*:*");var o=new n({q:r}),l=this.queryValidator.validate(o);if(!l.result){var u=e.pluck(l.tests,"token");u=u.length>1?u.join(", "):u[0];var d=this.getPubSub();return d.publish(d.ALERT,new c({code:0,msg:'<p><i class="fa fa-exclamation-triangle fa-2x" aria-hidden="true"></i> Sorry! We aren\'t able to understand: <strong><i>'+u+'</i></strong></p><p><strong><a href="/">Try looking at the search examples on the home page</a></strong> or <strong><a href="https://adsabs.github.io/help/search/search-syntax">reading our help page.</a></strong></p>',type:"info",fade:!0})),!1}return this.trigger("start_search",o),i=e.chain(h).pluck("value").map(function(e){var t=e.match(/\w+:|\w+\(/);if(t&&t.length)return t[0]}).unique().value(),a=!1,e.each(i,function(e){r.indexOf(e)>-1&&(a=!0)}),g("send","event","interaction",(a?"fielded":"unfiielded")+"-query-submitted-from-search-bar",r),!1},clearBigquery:function(){this.trigger("clear_big_query")}});e.extend(P.prototype,u,f.BeeHive);var w=i.extend({initialize:function(e){this.model=new _,this.view=new P({model:this.model}),this.listenTo(this.view,"start_search",function(e){this.changeDefaultSort(e),this.navigate(e),this.updateState("loading"),this.view.setFormVal(e.get("q"))}),this.listenTo(this.view,"clear_big_query",function(e){(e=this._currentQuery.clone()).unset("__qid"),e.unset("__bigquerySource"),e.set("__clearBigQuery","true"),this.clearBigQueryPill(),this.navigate(e)}),this.listenTo(this.view,"render",function(){var e="",t=this.getCurrentQuery(),n=t.get("q");n&&(e=t.get("__original_query")?t.get("__original_query")[0]:n.join(" ")),e&&this.view.setFormVal(e),this.view.toggleClear()}),i.prototype.initialize.call(this,e)},activate:function(t){this.setBeeHive(t),this.activateWidget();var n=this.getPubSub();e.bindAll(this,"processResponse"),n.subscribe(n.FEEDBACK,e.bind(this.handleFeedback,this)),n.subscribe(n.NAVIGATE,e.bind(this.onNavigate,this)),this.view.activate(t.getHardenedInstance()),n.subscribe(n.INVITING_REQUEST,e.bind(this.dispatchRequest,this)),n.subscribe(n.DELIVERING_RESPONSE,this.processResponse),n.subscribe(n.USER_ANNOUNCEMENT,e.bind(this.updateFromUserData,this)),n.subscribe(n.CUSTOM_EVENT,e.bind(this.onCustomEvent,this)),n.subscribe(n.START_SEARCH,e.bind(this.onStartSearch,this)),this.updateFromUserData()},getUserData:function(){try{var t=e.isFunction(this.getBeeHive)&&this.getBeeHive(),n=e.isFunction(t.getObject)&&t.getObject("User");return e.isPlainObject(n)?e.isFunction(n.getUserData)&&n.getUserData("USER_DATA"):{}}catch(e){return{}}},onStartSearch:function(){this.model.unset("timing")},onCustomEvent:function(e,t){if("timing:results-loaded"===e)this.model.set("timing",t/1e3);else if("hotkey/search"===e){var n=$("input[name=q]",this.getEl());n.is(":focus")||(t.preventDefault(),n.select(),$("#app-container").scrollTop(0))}},updateFromUserData:function(){var t=this.getUserData();this.defaultDatabases=e.has(t,"defaultDatabase")?e.map(e.filter(t.defaultDatabase,{value:!0}),"name"):this.defaultDatabases},applyDefaultFilters:function(t){var n=this.defaultDatabases||[];if(n.length>0){var i="{!type=aqp v=$fq_database}",a=t.get("fq");if(a=e.isArray(a)?a:[a],e.indexOf(i)<0&&(a.push(i),t.set("fq",a)),!t.has("fq_database")){var r=e.reduce(n,function(e,t,n){var i=t.toLowerCase();return e.replace(/(\(.*)(\))/,0===n?"$1database:"+i+"$2":"$1 OR database:"+i+"$2")},"()");t.set("fq_database",r)}if(!t.has("__filter_database_fq_database")){var s=e.map(n,function(e){return"database:"+e.toLowerCase()});t.set("__filter_database_fq_database",["OR"].concat(s))}}return t},processResponse:function(t){var n=t.toJSON(),i=n.responseHeader.params.sort;if(n.stats&&/citation.*/.test(i)){var a=e.keys(n.stats.stats_fields)[0],r=n.stats.stats_fields[a].sum;"citation_count_norm"===a?this.model.set({citationCount:r.toFixed(2),citationLabel:"normalized citations"}):"citation_count"===a&&this.model.set({citationCount:r,citationLabel:"citations"})}else this.model.unset("citationCount"),this.model.unset("citationLabel")},defaultQueryArguments:{fl:"id"},dispatchRequest:function(t){var n=t.get("sort"),a=this.defaultQueryArguments;/citation_count_norm/i.test(n)?a=e.extend(a,{stats:"true","stats.field":"citation_count_norm"}):/citation_count/i.test(n)?a=e.extend(a,{stats:"true","stats.field":"citation_count"}):(this.model.unset("citationCount"),this.model.unset("citationLabel")),i.prototype.dispatchRequest.call(this,t)},focusInput:function(){this._onIndexPage()&&(this.clearBigQueryPill(),this.view.clearInput())},clearBigQueryPill:function(){this.model.unset("bigquerySource"),this.model.unset("bigquery")},onNavigate:function(e){this.currentPage=e,this.focusInput(e)},handleFeedback:function(e){if(e.code===c.CODES.SEARCH_CYCLE_STARTED||e.code===c.CODES.SEARCH_CYCLE_FAILED_TO_START){var t=e.query?e.query:e.request.get("query"),n=t.get("__original_query")?t.get("__original_query")[0]:t.get("q").join(" ");this.setCurrentQuery(t),this.model.set({bigquerySource:t.get("__bigquerySource")?t.get("__bigquerySource")[0]:"Bulk query",bigquery:!!t.get("__qid"),numFound:e.numFound}),this.view.setFormVal(n),this.updateState("idle")}},changeDefaultSort:function(t){var n=this.getCurrentQuery();if(t.has("sort"))n&&n.has("sort")&&t.set("sort",n.get("sort"));else{var i=t.get("q")[0],a=e.find(["trending(","instructive(","useful(","references(","reviews(","similar("],function(e){if(-1!==i.indexOf(e))return e});"references("==a?t.set("sort","first_author asc"):a?t.set("sort","score desc"):a||t.set("sort","date desc")}},_onIndexPage:function(){return/(index-page|SearchWidget)/.test(this.currentPage)||!this.currentPage},navigate:function(t){var i=t.toJSON(),a=e.omit(this.getCurrentQuery().toJSON(),function(e,t){return/^hl.*/.test(t)||/^p_$/.test(t)||/^__original_query$/.test(t)});this._onIndexPage()?(t=this.applyDefaultFilters(t)).set("__clearBigQuery","true"):t=new n(e.assign(a,i)),t.has("__clearBigQuery")?t.unset("__qid"):t.has("__qid")&&!this._onIndexPage()&&t.set("__saveBigQuery","true"),this.view.setFormVal(t.get("q")[0]),this.setCurrentQuery(t),this.getPubSub().publish(this.getPubSub().NAVIGATE,"search-page",{q:t})},openQueryAssistant:function(e){e&&this.view.setFormVal(e),this.view.$el.find(".show-form").click()},onShow:function(){if(this._onIndexPage()){var e=this.view.$("input[name=q]");!function t(n){if(e.blur().focus(),e.is(":focus")||n>9)return clearTimeout(void 0);setTimeout(t,500,n+1)}(0)}},onDestroy:function(){this.view.destroy()},onLoading:function(){this.model.set("loading",!0)},onIdle:function(){this.model.set("loading",!1)}});return e.extend(w.prototype,f.BeeHive),w}),define("js/widgets/widget_states",[],function(){return{READY:0,LOADING:1,IDLE:2,FAILED:3}}),define("js/wraps/alerts_mediator",["underscore","jquery","js/components/alerts_mediator","js/components/api_feedback","js/widgets/widget_states","js/components/alerts","js/components/api_response"],function(e,t,n,i,a,r,s){return n.extend({activate:function(t,i){n.prototype.activate.apply(this,arguments);var a=this.getPubSub();a.subscribe(a.APP_STARTED,e.bind(this.displaySiteMessageWithDelay,this))},onAlert:function(e,t){this._dirty=!0,n.prototype.onAlert.apply(this,arguments)},displaySiteMessageWithDelay:function(){var e=this;setTimeout(function(){e.checkAndDisplaySiteMessage()},500)},onDestroy:function(){clearInterval(this.timerId)},onStartSearch:function(){this._dirty=!1},checkAndDisplaySiteMessage:function(){var t=this,n=t.getBeeHive().getObject("User");n&&n.getSiteConfig("site_wide_message").done(function(a){if(a&&e.isString(a)&&!t._dirty){if(n.isLoggedIn())if(n.getUserData().last_seen_message==a)return;var r=t.getBeeHive().getService("PersistentStorage");if(r){var s=r.get("last_seen_message");if(s&&s==a)return}t.alert(new i({msg:a,events:{"click button.close":"dismissed"}})).done(function(e){"dismissed"==e&&(n&&n.isLoggedIn()&&n.setMyADSData({last_seen_message:a}),r&&r.set("last_seen_message",a))})}})}})}),define("js/wraps/discovery_mediator",["underscore","jquery","js/components/feedback_mediator","js/components/api_feedback","js/widgets/widget_states","js/components/alerts","js/components/api_response","analytics"],function(e,t,n,i,a,r,s,o){var l={};return l[i.CODES.MAKE_SPACE]=function(){this.getBeeHive().getService("PubSub").once(this.getPubSub().DELIVERING_REQUEST,e.bind(function(e,t){this._tmp.callOnce[t.getId()]||(this._tmp.callOnce[t.getId()]=!0)},this))},l[i.CODES.SEARCH_CYCLE_STARTED]=function(t){this._tmp.cycle_started=!0;var n=this.getApp();if(t.query?(n.getObject("AppStorage").setCurrentQuery(t.query),n.getObject("AppStorage").setCurrentNumFound(t.numFound)):n.getObject("AppStorage").setCurrentQuery(null),t.request&&t.request.get("target").indexOf("search")>-1&&t.query&&!t.numFound)t.query;else{t.numFound>1e3&&n.getWidget("SearchWidget").done(function(e){e.view&&e.view.highlightFields&&e.view.highlightFields()});e.keys(t.cycle.waiting);this.getAlerter().alert(new i({type:r.TYPE.INFO,msg:null}))}},l[i.CODES.SEARCH_CYCLE_FAILED_TO_START]=function(t){var n=t.request,a=t.error.jqXHR||{},r=this.getApp(),l=this.getAlerter(),c=this,u={target:"",msg:a.statusText};function h(){var e=r.getService("Api");return e&&e.access_token?e.access_token.slice(30):"no access token"}if(o("send","event","error","search",a.statusText),a&&n){var d=n.get("target");switch(u.target=d,u.query=n.get("query").toJSON(),a.status){case 403:return o("send","event","error","access-denied","request="+n.url()+" token=..."+h()),void l.alert(new i({code:i.CODES.ALERT,msg:"We are sorry, you do not have permission to access: "+d+". This is likely our fault (misconfiguration) and the ADS team has been notified.",modal:!0}));case 429:return void l.alert(new i({code:i.CODES.ALERT,msg:"We are sorry, it looks like you have exhausted allowed quota for: "+d+". The limits will be reset in (usually) in 24 hours. If you believe this is an error or if you need to do something special, please contact us using the feedback button and describe what you are trying to accomplish. We may be able to help or provide efficient way of searching through ADS database. We also have an API that can be useful!",modal:!0}));case 405:return o("send","event","error","access-denied","request="+n.url()+" token=..."+h),void l.alert(new i({code:i.CODES.ALERT,msg:"I am afraid you have just discovered a glitch in our system. (Congratulations!). What you are trying to do should be possible. It is likely a mis-configuration. Please try to reload the webpage; if problem persists - then send us an angry email and wait for a day.",modal:!0}));case 401:return void r.getApiAccess({reconnect:!0}).done(function(){r.getService("Api").request(n,{done:function(){r.getController("QueryMediator").resetFailures();var e=c.getPubSub();e&&e.publish(e.NAVIGATE,"search-page",{q:n.get("query")})},fail:function(){o("send","event","error","unauthorized","request="+n.url()+" token=..."+h()),l.alert(new i({msg:"Seems like you are not authorized to access: "+d,modal:!0,type:"danger"}))}})}).fail(function(){l.alert(new i({code:i.CODES.DANGER,msg:"The security token used to access our API has expired and we are unable to refresh it (though we tried). You will have to reload the webpage. Sorry about that!",modal:!0}))})}if(d.indexOf("search")>-1){if(400==a.status){var p=n.get("query"),f="";return a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.msg&&(f=e.escape(a.responseJSON.error.msg)).indexOf("SyntaxError")>-1&&(f=(f=(f=(f=(f=(f=f.replace("org.apache.solr.search.SyntaxError:","")).replace("org.apache.solr.common.SolrException:","")).replace("INVALID_SYNTAX_CANNOT_PARSE:","")).replace(": The parser reported a syntax error, antlrqueryparser hates errors!","")).trim()).replace("Syntax Error, cannot parse","Syntax Error, cannot parse<b>")+"</b>"),void l.alert(new i({msg:(f||"There is something wrong with the query:")+'<b><a href="#">&nbsp;&nbsp;Try looking at the search examples on the home page</a></b>  or <b><a href="https://adsabs.github.io/help/search/search-syntax" target="_blank" rel="noopener">reading our help page</a>.</b>',events:{"click a#query-assistant":"query-assistant"}})).done(function(e){"query-assistant"==e&&c.getApp().getWidget("SearchWidget").done(function(e){var t=p.get("q").join(" ");t?e.openQueryAssistant(t):e.openQueryAssistant("ooops, the query is complex (we are not yet ready for that)")})})}if(500==a.status&&a.responseJSON){var g=a.responseJSON;if(g.error&&g.error.msg&&g.error.msg.indexOf("maxClauseCount")>-1){var b=new s(g),v=t.cycle,m=e.keys(v.inprogress)[0],y=v.inprogress[m];return b.setApiQuery(y.request.get("query")),v.done[m]=v.inprogress[m],delete v.inprogress[m],c.getPubSub().publish(c.getPubSub().DELIVERING_RESPONSE+m,b),v.running=!1,void r.getController("QueryMediator").startExecutingQueries()}}}}o("send","event","error","unrecoverable-"+a.status,"request="+n.url()+" token=..."+h);var S,A=["We are having trouble accessing: "+d+". The ADS backend service is probably down, or else we’ve been struck by an asteroid.","We are having trouble accessing: "+d+". A solar flare must have taken down our servers! Or else the ADS backend service is down momentarily.","Was that a supernova or are our servers just down? We are having trouble accessing: "+d+" but we should be back in a flash.","The alien mothership has arrived! Or else the ADS backend service is down momentarily. We are having trouble accessing: "+d+" but should be back up soon.","The server response seems to be highly redshifted, may require another observation to record. (The ADS backend service is down momentarily and we are having trouble accessing: "+d+" but we should be back up soon.)","A singularity has formed inside our server, and we are having trouble accessing: "+d+".","Universal Translator Malfunction: Unable to Communicate with ADS Droids. (The ADS backend service is down momentarily and we are having trouble accessing: "+d+" but we should be back up soon.","UV catastrophe detected! (The ADS backend service is down momentarily and we are having trouble accessing: "+d+" but we should be back up soon.)","The ADS Droids got distracted by the Missing Mass Problem instead of working on: "+d+". Be back in a minute."];switch(a.status){case 504:case 408:f="This particular query is taking too long. Please wait a moment and retry. If the problem persits, our backend is likely overwhelmed and will be sluggish for a little longer.";break;case 500:case 502:case 503:S=Math.floor(Math.random()*A.length),f=A[S];break;default:f="Today, you are doubly unlucky. Not only are you experiencing an 'unrecoverable' error, but you have to read this default error message. Sorry about that! We have been notified about the problem."}l.alert(new i({code:i.CODES.ALERT,msg:f,modal:!1}))},l[i.CODES.API_REQUEST_ERROR]=function(e){var t=e.request,n=t.get("query"),a=t.get("target"),r=e.psk,s={error:e.errorThrown,errorCode:e.error.status,destination:a,query:n?n.toJSON():void 0},l=this.getApp(),c=this.getAlerter();if(o("send","event","error","api-request",JSON.stringify(s)),r){var u=l.getPluginOrWidgetName(r.getId());if(u){if(console.error("Query failed for widget: "+u,s),/orcid/.exec(a)&&401==e.error.status){c.alert(new i({code:i.CODES.ALERT,msg:"Your connection with Orcid is no longer valid, it may be that you revoked your token. To continue using this feature, please log back in to Orcid.",modal:!0}));var h=l.getService("OrcidApi"),d=l.getObject("User");return h.signOut(),void d.setOrcidMode(0)}this._tmp.api_failures=this._tmp.api_failures||{},this._tmp.api_failures[u]=this._tmp.api_failures[u]||0,this._tmp.api_failures[u]+=1;this._tmp.api_failures[u]}else if(!e.beVerbose)return;this._tmp.cycle_started}else console.error("We are not going to handle the error (PSK is empty, can't identify the component")},l[i.CODES.QUERY_ASSISTANT]=function(e){this.getApp().getWidget("SearchWidget").done(function(t){var n=null;e.query&&(n=e.query.get("q").join(" ")),t.openQueryAssistant(n)})},function(){var t=new(n.extend({_tmp:{},activate:function(){n.prototype.activate.apply(this,arguments);var t=this.getPubSub();t.subscribe(t.INVITING_REQUEST,e.bind(this.onNewCycle,this)),t.subscribe(t.ARIA_ANNOUNCEMENT,e.bind(this.onPageChange,this)),t.subscribe(t.APP_EXIT,e.bind(this.onAppExit,this)),t.subscribeOnce(t.APP_STARTING,e.bind(this.onAppStarting,this))},onAppStarting:function(){var t=this.getBeeHive().getService("PubSub"),n=this.getApp().getController("QueryMediator");t.unsubscribe(n.getPubSub().getCurrentPubSubKey(),t.START_SEARCH),this.getPubSub().subscribe(t.START_SEARCH,e.bind(function(e,t){var n,i,a=this.getPubSub(),r=this.getApp();if(a&&(n=r.getController("QueryMediator"))){if((i=r.getObject("AppStorage"))&&i.getCurrentQuery())try{console.log("URL: ",i.getCurrentQuery().url())}catch(e){}var s=!0;if(i&&i.hasCurrentQuery()&&e.url()==i.getCurrentQuery().url()&&"widget:SearchWidget"!=r.getPluginOrWidgetName(t.getId())&&r.getWidgetRefCount("Results")>=1&&r.hasService("Navigator")&&(r.getService("Navigator").navigate("results-page",{replace:!0}),s=!1),"SearchPage"!==this.getCurrentPage()&&r.getWidgetRefCount("Results")<=0){var o=arguments;r.getService("Navigator").navigate("results-page",{replace:!1}).then(function(){n.getQueryAndStartSearchCycle.apply(n,o)}),s=!1}s&&n.getQueryAndStartSearchCycle.apply(n,arguments)}},this))},onNewCycle:function(){this.reset()},onPageChange:function(e){e=e.replace("Switching to: ",""),this._currentPage=e},getCurrentPage:function(){return this._currentPage||"LandingPage"},onAppExit:function(e){console.log("App exit requested to: "+e);var t=this.getAlerter();e&&e.url&&("orcid"==e.type?t.alert(new i({code:i.CODES.WARNING,msg:'<p>You will be redirected to ORCID.</p> <p>Please sign in with your ORCID credentials and click on the "authorize" button.</p><button class="btn btn-success" id="okOrcid">Take me to ORCID</button>',modal:!0,events:{"click button#okOrcid":"OK"}})).done(function(t){"OK"==t&&(window.location=e.url)}):window.location=e.url)},getAlerter:function(){return this.getApp().getController(this.alertsController||"AlertsController")},createFeedback:function(e){return new i(e)},reset:function(){this._tmp={callOnce:{}}}}));return e.each(e.pairs(l),function(e){t.addFeedbackHandler(e[0],e[1])}),t}}),define("hbs!js/wraps/landing_page_manager/landing-page-layout",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div id="landing-page-layout" class="s-landing-page-layout">\n   <div class="s-starry-background-wrapper">\n    <section class="s-logo-header">\n        <div>\n                <img src="/styles/img/transparent_logo.svg" alt="The Astrophysics Data System Logo"/>\n                <b>astrophysics</b>&nbsp;data system\n        </div>\n     </section>\n       <div  class="nav-container s-landing-nav-container">\n       </div>\n   </div>\n\n    <section class="s-search-bar-row  row">\n\n                \x3c!-- <div class="unobtrusive-landing-page-alert">\n                    <b>\n                        <a href="http://zenodo.org/communities/about/astrothesis/" target="_blank" rel="noopener">\n                            <i class="fa fa-graduation-cap"></i>\n                            Learn how to contribute your thesis to the ADS Astronomy Thesis Collection\n                        </a>\n                    </b>\n                </div> --\x3e\n\n                <div class="search-bar-rows-container s-search-bar-rows-container">\n                    <br/>\n                    <br/>\n                    <div data-widget="SearchWidget"/>\n                    <div data-widget="ClassicSearchForm"/>\n                    <div data-widget="PaperSearchForm"/>\n                    <br/>\n                </div>\n\n                <div class="landing-faq row" >\n                  <a href="#classic-form">\n                  <div class="col-sm-4">\n                      <i class="fa fa-life-ring fa-2x"></i>\n                    <div>\n                      Use a classic ADS-style form\n                    </div>\n                  </div>\n                  </a>\n                  <a href="https://adsabs.github.io/help/search/search-syntax" target="_blank" rel="noopener">\n                    <div class="col-sm-4">\n\n                      <i class="fa fa-search fa-2x"></i>\n                    <div>\n                       Learn more about searching the ADS\n                    </div>\n                  </div>\n                  </a>\n                  <a href="https://github.com/adsabs/adsabs-dev-api" target="_blank" rel="noopener">\n                  <div class="col-sm-4">\n\n                      <i class="fa fa-code fa-2x"></i>\n                    <div>\n                      Access ADS data with our API\n                    </div>\n                  </div>\n                  </a>\n                </div>\n\n    </section>\n\n</div>\n'},useData:!0});return t.registerPartial("js/wraps/landing_page_manager/landing-page-layout",n),n}),define("hbs!js/wraps/landing_page_manager/landing-page-nav",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var a;return'    <li\n      class="landing-tab '+(null!=(a=t.if.call(e,null!=e?e.isSelected:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?a:"")+'"\n      aria-labelledby="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'"\n    >\n      <a href="'+this.escapeExpression(this.lambda(null!=e?e.path:e,e))+'" data-widget-id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'">\n        '+this.escapeExpression(this.lambda(null!=e?e.title:e,e))+'\n        <span class="hidden-xs">\n          Form\n        </span>\n      </a>\n    </li>\n'},2:function(e,t,n,i){return" active "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a;return'<nav class="s-landing-tabs" role="navigation">\n  <ul>\n'+(null!=(a=t.each.call(e,null!=e?e.tabs:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?a:"")+"  </ul>\n</nav>\n"},useData:!0});return t.registerPartial("js/wraps/landing_page_manager/landing-page-nav",n),n}),define("js/wraps/landing_page_manager/landing_page_manager",["js/page_managers/toc_controller","js/page_managers/one_column_view","hbs!js/wraps/landing_page_manager/landing-page-layout","hbs!js/wraps/landing_page_manager/landing-page-nav"],function(e,t,n,i){return e.extend({getHomePageFromUserData:function(){try{return this.getBeeHive().getObject("User").getUserData().homePage}catch(e){return null}},activate:function(){var t=this;e.prototype.activate.apply(this,arguments);var n=this.getPubSub();n.subscribe(n.USER_ANNOUNCEMENT,function(e,n){"user_info_change"===e&&n&&n.homePage&&t.setHomePage(n.homePage)});var i=this.getHomePageFromUserData();i&&this.setHomePage(i)},setHomePage:function(e){var t=this;if(e){var n=e.split(" ")[0],i=Object.keys(this.navConfig).filter(function(e){return t.navConfig[e].title===n});i.length>0&&(this.__defaultNavItem=i[0])}},setActive:function(t,n,i){i&&"index-page"===i.origin&&this.__defaultNavItem?(this.widgets.tocWidget.model.get("idAttribute")===this.__defaultNavItem&&e.prototype.setActive.call(this,"SearchWidget",n),e.prototype.setActive.call(this,this.__defaultNavItem,n)):e.prototype.setActive.apply(this,arguments)},TOCTemplate:i,className:"s-landing-page-layout",id:"landing-page-layout",pageConfig:{template:n,view:t},navConfig:{ClassicSearchForm:{title:"Classic",order:1,path:"/classic-form",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="290px" height="246px" viewBox="0 0 290 246" version="1.1"><title>Artboard 1</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="5" fill="none" fill-rule="evenodd"><g class="svg-needs-stroke" stroke-width="5" fill="#FFFFFF" fill-opacity="0"><g transform="translate(80.000000, 53.000000)"><rect x="0" y="0" width="129.999945" height="139.429993"/><rect x="13.4714969" y="24.9222692" width="42.4352152" height="24.9222692"/><rect x="74.0932328" y="24.9222692" width="42.4352152" height="24.9222692"/><rect x="13.4714969" y="61.2953108" width="103.056951" height="16.1657963"/><rect x="13.4714969" y="89.5854542" width="103.056951" height="33.0051673"/></g></g></g></svg>'},SearchWidget:{title:"Modern",order:2,path:"/",isSelected:"true",svg:'<svg class="modern-search" xmlns="http://www.w3.org/2000/svg" width="172px" height="28px" viewBox="0 0 172 28" version="1.1"><title>Rectangle 8 + Rectangle 8</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-40.000000, -82.000000)" class="svg-needs-fill"><g transform="translate(40.000000, 82.000000)"><path d="M4.26325641e-14 0L4.26325641e-14 27.0939606 164.990643 27.0939606C168.867791 27.0939606 172 23.9622017 172 20.0989813L172 6.9949793C172 3.13448997 168.861804 0 164.990643 0L4.26325641e-14 0ZM164.990643 3C167.205202 3 169 4.7916 169 6.9949793L169 20.0989813C169 22.3064289 167.209851 24.0939606 164.990643 24.0939606L3 24 3 3 164.990643 3Z"/><g transform="translate(147.000000, 6.000000)"><path d="M10.6047437 11.077395C9.59359708 11.8615052 8.32401807 12.3282675 6.9454209 12.3282675 3.64463092 12.3282675 0.968811942 9.65244849 0.968811942 6.35165851 0.968811942 3.05086853 3.64463092 0.375049553 6.9454209 0.375049553 10.2462109 0.375049553 12.9220299 3.05086853 12.9220299 6.35165851 12.9220299 7.26156094 12.7186956 8.12397211 12.354987 8.89593202L17.4624135 13.6586842C17.4624135 13.6586842 17.5766368 15.1532905 17.3179164 15.4307342 16.9425866 15.8332262 15.5602627 15.6984912 15.5602627 15.6984912L10.6047437 11.077395 10.6047437 11.077395ZM6.9454209 10.3360645C9.14594755 10.3360645 10.9298269 8.55218516 10.9298269 6.35165851 10.9298269 4.15113185 9.14594755 2.36725254 6.9454209 2.36725254 4.74489424 2.36725254 2.96101493 4.15113185 2.96101493 6.35165851 2.96101493 8.55218516 4.74489424 10.3360645 6.9454209 10.3360645Z"/></g><path d="M138 2.5L138 25.5 138 27 141 27 141 25.5 141 2.5 141 1 138 1 138 2.5 138 2.5Z"/></g></g></g></svg>'},PaperSearchForm:{title:"Paper",order:3,path:"/paper-form",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="290px" height="246px" viewBox="0 0 290 246" version="1.1"><title>Artboard 1 Copy 2</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="2" fill="none" fill-rule="evenodd"><g><g transform="translate(80.000000, 50.000000)"><path d="M11.1420871 139.441341L0 139.441341 0 0 119.984612 0 119.984612 8.26117318" class="svg-needs-stroke"stroke-width="5" fill-opacity="0" /><g transform="translate(9.289131, 6.536313)"><rect class="svg-needs-stroke"stroke-width="5" fill-opacity="0"  x="0" y="0" width="119.984612" height="139.441341"/><rect class="svg-needs-fill" x="13.8443783" y="27.5977654" width="92.2958552" height="5.81005587"/><rect class="svg-needs-fill" x="13.8443783" y="41.396648" width="92.2958552" height="5.81005587"/><rect class="svg-needs-fill" x="13.8443783" y="55.9217877" width="92.2958552" height="5.81005587"/></g></g></g></g></svg>'}}})}),define("router",["underscore","jquery","backbone","js/components/api_query","js/mixins/dependon","js/components/api_feedback","js/components/api_request","js/components/api_targets","js/mixins/api_access","js/components/api_query_updater"],function(e,t,n,i,a,r,s,o,l,c){var u=n.Router.extend({initialize:function(e){e=e||{},this.queryUpdater=new c("Router")},execute:function(t,i){if(n.History.started){var a=n.history.getFragment();if("search/"===(a=""===a?"index":a)&&e.isEmpty(e.reject(i,e.isUndefined)))return n.history.history.go(-2)}e.isFunction(t)&&t.apply(this,i)},activate:function(e){if(this.setBeeHive(e),!this.hasPubSub())throw new Error("Ooops! Who configured this #@$%! There is no PubSub service!")},routerNavigate:function(e,t){t=t||{};this.getPubSub().publish(this.getPubSub().NAVIGATE,e,t)},routes:{"/":"index","":"index","classic-form(/)":"classicForm","paper-form(/)":"paperForm","index/(:query)":"index","search/(:query)(/)(:widgetName)":"search","search(?:query)":"search","execute-query/(:query)":"executeQuery","abs/*path":"view","user/orcid*(:subView)":"orcidPage","user/account(/)(:subView)":"authenticationPage","user/account/verify/(:subView)/(:token)":"routeToVerifyPage","user/settings(/)(:subView)(/)":"settingsPage","user/libraries(/)(:id)(/)(:subView)(/)(:subData)(/)":"librariesPage","user/home(/)":"homePage","orcid-instructions(/)":"orcidInstructions","public-libraries/(:id)(/)":"publicLibraryPage","*invalidRoute":"noPageFound"},index:function(e){this.routerNavigate("index-page")},classicForm:function(){this.routerNavigate("ClassicSearchForm")},paperForm:function(){this.routerNavigate("PaperSearchForm")},search:function(e,t){if(e)try{var n=(new i).load(e);this.routerNavigate("search-page",{q:n,page:t&&"show-"+t,replace:!0})}catch(t){return console.error("Error parsing query from a string: ",e,t),this.getPubSub().publish(this.getPubSub().NAVIGATE,"index-page"),this.getPubSub().publish(this.getPubSub().BIG_FIRE,new r({code:r.CODES.CANNOT_ROUTE,reason:"Cannot parse query",query:e})),this.getPubSub().publish(this.getPubSub().ALERT,new r({code:r.CODES.ALERT,msg:"unable parse query",type:"danger",modal:!0}))}else this.getPubSub().publish(this.getPubSub().NAVIGATE,"index-page")},executeQuery:function(e){this.getPubSub().publish(this.getPubSub().NAVIGATE,"execute-query",e)},view:function(e){if(!e)return this.routerNavigate("404");var t,n=e.split("/");n[n.length-1].match(/^(abstract|citations|references|coreads|similar|toc|graphics|metrics|exportcitation)$/)&&(t=n.pop());var i,a,r=n.join("/");t?(i="Show"+t[0].toUpperCase()+t.slice(1),a="#abs/"+encodeURIComponent(r)+"/"+t):(i="ShowAbstract",a="#abs/"+encodeURIComponent(r)+"/abstract"),this.routerNavigate(i,{href:a,bibcode:r})},routeToVerifyPage:function(e,t){this.getPubSub().publish(this.getPubSub().NAVIGATE,"user-action",{subView:e,token:t})},orcidPage:function(){this.getPubSub().publish(this.getPubSub().NAVIGATE,"orcid-page")},orcidInstructions:function(){this.getPubSub().publish(this.getPubSub().NAVIGATE,"orcid-instructions")},authenticationPage:function(t){if(t&&!e.contains(["login","register","reset-password-1","reset-password-2"],t))throw new Error("that isn't a subview that the authentication page knows about");this.routerNavigate("authentication-page",{subView:t})},settingsPage:function(t){e.contains(["token","password","email","delete"],t)?this.routerNavigate("UserSettings",{subView:t}):e.contains(["librarylink","orcid","application"],t)?this.routerNavigate("UserPreferences",{subView:t}):e.contains(["libraryimport"],t)?this.routerNavigate("LibraryImport"):this.routerNavigate("UserPreferences",{subView:void 0})},librariesPage:function(t,n,i){if(t){if("actions"===t)return this.routerNavigate("LibraryActionsWidget","libraries");n=n||"library";if(e.contains(["library","admin"],n))this.routerNavigate("IndividualLibraryWidget",{subView:n,id:t});else{if(!e.contains(["export","metrics","visualization"],n))throw new Error("did not recognize subview for library view");"library-export"==(n="library-"+n)?this.routerNavigate(n,{subView:i||"bibtex",id:t}):"library-metrics"==n&&this.routerNavigate(n,{id:t})}}else this.routerNavigate("AllLibrariesWidget","libraries")},publicLibraryPage:function(e){this.getPubSub().publish(this.getPubSub().NAVIGATE,"IndividualLibraryWidget",{id:e,publicView:!0,subView:"library"})},homePage:function(e){this.routerNavigate("home-page",{subView:e})},noPageFound:function(){this.routerNavigate("404")},_extractParameters:function(t,n){return e.map(t.exec(n).slice(1),function(e){return/q\=/.test(e)?e:e?decodeURIComponent(e):e})}});return e.extend(u.prototype,a.BeeHive,l),u}),define("landing-page.bundle",function(){});