define(["js/widgets/facet/factory","analytics"],function(e,t){return function(){var r=e.makeBasicCheckboxFacet({facetField:"property",facetTitle:"Refereed",openByDefault:!0,defaultQueryArguments:{"facet.query":"property:refereed"},preprocessors:function(e){return e.filter(function(e){return"notrefereed"===e.value||"refereed"===e.value}).map(function(e){return"notrefereed"===e.name&&(e.name="non-refereed"),e})},logicOptions:{single:["limit to","exclude"],multiple:["invalid choice"]}});return r.handleLogicalSelection=function(e){var r=this.getCurrentQuery(),i=this.findPaginator(r).paginator,n=this.queryUpdater.removeTmpEntry(r,"SelectedItems"),a=this;if(n&&_.keys(n).length>0){n=_.values(n),_.each(n,function(e,t,r){r[t]="property:"+a.queryUpdater.escapeInclWhitespace(e.value)}),r=r.clone();var u="fq_"+this.facetField;"and"==e||"limit to"==e?this.queryUpdater.updateQuery(r,u,"limit",n):"or"==e?this.queryUpdater.updateQuery(r,u,"expand",n):"exclude"!=e&&"not"!=e||this.queryUpdater.updateQuery(r,u,"exclude",n);var c="{!type=aqp v=$"+u+"}",o=r.get("fq");if(o)-1==_.indexOf(o,c)&&o.push(c),r.set("fq",o);else r.set("fq",[c]);this.dispatchNewQuery(i.cleanQuery(r)),t("send","event","interaction","facet-applied",JSON.stringify({name:this.facetField,logic:e,conditions:n}))}},r}});